                                                                      PAGE   1
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0030   0006    DEFINT A-Z
 0030   0006    
 0030   0006    '****** FormEdit.Bas - Forms Editing Module *******************
                **************
 0030   0006    'by Donald R. Malin,  Copyright (c) 1989, 1990 Crescent Softwar
                e, Inc.
 0030   0006    
 0030   0006    'The following routines are provided to manage editing of data 
                entry forms
 0030   0006    'from your programs:
 0030   0006    
 0030   0006    '    EditForm - This is the routine that handles all User input
                , cursor and
 0030   0006    '               mouse activity.  It is a pollable routine so th
                at your
 0030   0006    '               program can monitor all the User's activity whi
                le editing.
 0030   0006    '  PrintArray - Prints the contents of fields on the screen for
                m.  This
 0030   0006    '               routine is used internally by [EditForm] but ca
                n be used in
 0030   0006    '               your program to force a redisplay after alterin
                g any data.
 0030   0006    '   SaveField - Checks and converts a fields data and places it
                 in the record
 0030   0006    '               buffer [Form$(0, 0)].  As above, this routine i
                s used
 0030   0006    '               internaly by [EditForm], but can be used by you
                r program to
 0030   0006    '               check and format data before calling [PrintArra
                y].
 0030   0006    'UnPackBuffer - Copies and converts all data from the record bu
                ffer
 0030   0006    '               [Form$(0, 0)] and places it in the individual e
                lements of the
 0030   0006    '               [Form$()] array.
 0030   0006    '**************************************************************
                **************
 0030   0006    
 0030   0006    '$INCLUDE: 'DefCnf.bi'                  'Defines TYPE for monit
                or/color info.
 0030   0006    TYPE Config
 0030   0006        Active        AS INTEGER     'Config initialized flag
 0030   0006        MonTyp        AS INTEGER     'Monitor Type = Monitor (NOT M
                onoCode)
 0030   0006        CsrSize       AS INTEGER     'Cursor Scan Lines
 0030   0006        Mouse         AS INTEGER     'Moose Flag
 0030   0006        PulBar        AS INTEGER     'Horizontal Bar Color
 0030   0006        MenBox        AS INTEGER     'Pulled down Box Color
 0030   0006        ActivCh       AS INTEGER     'Active menu choice color
 0030   0006        InActCh       AS INTEGER     'Inactive (Non-selectable) Cho
                ice Color
 0030   0006        HiLite        AS INTEGER     'Menu Bar Color for active cho
                ices
                                                                      PAGE   2
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0030   0006        InActHiLt     AS INTEGER     'Dito for inactive choices
 0030   0006        NonMen        AS INTEGER     'Normal screen color
 0030   0006        CPUSpeed      AS LONG        'Relative processor speed
 0030   0006    END TYPE
 0030   0006    
 0030   0006    TYPE jConfig
 0030   0006        MonTyp AS INTEGER           'Monitor Type
 0030   0006        PulBar AS INTEGER           'Horizontal Bar Color
 0030   0006        MenBox AS INTEGER           'Pulled down Box Color
 0030   0006        ActivCh AS INTEGER          'Active menu choice color
 0030   0006        InActCh AS INTEGER          'Inactive (Non-selectable) Choi
                ce Color
 0030   0006        HiLite AS INTEGER           'Menu Bar Color for active choi
                ces
 0030   0006        InActHiLt AS INTEGER        'Dito for inactive choices
 0030   0006        NonMen AS INTEGER           'Normal screen color
 0030   0006        CurSize AS INTEGER          'Cursor Scan Lines
 0030   0006        Mouse AS INTEGER            'Mouse in residence Flag
 0030   0006    END TYPE
 0030   0006    
 0030   0006    'COMMON SHARED Cnf AS Config
 0030   0006    
 0030   0006    '$INCLUDE: 'FieldInf.bi'                '        "        field
                 information
 0030   0006    '----- Define the Field Information TYPE
 0030   0006    TYPE FieldInfo
 0030   0006         Fields    AS INTEGER              '0
 0030   0006         Row       AS INTEGER              '1
 0030   0006         LCol      AS INTEGER              '2
 0030   0006         RCol      AS INTEGER              '3
 0030   0006         StorLen   AS INTEGER              '4
 0030   0006         FType     AS INTEGER              '5
 0030   0006         RelFile   AS STRING * 8           '6
 0030   0006         RelFld    AS INTEGER              '10
 0030   0006         Indexed   AS INTEGER              '11
 0030   0006         FldName   AS STRING * 8           '12
 0030   0006         Decimals  AS INTEGER              '16
 0030   0006         RelHandle AS INTEGER              '17
 0030   0006         Protected AS INTEGER              '18
 0030   0006         ScratchI  AS INTEGER
 0030   0006         LowRange  AS DOUBLE
 0030   0006         HiRange   AS DOUBLE
 0030   0006         ScratchS  AS STRING * 8
 0030   0006    END TYPE
 0030   0006    
 0030   0006    CONST FrmWdth = 64
 0030   0006    CONST MaxFields = 255
 0030   0006    
 0030   0006    '----- Define Field Type constants
 0030   0006    CONST StrFld = 1
 0030   0006    CONST PropStrFld = 23
 0030   0006    CONST UCaseStrFld = 2
 0030   0006    CONST NumericStrFld = 16
 0030   0006    CONST NotesFld = 17
                                                                      PAGE   3
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0030   0006    CONST IntFld = 3
 0030   0006    CONST LongIntFld = 18
 0030   0006    CONST SngFld = 4
 0030   0006    CONST DblFld = 5
 0030   0006    CONST DateFld = 6
 0030   0006    CONST EuroDateFld = 19
 0030   0006    CONST PhoneFld = 7
 0030   0006    CONST SoSecFld = 8
 0030   0006    CONST ZipFld = 9
 0030   0006    CONST MoneyFld = 10
 0030   0006    CONST VirtualFld = 12
 0030   0006    CONST Relational = 11
 0030   0006    CONST MultChFld = 13
 0030   0006    CONST MultChAFld = 22
 0030   0006    CONST LogicalFld = 14
 0030   0006    CONST RecNoFld = 20
 0030   0006    CONST TotRecsFld = 21
 0030   0006    CONST SequFld = 15
 0030   0006    CONST Button = 24
 0030   0006    
 0030   0006    CONST F1Key = -59
 0030   0006    CONST F2Key = -60
 0030   0006    CONST F3Key = -61
 0030   0006    CONST F4KEY = -62
 0030   0006    CONST F5KEY = -63
 0030   0006    CONST F6KEY = -64
 0030   0006    CONST F7KEY = -65
 0030   0006    CONST F8KEY = -66
 0030   0006    CONST F9KEY = -67
 0030   0006    CONST F0Key = -68
 0030   0006    CONST F10Key = -68
 0030   0006    CONST HomeKey = -71
 0030   0006    CONST EndKey = -79
 0030   0006    CONST TabKey = 9
 0030   0006    CONST ShftTabKey = -15
 0030   0006    CONST CtrlR = -116
 0030   0006    CONST CtrlL = -115
 0030   0006    
 0030   0006    CONST PgUpKey = -73
 0030   0006    CONST PgDnKey = -81
 0030   0006    CONST ESC = 27
 0030   0006    CONST EscKey = 27
 0030   0006    CONST EnterKey = 13
 0030   0006    CONST SKey = 83
 0030   0006    CONST PKey = 80
 0030   0006    
 0030   0006    CONST MainMenu = 1
 0030   0006    CONST EmpMaintMenu = 2
 0030   0006    CONST PayProcessMenu = 3
 0030   0006    CONST ManMenu = 4
 0030   0006    CONST YTDMenu = 5
 0030   0006    CONST ReportsMenu = 6
 0030   0006    CONST ControlMenu = 7
 0030   0006    CONST DraftMenu = 10
                                                                      PAGE   4
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0030   0006    
 0030   0006    CONST UseY = 89
 0030   0006    CONST UseN = 78
 0030   0006    
 0030   0006    'KeyCodes
 0030   0006    
 0030   0006    
 0030   0006    '$INCLUDE: 'FormEdit.bi'                '        "        form 
                editing info.
 0030   0006    CONST UCase = 1
 0030   0006    CONST Intgr = 2
 0030   0006    CONST FloatP = 3
 0030   0006    CONST Money = 4
 0030   0006    CONST MultFld = 5
 0030   0006    CONST Propr = 6
 0030   0006    CONST ButtonFld = 7
 0030   0006    
 0030   0006    TYPE FormInfo
 0030   0006       StartEl     AS INTEGER     'Starting (base) element of the c
                urrent form
 0030   0006       FldNo       AS INTEGER     'Current field number
 0030   0006       PrevFld     AS INTEGER     'Previous field (different from a
                bove only
 0030   0006                                  '  when first moving to a new fie
                ld.
 0030   0006       FldEdited   AS INTEGER     'Specifies that a field has been 
                changed (-1)
 0030   0006       KeyCode     AS INTEGER     'ASCII value of the last key pres
                sed. Negative
 0030   0006                                  '  for extended keys ie. F1 = -59
 0030   0006       TxtPos      AS INTEGER     'Cursor position relative to curr
                ent field.
 0030   0006       InsStat     AS INTEGER     'Current insertion mode status (-
                1) insert ON)
 0030   0006    
 0030   0006       Presses     AS INTEGER     'Number of mouse presses since la
                st press.
 0030   0006       MRow        AS INTEGER     'Mouse row # at last press
 0030   0006       MCol        AS INTEGER     'Mouse column # at last press
 0030   0006       DoingMult   AS INTEGER     'True if handling a multiple choi
                ce field
 0030   0006       Edited      AS INTEGER     'True if anything on the form has
                 changed.
 0030   0006       PageDisable AS INTEGER
 0030   0006       StayOnField AS INTEGER     '
 0030   0006    END TYPE
 0030   0006    
 0030   0006    COMMON Choice$(), TaxText$(), PrnDef$()
 0030   0006    COMMON SHARED Cnf AS Config
 0030   0006    COMMON SHARED CrLf$, FF$
 0030   0006    
 0030   0006    ''$INCLUDE: 'QEditype.bi'                '        "        note
                s editing info.
 0030   0006                
                                                                      PAGE   5
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0030   0006    
 0030   0006    '----- Control Constants
 0030   0006    CONST StayOnField = 0                   'When true (-1) causes 
                cursor to stay
 0030   0006                                            '  on fields after typi
                ng off the end.
 0030   0006    CONST SkipProtected = -1                'When true (-1) causes 
                the cursor to
 0030   0006                                            '  skip over "Protected
                " fields.
 0030   0006    
 0030   0006    '----- Internal Constants
 0030   0006    CONST IntChars$ = "+- 1234567890"               'Legal integer 
                characters
 0030   0006    CONST FloatChars$ = " +-.1234567890EeDd"        '  "   floating
                 point chars.
 0030   0006    CONST MoneyChars$ = " $+-,.1234567890"          '  "   currency
                 characters
 0030   0006    
 0030   0006    CONST BlankInt% = -32767                        'Specifies blan
                k integer
 0030   0006    CONST BlankLng& = -2147483647                   '       "      
                  long int.
 0030   0006    CONST BlankSng! = -3.402823E+38                 '       "      
                  single
 0030   0006    'CONST BlankSng! = -1E+38                       'UnREM when usi
                ng /MBF
 0030   0006    CONST BlankDbl# = -1.79769313486231D+308        'Specifies blan
                k double
 0030   0006    'CONST BlankDbl# = -1E+38                       'UnREM when usi
                ng /MBF
 0030   0006    CONST BlankDate$ = "  -  -19  "
 0030   0006    
 0030   0006    
 0030   0006    '----- Define functions
 0030   0006    DECLARE FUNCTION ASCII% (Strng$)
 0030   0006    DECLARE FUNCTION Date2Num% (Dat$)
 0030   0006    DECLARE FUNCTION DOSVer% ()
 0030   0006    DECLARE FUNCTION EDate2Num% (Dat$)
 0030   0006    DECLARE FUNCTION EndOfForms% (Fld() AS ANY)
 0030   0006    DECLARE FUNCTION ENum2Date$ (Days)
 0030   0006    DECLARE FUNCTION FindLast% (BYVAL Address, Size)
 0030   0006    DECLARE FUNCTION FldNum% (FldName$, Fld() AS ANY)
 0030   0006    DECLARE FUNCTION FUsing$ (Number$, Image$)
 0030   0006    DECLARE FUNCTION MaxInt% (Var1%, Var2%)
 0030   0006    DECLARE FUNCTION MinInt% (Var1%, Var2%)
 0030   0006    DECLARE FUNCTION Null% (Text$)
 0030   0006    DECLARE FUNCTION Num2Date$ (Days)
 0030   0006    DECLARE FUNCTION Peek1% (Segment%, Offset%)
 0030   0006    DECLARE FUNCTION QPRTrim$ (Text$)
 0030   0006    DECLARE FUNCTION Value# (E$, ErrCode%)
 0030   0006    
 0030   0006    '----- Define subs
 0030   0006    DECLARE SUB APrint0 (BYVAL Address, NumEls, MidFirst, NumChars,
                                                                      PAGE   6
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

                 Colr)
 0030   0006    DECLARE SUB Box0 (UlRow, UlCol, BrRow, BrCol, Char, Clr)
 0030   0006    DECLARE SUB ButtonPress (ButNo%, Down%, Presses%, X%, Y%)
 0030   0006    DECLARE SUB CalcFields (StartOfForm%, FldNo%, Form$(), Fld() AS
                 ANY)
 0030   0006    DECLARE SUB FEInitForm (Form$(), Fld() AS ANY, Frm AS ANY)
 0030   0006    DECLARE SUB FEDownArrow (Fld() AS ANY, Frm AS ANY)
 0030   0006    DECLARE SUB FEPressButton (Fld AS ANY)
 0030   0006    DECLARE SUB FESetupMult (Form$(), Fld() AS ANY, Frm AS ANY, Cnf
                 AS ANY)
 0030   0006    DECLARE SUB FESetUpNotes (Form$(), Fld() AS ANY, Frm AS ANY)
 0030   0006    DECLARE SUB FEUpArrow (Fld() AS ANY, Frm AS ANY)
 0030   0006    DECLARE SUB Format (Float#, Fld AS ANY, Image$)
 0030   0006    DECLARE SUB FixDate (Dat$)
 0030   0006    DECLARE SUB GetCursor (X, Y, Button)
 0030   0006    DECLARE SUB GetVMode (Mode, Page, PageSize, Rows, Columns)
 0030   0006    DECLARE SUB HideCursor ()
 0030   0006    DECLARE SUB Message (Msg$)
 0030   0006    DECLARE SUB MouseTrap (UlRow, UlCol, BrRow, BrCol)
 0030   0006    DECLARE SUB MQPrint (X$, Colr)
 0030   0006    DECLARE SUB MPaintBox (UlRow, UlCol, LRRow, LRCol, Colr)
 0030   0006    DECLARE SUB MScrnSave (UlRow, UlCol, LRRow, LRCol, SEG Address)
 0030   0006    DECLARE SUB MScrnRest (UlRow, UlCol, LRRow, LRCol, SEG Address)
 0030   0006    DECLARE SUB Pause (Ticks)
 0030   0006    DECLARE SUB PrintArray (FirstFld%, LastFld%, Form$(), Fld() AS 
                ANY)
 0030   0006    DECLARE SUB ProperName (Text$)
 0030   0006    'DECLARE SUB QEdit (Array$(), X$, Action%, Ed AS ANY)
 0030   0006    DECLARE SUB SaveField (FldNo%, Form$(), Fld() AS ANY, BadFld%)
 0030   0006    DECLARE SUB ShowCursor ()
 0030   0006    DECLARE SUB SplitColor (Colr%, Fg%, Bg%)
 0030   0006    DECLARE SUB StuffBuf (Ky$)
 0030   0006    DECLARE SUB Tokenize (Calc$, Fld() AS ANY)
 0030   0006    DECLARE SUB VertMenu (Item$(), Choice%, MaxLen%, BoxBot%, Ky$, 
                Action%, Cnf AS ANY)
 0030   0006    
 0030   0006    
 0030   0006    'DIM Ed AS EditInfo
 0030   0006    DIM SHARED Temp$
 0030   0006    
 0030   0006    REDIM Work$(0)
 0030    **        I00002:   push    00h
 0032    **                  push    00h
 0034    **                  push    04h
 0036    **                  push    8001h
 0039    **                  push    offset WORK$
 003C    **                  call    B$RDIM
 0041   001C    
 0041   001C    'SUB FESetUpNotes (Form$(), Fld() AS FieldInfo, Frm AS FormInfo
                )
 0041   001C    '
 0041   001C    '    SHARED Work$(), Ed AS EditInfo
 0041   001C    '
 0041   001C    '    Ed.Changed = 0
                                                                      PAGE   7
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0041   001C    '                                                'Set number of
                 rows
 0041   001C    '    Ed.Rows = Fld(Frm.FldNo).ScratchI - Fld(Frm.FldNo).Row + 1
 0041   001C    '                                                'Set width
 0041   001C    '    Ed.Wide = Fld(Frm.FldNo).RCol - Fld(Frm.FldNo).LCol + 1
 0041   001C    '    Ed.Wrap = Ed.Wide - 1                       'Set word wrap
                 column
 0041   001C    '
 0041   001C    '    X& = FRE(Temp$) - 2000                      'Create array 
                to hold text
 0041   001C    '    REDIM Work$((X& \ 2 + LEN(Form$(Frm.FldNo, 0))) \ Ed.Wrap)
 0041   001C    '    Work$(1) = Form$(Frm.FldNo, 0)              'Put text in f
                irst line.
 0041   001C    '                                                '  QEdit will 
                format it later
 0041   001C    '    HideCursor                                  'Find the colo
                r of edit window
 0041   001C    '    Ed.AColor = SCREEN(Fld(Frm.FldNo).Row, Fld(Frm.FldNo).LCol
                , 1)
 0041   001C    '    ShowCursor
 0041   001C    '    Ed.Frame = 0                                'No frame arou
                nd edit window
 0041   001C    '    IF Frm.InsStat THEN                         'Set QEdit's i
                nsert state
 0041   001C    '       Ed.InsStat = Frm.InsStat
 0041   001C    '    ELSE
 0041   001C    '       Ed.InsStat = 1
 0041   001C    '    END IF
 0041   001C    '    Ed.Presses = 0                              'No mouse pres
                ses yet
 0041   001C    '                                                'Put cursor at
                 upper left
 0041   001C    '    LOCATE Fld(Frm.FldNo).Row, Fld(Frm.FldNo).LCol, 0
 0041   001C    '
 0041   001C    '    Ed.TL = 1
 0041   001C    '    Ed.LC = 1
 0041   001C    '    Ed.CurLine = 1
 0041   001C    '    Ed.CurCol = 1
 0041   001C    '
 0041   001C    'END SUB
 0041   001C    
 0041   001C    SUB FEDownArrow (Fld() AS FieldInfo, Frm AS FormInfo)
 0041    **                  jmp     I00003
 005A   001C        SHARED BottomRow, EndOfForm
 005A   001C    
 005A   001C        IF Frm.FldNo < EndOfForm THEN               'If not on last
                 field
 005A   001C           Row = Fld(Frm.FldNo).Row                 'Save current r
                ow #
 005A   001C           Col = POS(0)                             'Save column #
 005A   001C           NxtRow = BottomRow                       'Init. "Next Ro
                w" variable
 005A   001C                                                    'Examine all fi
                eld's row #ers
                                                                      PAGE   8
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 005A   001C                                                    '  to find the 
                next row down
 005A   001C           FOR N = Frm.StartEl + 1 TO EndOfForm
 0044    **                  mov     ax,06h[bp]
 005D    **                  add     ax,0002h
 0060    **                  mov     si,ax
 0062    **                  mov     cx,[si]
 0064    **                  cmp     cx,ENDOFFORM%
 0068    **                  jl      $+03h
 006A    **                  jmp     I00005
 006D    **                  sal     cx,1
 006F    **                  sal     cx,1
 0071    **                  sal     cx,1
 0073    **                  sal     cx,1
 0075    **                  sal     cx,1
 0077    **                  sal     cx,1
 0079    **                  mov     bx,cx
 007B    **                  mov     si,08h[bp]
 007E    **                  add     bx,0Ah[si]
 0081    **                  mov     es,02h[si]
 0084    **                  add     bx,02h
 0087    **                  es:     
 0088    **                  mov     ax,[bx]
 008A    **                  mov     0EAh[bp],ax
 008D    **                  push    00h
 008F    **                  call    B$FPOS
 0094    **                  mov     0E8h[bp],ax
 0097    **                  mov     ax,BOTTOMROW%
 009A    **                  mov     0E6h[bp],ax
 009D    **                  mov     ax,ENDOFFORM%
 00A0    **                  mov     0ECh[bp],ax
 00A3    **                  mov     si,06h[bp]
 00A6    **                  mov     ax,[si]
 00A8    **                  inc     ax
 00A9    **                  jmp     I00006
 00AC   0020              IF Fld(N).Row > Row AND NOT (SkipProtected AND Fld(N)
                .Protected) THEN
 00AC   0020                 NxtRow = MinInt(NxtRow, Fld(N).Row)
 00AC   0020              END IF
 00AC    **        I00007:   sal     ax,1
 00AE    **                  sal     ax,1
 00B0    **                  sal     ax,1
 00B2    **                  sal     ax,1
 00B4    **                  sal     ax,1
 00B6    **                  sal     ax,1
 00B8    **                  mov     bx,ax
 00BA    **                  mov     si,08h[bp]
 00BD    **                  add     bx,0Ah[si]
 00C0    **                  mov     es,02h[si]
 00C3    **                  add     bx,02h
 00C6    **                  es:     
 00C7    **                  mov     cx,[bx]
 00C9    **                  cmp     cx,0EAh[bp]
 00CC    **                  mov     dx,0000h
                                                                      PAGE   9
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 00CF    **                  jng     $+01h
 00D1    **                  dec     dx
 00D2    **                  mov     bx,ax
 00D4    **                  add     bx,0Ah[si]
 00D7    **                  mov     es,02h[si]
 00DA    **                  add     bx,24h
 00DD    **                  es:     
 00DE    **                  mov     cx,[bx]
 00E0    **                  and     cx,0FFh
 00E3    **                  not     cx
 00E5    **                  and     dx,cx
 00E7    **                  and     dx,dx
 00E9    **                  je      I00008
 00EB    **                  mov     bx,ax
 00ED    **                  add     bx,0Ah[si]
 00F0    **                  mov     es,02h[si]
 00F3    **                  add     bx,02h
 00F6    **                  es:     
 00F7    **                  mov     ax,[bx]
 00F9    **                  mov     0E4h[bp],ax
 00FC    **                  lea     ax,0E6h[bp]
 00FF    **                  push    ax
 0100    **                  lea     ax,0E4h[bp]
 0103    **                  push    ax
 0104    **                  call    MININT%
 0109    **                  mov     0E2h[bp],ax
 010C    **                  mov     bx,0E0h[bp]
 010F    **                  sal     bx,1
 0111    **                  sal     bx,1
 0113    **                  sal     bx,1
 0115    **                  sal     bx,1
 0117    **                  sal     bx,1
 0119    **                  sal     bx,1
 011B    **                  mov     si,08h[bp]
 011E    **                  add     bx,0Ah[si]
 0121    **                  mov     es,02h[si]
 0124    **                  add     bx,02h
 0127    **                  mov     ax,0E4h[bp]
 012A    **                  es:     
 012B    **                  mov     [bx],ax
 012D    **                  mov     ax,0E2h[bp]
 0130    **                  mov     0E6h[bp],ax
 0133   0020           NEXT
 0133    **        I00008:   mov     ax,0E0h[bp]
 0136    **                  inc     ax
 0137    **        I00006:   mov     0E0h[bp],ax
 013A    **                  cmp     ax,0ECh[bp]
 013D    **                  jg      $+03h
 013F    **                  jmp     I00007
 0142   0020           IF NxtRow > Row THEN                     'If there is a 
                field below ours
 0142   0020                                                    'Make an array 
                to hold all field
 0142   0020              REDIM Temp(Fld(Frm.StartEl).Fields)
                                                                      PAGE  10
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0142    **                  mov     ax,0EAh[bp]
 0145    **                  cmp     ax,0E6h[bp]
 0148    **                  jl      $+03h
 014A    **                  jmp     I00009
 014D    **                  push    00h
 014F    **                  mov     si,06h[bp]
 0152    **                  mov     bx,[si]
 0154    **                  sal     bx,1
 0156    **                  sal     bx,1
 0158    **                  sal     bx,1
 015A    **                  sal     bx,1
 015C    **                  sal     bx,1
 015E    **                  sal     bx,1
 0160    **                  mov     si,08h[bp]
 0163    **                  add     bx,0Ah[si]
 0166    **                  mov     es,02h[si]
 0169    **                  es:     
 016A    **                  push    [bx]
 016C    **                  push    02h
 016E    **                  push    0101h
 0171    **                  lea     ax,0CEh[bp]
 0174    **                  push    ax
 0175    **                  call    B$RDIM
 017A   0020              X = 0                                 '  #ers on that
                 row
 017A   0020              FOR N = Frm.StartEl + 1 TO EndOfForm
 017A    **                  mov     0CAh[bp],0000h
 017F    **                  mov     ax,ENDOFFORM%
 0182    **                  mov     0CCh[bp],ax
 0185    **                  mov     si,06h[bp]
 0188    **                  mov     ax,[si]
 018A    **                  inc     ax
 018B    **                  jmp     I00010
 018E   0020                 IF Fld(N).Row = NxtRow AND NOT (SkipProtected AND 
                Fld(N).Protected) THEN
 018E   0020                    X = X + 1
 018E   0020                    Temp(X) = N
 018E   0020                 END IF
 018E    **        I00011:   sal     ax,1
 0190    **                  sal     ax,1
 0192    **                  sal     ax,1
 0194    **                  sal     ax,1
 0196    **                  sal     ax,1
 0198    **                  sal     ax,1
 019A    **                  mov     bx,ax
 019C    **                  mov     si,08h[bp]
 019F    **                  add     bx,0Ah[si]
 01A2    **                  mov     es,02h[si]
 01A5    **                  add     bx,02h
 01A8    **                  es:     
 01A9    **                  mov     cx,[bx]
 01AB    **                  cmp     cx,0E6h[bp]
 01AE    **                  mov     dx,0000h
 01B1    **                  jne     $+01h
                                                                      PAGE  11
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 01B3    **                  dec     dx
 01B4    **                  mov     bx,ax
 01B6    **                  add     bx,0Ah[si]
 01B9    **                  mov     es,02h[si]
 01BC    **                  add     bx,24h
 01BF    **                  es:     
 01C0    **                  mov     ax,[bx]
 01C2    **                  and     ax,0FFFFh
 01C5    **                  not     ax
 01C7    **                  and     dx,ax
 01C9    **                  and     dx,dx
 01CB    **                  je      I00012
 01CD    **                  inc     0CAh[bp]
 01D0    **                  mov     bx,0CAh[bp]
 01D3    **                  sal     bx,1
 01D5    **                  lea     si,0CEh[bp]
 01D8    **                  add     bx,0Ah[si]
 01DB    **                  mov     es,02h[si]
 01DE    **                  mov     ax,0E0h[bp]
 01E1    **                  es:     
 01E2    **                  mov     [bx],ax
 01E4   0020              NEXT
 01E4    **        I00012:   mov     ax,0E0h[bp]
 01E7    **                  inc     ax
 01E8    **        I00010:   mov     0E0h[bp],ax
 01EB    **                  cmp     ax,0CCh[bp]
 01EE    **                  jng     I00011
 01F0   0020                                                    'Look backwards
                 for the field
 01F0   0020              FOR N = X TO 2 STEP -1                '  above ours
 01F0    **                  mov     ax,0CAh[bp]
 01F3    **                  jmp     I00013
 01F6   0020                 IF Fld(Temp(N)).LCol <= Col THEN EXIT FOR
 01F6    **        I00014:   sal     ax,1
 01F8    **                  mov     bx,ax
 01FA    **                  lea     si,0CEh[bp]
 01FD    **                  add     bx,0Ah[si]
 0200    **                  mov     es,02h[si]
 0203    **                  es:     
 0204    **                  mov     ax,[bx]
 0206    **                  sal     ax,1
 0208    **                  sal     ax,1
 020A    **                  sal     ax,1
 020C    **                  sal     ax,1
 020E    **                  sal     ax,1
 0210    **                  sal     ax,1
 0212    **                  mov     bx,ax
 0214    **                  mov     si,08h[bp]
 0217    **                  add     bx,0Ah[si]
 021A    **                  mov     es,02h[si]
 021D    **                  add     bx,04h
 0220    **                  es:     
 0221    **                  mov     ax,[bx]
 0223    **                  cmp     ax,0E8h[bp]
                                                                      PAGE  12
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0226    **                  jg      $+03h
 0228    **                  jmp     I00016
 022B   0020              NEXT
 022B    **                  mov     ax,0E0h[bp]
 022E    **                  dec     ax
 022F    **        I00013:   mov     0E0h[bp],ax
 0232    **                  cmp     ax,0002h
 0235    **                  jnl     I00014
 0237   0020    
 0237   0020              Frm.FldNo = Temp(N)                   'Assign the new
                 field
 0237   0020              IF Frm.FldNo = 0 THEN Frm.FldNo = Frm.PrevFld + 1
 0237    **        I00016:   mov     bx,0E0h[bp]
 023A    **                  sal     bx,1
 023C    **                  lea     si,0CEh[bp]
 023F    **                  add     bx,0Ah[si]
 0242    **                  mov     es,02h[si]
 0245    **                  es:     
 0246    **                  mov     ax,[bx]
 0248    **                  mov     cx,06h[bp]
 024B    **                  add     cx,02h
 024E    **                  mov     si,cx
 0250    **                  mov     [si],ax
 0252    **                  cmp     word ptr [si],00h
 0255    **                  jne     I00017
 0257    **                  mov     ax,06h[bp]
 025A    **                  add     ax,0004h
 025D    **                  mov     di,ax
 025F    **                  mov     dx,[di]
 0261    **                  inc     dx
 0262    **                  mov     [si],dx
 0264   0020              'added to stop odd page wrapping
 0264   0020           ELSE                                     'Otherwise set 
                to last field
 0264    **        I00017:   jmp     I00018
 0267   0020              Frm.FldNo = EndOfForm
 0267   0020           END IF
 0267    **        I00009:   mov     ax,06h[bp]
 026A    **                  add     ax,0002h
 026D    **                  mov     si,ax
 026F    **                  mov     cx,ENDOFFORM%
 0273    **                  mov     [si],cx
 0275   0020        ELSE
 0275    **        I00018:   jmp     I00019
 0278   0020           Frm.FldNo = EndOfForm + 1
 0278   0020        END IF
 0278    **        I00005:   mov     ax,ENDOFFORM%
 027B    **                  inc     ax
 027C    **                  mov     cx,06h[bp]
 027F    **                  add     cx,02h
 0282    **                  mov     si,cx
 0284    **                  mov     [si],ax
 0286   0020    
 0286   0020    END SUB
                                                                      PAGE  13
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0286    **        I00019:
 0286    **        I00004:   lea     ax,0CEh[bp]
 0289    **                  push    ax
 028A    **                  call    B$ERAS
 0297   0020    
 0297   0020    SUB FEUpArrow (Fld() AS FieldInfo, Frm AS FormInfo)
 028F    **        I00003:   jmp     I00020
 02B0   0020        SHARED TopRow, EndOfForm
 02B0   0020    
 02B0   0020        IF Frm.FldNo > Frm.StartEl + 1 THEN         'If not on firs
                t field
 02B0   0020           Row = Fld(Frm.FldNo).Row                 'Save current r
                ow #
 02B0   0020           Col = POS(0)                             'Save column #
 02B0   0020           NxtRow = TopRow                          'Init. "Next Ro
                w" variable
 02B0   0020                                                    'Examine all fi
                eld's row #ers
 02B0   0020                                                    '  to find the 
                next row up
 02B0   0020           FOR N = Frm.StartEl + 1 TO EndOfForm
 029A    **                  mov     si,06h[bp]
 02B3    **                  mov     ax,[si]
 02B5    **                  inc     ax
 02B6    **                  add     si,02h
 02B9    **                  cmp     ax,[si]
 02BB    **                  jl      $+03h
 02BD    **                  jmp     I00022
 02C0    **                  mov     bx,[si]
 02C2    **                  sal     bx,1
 02C4    **                  sal     bx,1
 02C6    **                  sal     bx,1
 02C8    **                  sal     bx,1
 02CA    **                  sal     bx,1
 02CC    **                  sal     bx,1
 02CE    **                  mov     si,08h[bp]
 02D1    **                  add     bx,0Ah[si]
 02D4    **                  mov     es,02h[si]
 02D7    **                  add     bx,02h
 02DA    **                  es:     
 02DB    **                  mov     cx,[bx]
 02DD    **                  mov     0EAh[bp],cx
 02E0    **                  push    00h
 02E2    **                  mov     0E8h[bp],ax
 02E5    **                  call    B$FPOS
 02EA    **                  mov     0E6h[bp],ax
 02ED    **                  mov     ax,TOPROW%
 02F0    **                  mov     0E4h[bp],ax
 02F3    **                  mov     ax,ENDOFFORM%
 02F6    **                  mov     0ECh[bp],ax
 02F9    **                  mov     ax,0E8h[bp]
 02FC    **                  jmp     I00023
 02FF    **                  nop     
 0300   0022              IF Fld(N).Row < Row AND NOT (SkipProtected AND Fld(N)
                                                                      PAGE  14
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

                .Protected) THEN
 0300   0022                 NxtRow = MaxInt(NxtRow, Fld(N).Row)
 0300   0022              END IF
 0300    **        I00024:   sal     ax,1
 0302    **                  sal     ax,1
 0304    **                  sal     ax,1
 0306    **                  sal     ax,1
 0308    **                  sal     ax,1
 030A    **                  sal     ax,1
 030C    **                  mov     bx,ax
 030E    **                  mov     si,08h[bp]
 0311    **                  add     bx,0Ah[si]
 0314    **                  mov     es,02h[si]
 0317    **                  add     bx,02h
 031A    **                  es:     
 031B    **                  mov     cx,[bx]
 031D    **                  cmp     cx,0EAh[bp]
 0320    **                  mov     dx,0000h
 0323    **                  jnl     $+01h
 0325    **                  dec     dx
 0326    **                  mov     bx,ax
 0328    **                  add     bx,0Ah[si]
 032B    **                  mov     es,02h[si]
 032E    **                  add     bx,24h
 0331    **                  es:     
 0332    **                  mov     cx,[bx]
 0334    **                  and     cx,0FFh
 0337    **                  not     cx
 0339    **                  and     dx,cx
 033B    **                  and     dx,dx
 033D    **                  je      I00025
 033F    **                  mov     bx,ax
 0341    **                  add     bx,0Ah[si]
 0344    **                  mov     es,02h[si]
 0347    **                  add     bx,02h
 034A    **                  es:     
 034B    **                  mov     ax,[bx]
 034D    **                  mov     0E2h[bp],ax
 0350    **                  lea     ax,0E4h[bp]
 0353    **                  push    ax
 0354    **                  lea     ax,0E2h[bp]
 0357    **                  push    ax
 0358    **                  call    MAXINT%
 035D    **                  mov     0E0h[bp],ax
 0360    **                  mov     bx,0DEh[bp]
 0363    **                  sal     bx,1
 0365    **                  sal     bx,1
 0367    **                  sal     bx,1
 0369    **                  sal     bx,1
 036B    **                  sal     bx,1
 036D    **                  sal     bx,1
 036F    **                  mov     si,08h[bp]
 0372    **                  add     bx,0Ah[si]
 0375    **                  mov     es,02h[si]
                                                                      PAGE  15
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0378    **                  add     bx,02h
 037B    **                  mov     ax,0E2h[bp]
 037E    **                  es:     
 037F    **                  mov     [bx],ax
 0381    **                  mov     ax,0E0h[bp]
 0384    **                  mov     0E4h[bp],ax
 0387   0022           NEXT
 0387    **        I00025:   mov     ax,0DEh[bp]
 038A    **                  inc     ax
 038B    **        I00023:   mov     0DEh[bp],ax
 038E    **                  cmp     ax,0ECh[bp]
 0391    **                  jg      $+03h
 0393    **                  jmp     I00024
 0396   0022           IF NxtRow < Row THEN                     'If there is a 
                field above ours
 0396   0022                                                    'Make an array 
                to hold all field
 0396   0022              REDIM Temp(Fld(Frm.StartEl).Fields)
 0396    **                  mov     ax,0EAh[bp]
 0399    **                  cmp     ax,0E4h[bp]
 039C    **                  jg      $+03h
 039E    **                  jmp     I00026
 03A1    **                  push    00h
 03A3    **                  mov     si,06h[bp]
 03A6    **                  mov     bx,[si]
 03A8    **                  sal     bx,1
 03AA    **                  sal     bx,1
 03AC    **                  sal     bx,1
 03AE    **                  sal     bx,1
 03B0    **                  sal     bx,1
 03B2    **                  sal     bx,1
 03B4    **                  mov     si,08h[bp]
 03B7    **                  add     bx,0Ah[si]
 03BA    **                  mov     es,02h[si]
 03BD    **                  es:     
 03BE    **                  push    [bx]
 03C0    **                  push    02h
 03C2    **                  push    0101h
 03C5    **                  lea     ax,0CCh[bp]
 03C8    **                  push    ax
 03C9    **                  call    B$RDIM
 03CE   0022              X = 0                                 '  #ers on that
                 row
 03CE   0022              FOR N = Frm.StartEl + 1 TO EndOfForm
 03CE    **                  mov     0C8h[bp],0000h
 03D3    **                  mov     ax,ENDOFFORM%
 03D6    **                  mov     0CAh[bp],ax
 03D9    **                  mov     si,06h[bp]
 03DC    **                  mov     ax,[si]
 03DE    **                  inc     ax
 03DF    **                  jmp     I00027
 03E2   0022                  IF Fld(N).Row = NxtRow AND NOT (SkipProtected AND
                 Fld(N).Protected) THEN
 03E2   0022                     X = X + 1
                                                                      PAGE  16
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 03E2   0022                     Temp(X) = N
 03E2   0022                  END IF
 03E2    **        I00028:   sal     ax,1
 03E4    **                  sal     ax,1
 03E6    **                  sal     ax,1
 03E8    **                  sal     ax,1
 03EA    **                  sal     ax,1
 03EC    **                  sal     ax,1
 03EE    **                  mov     bx,ax
 03F0    **                  mov     si,08h[bp]
 03F3    **                  add     bx,0Ah[si]
 03F6    **                  mov     es,02h[si]
 03F9    **                  add     bx,02h
 03FC    **                  es:     
 03FD    **                  mov     cx,[bx]
 03FF    **                  cmp     cx,0E4h[bp]
 0402    **                  mov     dx,0000h
 0405    **                  jne     $+01h
 0407    **                  dec     dx
 0408    **                  mov     bx,ax
 040A    **                  add     bx,0Ah[si]
 040D    **                  mov     es,02h[si]
 0410    **                  add     bx,24h
 0413    **                  es:     
 0414    **                  mov     ax,[bx]
 0416    **                  and     ax,0FFFFh
 0419    **                  not     ax
 041B    **                  and     dx,ax
 041D    **                  and     dx,dx
 041F    **                  je      I00029
 0421    **                  inc     0C8h[bp]
 0424    **                  mov     bx,0C8h[bp]
 0427    **                  sal     bx,1
 0429    **                  lea     si,0CCh[bp]
 042C    **                  add     bx,0Ah[si]
 042F    **                  mov     es,02h[si]
 0432    **                  mov     ax,0DEh[bp]
 0435    **                  es:     
 0436    **                  mov     [bx],ax
 0438   0022              NEXT
 0438    **        I00029:   mov     ax,0DEh[bp]
 043B    **                  inc     ax
 043C    **        I00027:   mov     0DEh[bp],ax
 043F    **                  cmp     ax,0CAh[bp]
 0442    **                  jng     I00028
 0444   0022                                                    'Look backwards
                 for the field
 0444   0022              FOR N = X TO 2 STEP -1                '  above ours
 0444    **                  mov     ax,0C8h[bp]
 0447    **                  jmp     I00030
 044A   0022                  IF Fld(Temp(N)).LCol <= Col THEN EXIT FOR
 044A    **        I00031:   sal     ax,1
 044C    **                  mov     bx,ax
 044E    **                  lea     si,0CCh[bp]
                                                                      PAGE  17
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0451    **                  add     bx,0Ah[si]
 0454    **                  mov     es,02h[si]
 0457    **                  es:     
 0458    **                  mov     ax,[bx]
 045A    **                  sal     ax,1
 045C    **                  sal     ax,1
 045E    **                  sal     ax,1
 0460    **                  sal     ax,1
 0462    **                  sal     ax,1
 0464    **                  sal     ax,1
 0466    **                  mov     bx,ax
 0468    **                  mov     si,08h[bp]
 046B    **                  add     bx,0Ah[si]
 046E    **                  mov     es,02h[si]
 0471    **                  add     bx,04h
 0474    **                  es:     
 0475    **                  mov     ax,[bx]
 0477    **                  cmp     ax,0E6h[bp]
 047A    **                  jg      $+03h
 047C    **                  jmp     I00033
 047F   0022              NEXT
 047F    **                  mov     ax,0DEh[bp]
 0482    **                  dec     ax
 0483    **        I00030:   mov     0DEh[bp],ax
 0486    **                  cmp     ax,0002h
 0489    **                  jnl     I00031
 048B   0022              Frm.FldNo = Temp(N)                   'Assign the new
                 field
 048B   0022           ELSE                                     'Otherwise set 
                to field #1
 048B    **        I00033:   mov     bx,0DEh[bp]
 048E    **                  sal     bx,1
 0490    **                  lea     si,0CCh[bp]
 0493    **                  add     bx,0Ah[si]
 0496    **                  mov     es,02h[si]
 0499    **                  es:     
 049A    **                  mov     ax,[bx]
 049C    **                  mov     cx,06h[bp]
 049F    **                  add     cx,02h
 04A2    **                  mov     si,cx
 04A4    **                  mov     [si],ax
 04A6    **                  jmp     I00034
 04A9   0022              Frm.FldNo = Frm.StartEl + 1
 04A9   0022           END IF
 04A9    **        I00026:   mov     si,06h[bp]
 04AC    **                  mov     ax,[si]
 04AE    **                  inc     ax
 04AF    **                  add     si,02h
 04B2    **                  mov     [si],ax
 04B4   0022    
 04B4   0022        ELSE
 04B4    **        I00034:   jmp     I00035
 04B7   0022           Frm.FldNo = Frm.FldNo - 1
 04B7   0022        END IF
                                                                      PAGE  18
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 04B7    **        I00022:   mov     ax,06h[bp]
 04BA    **                  add     ax,0002h
 04BD    **                  mov     si,ax
 04BF    **                  dec     [si]
 04C1   0022    
 04C1   0022    END SUB
 04C1    **        I00035:
 04C1    **        I00021:   lea     ax,0CCh[bp]
 04C4    **                  push    ax
 04C5    **                  call    B$ERAS
 04D2   0022    
 04D2   0022    '**************************************************************
                **************
 04D2   0022    'Handles all User input, cursor and mouse activity.  It is a po
                llable routine
 04D2   0022    'so that your program can monitor all the User's activity while
                 editing.
 04D2   0022    '
 04D2   0022    'Form$() holds the field data, Help messages and formulas for t
                he form.  It
 04D2   0022    '  must be dimensioned to the number of fields by 2 [REDIM Form
                $(Fields, 2)].
 04D2   0022    '  Field data is kept in the first column [Form$(N, 0)], Help m
                essages are
 04D2   0022    '  kept in the second column [Form$(N, 1)] and Formulas go in t
                he third
 04D2   0022    '  [Form$(N, 2)].
 04D2   0022    '
 04D2   0022    'Fld() is a TYPE array containing information about each field 
                [Row, Column,
 04D2   0022    '  Type, etc.].  See "FieldInf.Bi" for structure definition.
 04D2   0022    '
 04D2   0022    'Frm is a TYPE containing general information about the current
                 edit session
 04D2   0022    '  such as the current field number, whether the form has been 
                change, etc..
 04D2   0022    '  See "FormEdit.Bi" for details.
 04D2   0022    '
 04D2   0022    'Cnf is a TYPE variable containing monitor and color informatio
                n required by
 04D2   0022    '  [VertMenu].
 04D2   0022    '
 04D2   0022    'Action is a flag used to control the form in the following way
                s:
 04D2   0022    '  Action = 1 - Initialize the form for editing.  Pads all Form
                $ elements
 04D2   0022    '               to their propper lengths and formats.  Displays
                 the contents
 04D2   0022    '               of all fields on the form.  Resets Action to 3.
 04D2   0022    '  Action = 3 - This is the idle state where the actual editing
                 is done.
 04D2   0022    '**************************************************************
                **************
 04D2   0022    '
                                                                      PAGE  19
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 04D2   0022    SUB EditForm (Form$(), Fld() AS FieldInfo, Frm AS FormInfo, Cnf
                 AS Config, Action) STATIC
 04CA    **        I00020:   jmp     I00036
 04EB   0022    
 04EB   0022    '    SHARED Ed AS EditInfo                       'For QEditS
 04EB   0022        SHARED Work$()
 04EB   0022        SHARED Choice$()                            'Multiple choic
                e array
 04EB   0022        SHARED ScrRows%, NPixLines%, EndOfForm%, TopRow%, BottomRow
                %, Instate
 04EB   0022        SHARED VertLen, VAction, Choice
 04EB   0022    
 04EB   0022    '    IF CsrSize = 0 THEN
 04EB   0022    '       '----- Find the cursor's size in Scan Lines
 04EB   0022    '       IF Peek1(0, &H463) = &HB4 THEN           'Peek at low m
                emory to see
 04EB   0022    '          CsrSize = 12                          'what type of 
                monitor we have
 04EB   0022    '       ELSE                                     'Monochrome us
                es 13 scan lines
 04EB   0022    '          CsrSize = 7                           'Color uses 8
 04EB   0022    '       END IF
 04EB   0022    '    END IF
 04EB   0022    
 04EB   0022    '    CALL QPrintRC(STR$(FRE("")), 25, 1, 15)
 04EB   0022    
 04EB   0022    
 04EB   0022        '----- Initialize variables/arrays if action isn't 3
 04EB   0022        IF Action <= 2 THEN
 04EB   0022           IF Action = 2 THEN
 04EB   0022             TempEdited = Frm.Edited
 04EB   0022             FEInitForm Form$(), Fld(), Frm
 04D5    **                  mov     si,06h[bp]
 04EE    **                  cmp     word ptr [si],02h
 04F1    **                  jng     $+03h
 04F3    **                  jmp     I00038
 04F6    **                  cmp     word ptr [si],02h
 04F9    **                  je      $+03h
 04FB    **                  jmp     I00039
 04FE    **                  mov     ax,0Ah[bp]
 0501    **                  add     ax,0016h
 0504    **                  mov     si,ax
 0506    **                  mov     cx,[si]
 0508    **                  mov     TEMPEDITED%,cx
 050C    **                  push    0Eh[bp]
 050F    **                  push    0Ch[bp]
 0512    **                  push    0Ah[bp]
 0515    **                  call    FEINITFORM
 051A   0024             Frm.Edited = TempEdited
 051A   0024           ELSE
 051A    **                  mov     ax,0Ah[bp]
 051D    **                  add     ax,0016h
 0520    **                  mov     si,ax
 0522    **                  mov     cx,TEMPEDITED%
                                                                      PAGE  20
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0526    **                  mov     [si],cx
 0528    **                  jmp     I00040
 052B   0024             FEInitForm Form$(), Fld(), Frm
 052B    **        I00039:   push    0Eh[bp]
 052E    **                  push    0Ch[bp]
 0531    **                  push    0Ah[bp]
 0534    **                  call    FEINITFORM
 0539   0024           END IF
 0539   0024        END IF
 0539    **        I00040:
 0539   0024    
 0539   0024        IF Action < 3 THEN
 0539   0024           Frm.PrevFld = 0
 0539   0024           Action = 3                               'Set Action to 
                3 (idle state)
 0539   0024           GOSUB SetCursor                          'Set the cursor
                 size
 0539    **        I00038:   mov     si,06h[bp]
 053C    **                  cmp     word ptr [si],03h
 053F    **                  jl      $+03h
 0541    **                  jmp     I00041
 0544    **                  mov     ax,0Ah[bp]
 0547    **                  add     ax,0004h
 054A    **                  mov     di,ax
 054C    **                  mov     [di],0000h
 0550    **                  mov     [si],0003h
 0554    **                  call    I00042
 0557   0024        END IF
 0557   0024    
 0557   0024    
 0557   0024        '----- Are we moving to a new field?
 0557   0024        IF Frm.FldNo <> Frm.PrevFld OR TermKey THEN
 0557   0024           
 0557   0024           Temp = Frm.FldNo
 0557   0024           IF SkipProtected THEN
 0557   0024              '----- Jump over protected fields
 0557   0024              IF Frm.FldNo > Frm.PrevFld THEN       'Going forward?
 0557   0024                 GOSUB ForwardSkipProtected
 0557    **        I00041:   mov     ax,0Ah[bp]
 055A    **                  add     ax,0002h
 055D    **                  mov     si,ax
 055F    **                  mov     cx,[si]
 0561    **                  mov     dx,0Ah[bp]
 0564    **                  add     dx,04h
 0567    **                  mov     si,dx
 0569    **                  cmp     cx,[si]
 056B    **                  mov     ax,0000h
 056E    **                  je      $+01h
 0570    **                  dec     ax
 0571    **                  or      ax,TERMKEY%
 0575    **                  and     ax,ax
 0577    **                  jne     $+03h
 0579    **                  jmp     I00043
 057C    **                  mov     TEMP%,cx
                                                                      PAGE  21
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0580    **                  mov     ax,0FFFFh
 0583    **                  and     ax,ax
 0585    **                  jne     $+03h
 0587    **                  jmp     I00044
 058A    **                  cmp     cx,[si]
 058C    **                  jg      $+03h
 058E    **                  jmp     I00045
 0591    **                  call    I00046
 0594   0028              ELSE                                  'Going backward
                s
 0594    **                  jmp     I00047
 0597   0028                 GOSUB BackwardSkipProtected
 0597    **        I00045:   call    I00048
 059A   0028              END IF
 059A   0028           END IF
 059A    **        I00047:
 059A   0028    
 059A   0028           '----- Setup for Field
 059A   0028           Frm.DoingMult = 0                        'Init. multiple
                 choice flag
 059A   0028           DoingNotes = 0                           'Init. Notes fi
                eld flag
 059A   0028           Frm.PrevFld = Temp                       'Set previous f
                ield #
 059A   0028           Frm.FldEdited = 0                        'Init. "field e
                dited" flag
 059A   0028           LeftCol = Fld(Frm.FldNo).LCol            'Set left colum
                n for field
 059A   0028    
 059A   0028    '       IF Fld(Frm.FldNo).FType = NotesFld THEN  'Set up for "N
                otes" field
 059A   0028    '
 059A   0028    '          FESetUpNotes Form$(), Fld(), Frm
 059A   0028    '
 059A   0028    '          QAction = 1                           'Set QEdit's a
                ction flag to
 059A   0028    '                                                '  initialize 
                state
 059A   0028    '          Ky$ = ""                              'Clear previou
                s key press
 059A   0028    '          DoingNotes = -1                       'Set "Notes" f
                lag
 059A   0028    '       END IF
 059A   0028    
 059A   0028           FieldWas$ = Form$(Frm.FldNo, 0)
 059A   0028           Mask$ = ""
 059A   0028           Frm.TxtPos = 1                           'Start editing 
                at left column
 059A   0028           PosWas = Frm.TxtPos
 059A   0028           FirstKey = -1                            'Flag first key
 059A   0028    
 059A   0028           FType = Fld(Frm.FldNo).FType             'Get fields typ
                e
 059A   0028           IF FType = Relational THEN FType = Fld(Frm.FldNo).Scratc
                                                                      PAGE  22
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

                hI
 059A    **        I00044:   mov     ax,0Ah[bp]
 059D    **                  add     ax,0014h
 05A0    **                  mov     si,ax
 05A2    **                  mov     [si],0000h
 05A6    **                  mov     DOINGNOTES%,0000h
 05AC    **                  mov     ax,0Ah[bp]
 05AF    **                  add     ax,0004h
 05B2    **                  mov     si,ax
 05B4    **                  mov     cx,TEMP%
 05B8    **                  mov     [si],cx
 05BA    **                  mov     ax,0Ah[bp]
 05BD    **                  add     ax,0006h
 05C0    **                  mov     si,ax
 05C2    **                  mov     [si],0000h
 05C6    **                  mov     ax,0Ah[bp]
 05C9    **                  add     ax,0002h
 05CC    **                  mov     si,ax
 05CE    **                  mov     bx,[si]
 05D0    **                  mov     dx,bx
 05D2    **                  sal     bx,1
 05D4    **                  sal     bx,1
 05D6    **                  sal     bx,1
 05D8    **                  sal     bx,1
 05DA    **                  sal     bx,1
 05DC    **                  sal     bx,1
 05DE    **                  mov     si,0Ch[bp]
 05E1    **                  add     bx,0Ah[si]
 05E4    **                  mov     es,02h[si]
 05E7    **                  add     bx,04h
 05EA    **                  es:     
 05EB    **                  mov     cx,[bx]
 05ED    **                  mov     LEFTCOL%,cx
 05F1    **                  sal     dx,1
 05F3    **                  sal     dx,1
 05F5    **                  mov     bx,dx
 05F7    **                  mov     si,0Eh[bp]
 05FA    **                  add     bx,0Ah[si]
 05FD    **                  push    bx
 05FE    **                  push    offset FIELDWAS$
 0601    **                  mov     0ECh[bp],ax
 0604    **                  call    B$SASS
 0609    **                  push    offset <const>
 060C    **                  push    offset MASK$
 060F    **                  call    B$SASS
 0614    **                  mov     ax,0Ah[bp]
 0617    **                  add     ax,000Ah
 061A    **                  mov     si,ax
 061C    **                  mov     [si],0001h
 0620    **                  mov     cx,[si]
 0622    **                  mov     POSWAS%,cx
 0626    **                  mov     FIRSTKEY%,0FFFFh
 062C    **                  mov     si,0ECh[bp]
 062F    **                  mov     bx,[si]
                                                                      PAGE  23
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0631    **                  sal     bx,1
 0633    **                  sal     bx,1
 0635    **                  sal     bx,1
 0637    **                  sal     bx,1
 0639    **                  sal     bx,1
 063B    **                  sal     bx,1
 063D    **                  mov     si,0Ch[bp]
 0640    **                  mov     dx,bx
 0642    **                  add     bx,0Ah[si]
 0645    **                  mov     es,02h[si]
 0648    **                  add     bx,0Ah
 064B    **                  es:     
 064C    **                  mov     ax,[bx]
 064E    **                  mov     FTYPE%,ax
 0651    **                  cmp     ax,000Bh
 0654    **                  jne     I00049
 0656    **                  mov     bx,dx
 0658    **                  add     bx,0Ah[si]
 065B    **                  mov     es,02h[si]
 065E    **                  add     bx,26h
 0661    **                  es:     
 0662    **                  mov     ax,[bx]
 0664    **                  mov     FTYPE%,ax
 0667   003A    
 0667   003A           SELECT CASE FType                        'Do additional 
                setup
 0667   003A              CASE StrFld
 0667   003A                 EdType = 0                         'Set flag for n
                ormal string
 0667   003A              CASE PropStrFld
 0667    **        I00049:   mov     ax,FTYPE%
 066A    **                  mov     t003A%,ax
 066D    **                  cmp     word ptr t003A%,01h
 0672    **                  jne     I00050
 0674    **                  mov     EDTYPE%,0000h
 067A    **                  jmp     I00051
 067D   003E                 EdType = Propr
 067D   003E              CASE UCaseStrFld
 067D    **        I00050:   cmp     word ptr t003A%,17h
 0682    **                  jne     I00052
 0684    **                  mov     EDTYPE%,0006h
 068A    **                  jmp     I00051
 068D   003E                 EdType = UCase                     'Flag "Upper Ca
                se" strings
 068D   003E              CASE NumericStrFld
 068D    **        I00052:   cmp     word ptr t003A%,02h
 0692    **                  jne     I00053
 0694    **                  mov     EDTYPE%,0001h
 069A    **                  jmp     I00051
 069D   003E                 EdType = Intgr                     'Flag "Numeric"
                 strings
 069D   003E              CASE IntFld, LongIntFld
 069D    **        I00053:   cmp     word ptr t003A%,10h
 06A2    **                  jne     I00054
                                                                      PAGE  24
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 06A4    **                  mov     EDTYPE%,0002h
 06AA    **                  jmp     I00051
 06AD    **        I00054:   cmp     word ptr t003A%,03h
 06B2    **                  je      I00055
 06B4    **                  cmp     word ptr t003A%,12h
 06B9    **                  je      $+03h
 06BB    **                  jmp     I00056
 06BE   003E                 EdType = Intgr                     'Flag "Integer"
                 editing
 06BE   003E              CASE SngFld, DblFld
 06BE    **        I00055:   mov     EDTYPE%,0002h
 06C4    **                  jmp     I00051
 06C7    **        I00056:   cmp     word ptr t003A%,04h
 06CC    **                  je      I00057
 06CE    **                  cmp     word ptr t003A%,05h
 06D3    **                  je      $+03h
 06D5    **                  jmp     I00058
 06D8   003E                 EdType = FloatP                    'Flag "Floating
                 Point" editing
 06D8   003E              CASE MoneyFld
 06D8    **        I00057:   mov     EDTYPE%,0003h
 06DE    **                  jmp     I00051
 06E1   003E                 EdType = Money                     'Flag "Currency
                " editing
 06E1   003E              CASE DateFld, EuroDateFld
 06E1    **        I00058:   cmp     word ptr t003A%,0Ah
 06E6    **                  jne     I00059
 06E8    **                  mov     EDTYPE%,0004h
 06EE    **                  jmp     I00051
 06F1    **        I00059:   cmp     word ptr t003A%,06h
 06F6    **                  je      I00060
 06F8    **                  cmp     word ptr t003A%,13h
 06FD    **                  je      $+03h
 06FF    **                  jmp     I00061
 0702   003E                 EdType = Intgr                     'Flag "Integer"
                 editing
 0702   003E                 Mask$ = ""
 0702   003E              CASE PhoneFld
 0702    **        I00060:   mov     EDTYPE%,0002h
 0708    **                  push    offset <const>
 070B    **                  push    offset MASK$
 070E    **                  call    B$SASS
 0713    **                  jmp     I00051
 0716   003E                 EdType = Intgr                     'Flag "Integer"
                 editing
 0716   003E                 Frm.TxtPos = 2
 0716   003E                 Mask$ = ""
 0716   003E              CASE SoSecFld
 0716    **        I00061:   cmp     word ptr t003A%,07h
 071B    **                  jne     I00062
 071D    **                  mov     EDTYPE%,0002h
 0723    **                  mov     ax,0Ah[bp]
 0726    **                  add     ax,000Ah
 0729    **                  mov     si,ax
                                                                      PAGE  25
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 072B    **                  mov     [si],0002h
 072F    **                  push    offset <const>
 0732    **                  push    offset MASK$
 0735    **                  call    B$SASS
 073A    **                  jmp     I00051
 073D   003E                 EdType = Intgr                     'Flag "Integer"
                 editing
 073D   003E                 Mask$ = ""
 073D   003E              CASE ZipFld
 073D    **        I00062:   cmp     word ptr t003A%,08h
 0742    **                  jne     I00063
 0744    **                  mov     EDTYPE%,0002h
 074A    **                  push    offset <const>
 074D    **                  push    offset MASK$
 0750    **                  call    B$SASS
 0755    **                  jmp     I00051
 0758   003E                 EdType = Intgr                     'Flag "Integer"
                 editing
 0758   003E                 Mask$ = ""
 0758   003E              CASE LogicalFld
 0758    **        I00063:   cmp     word ptr t003A%,09h
 075D    **                  jne     I00064
 075F    **                  mov     EDTYPE%,0002h
 0765    **                  push    offset <const>
 0768    **                  push    offset MASK$
 076B    **                  call    B$SASS
 0770    **                  jmp     I00051
 0773   003E                 EdType = LogicalFld                'Flag "Logical"
                 editing
 0773   003E                 LogicChars$ = MID$(Fld(Frm.FldNo).RelFile, 1, 1) +
                 MID$(Fld(Frm.FldNo).RelFile, 3, 1)
 0773   003E              CASE MultChAFld
 0773    **        I00064:   cmp     word ptr t003A%,0Eh
 0778    **                  jne     I00065
 077A    **                  mov     EDTYPE%,000Eh
 0780    **                  mov     ax,0Ah[bp]
 0783    **                  add     ax,0002h
 0786    **                  mov     si,ax
 0788    **                  mov     bx,[si]
 078A    **                  sal     bx,1
 078C    **                  sal     bx,1
 078E    **                  sal     bx,1
 0790    **                  sal     bx,1
 0792    **                  sal     bx,1
 0794    **                  sal     bx,1
 0796    **                  mov     si,0Ch[bp]
 0799    **                  mov     dx,bx
 079B    **                  add     bx,0Ah[si]
 079E    **                  mov     es,02h[si]
 07A1    **                  add     bx,0Ch
 07A4    **                  push    es
 07A5    **                  push    bx
 07A6    **                  mov     ax,0008h
 07A9    **                  push    ax
                                                                      PAGE  26
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 07AA    **                  mov     0EAh[bp],dx
 07AD    **                  call    B$LDFS
 07B2    **                  push    ax
 07B3    **                  push    01h
 07B5    **                  push    01h
 07B7    **                  call    B$FMID
 07BC    **                  push    ax
 07BD    **                  mov     bx,0EAh[bp]
 07C0    **                  add     bx,0Ah[si]
 07C3    **                  mov     es,02h[si]
 07C6    **                  add     bx,0Ch
 07C9    **                  push    es
 07CA    **                  push    bx
 07CB    **                  mov     ax,0008h
 07CE    **                  push    ax
 07CF    **                  call    B$LDFS
 07D4    **                  push    ax
 07D5    **                  push    03h
 07D7    **                  push    01h
 07D9    **                  call    B$FMID
 07DE    **                  push    ax
 07DF    **                  call    B$SCAT
 07E4    **                  push    ax
 07E5    **                  push    offset LOGICCHARS$
 07E8    **                  call    B$SASS
 07ED    **                  jmp     I00051
 07F0   0042                 EdType = MultFld                   'Flag Multiple 
                choice editing
 07F0   0042              CASE Button
 07F0    **        I00065:   cmp     word ptr t003A%,16h
 07F5    **                  jne     I00066
 07F7    **                  mov     EDTYPE%,0005h
 07FD    **                  jmp     I00051
 0800   0042                 EdType = ButtonFld
 0800   0042              CASE ELSE
 0800    **        I00066:   cmp     word ptr t003A%,18h
 0805    **                  jne     I00067
 0807    **                  mov     EDTYPE%,0007h
 080D    **                  jmp     I00051
 0810   0042           END SELECT
 0810    **        I00067:
 0810   0042                
 0810   0042        END IF
 0810    **        I00051:
 0810   0042    
 0810   0042        '----- Poll for key/mouse activity
 0810   0042        TermKey = 0                                 'Init. "Un-hand
                led" key flag
 0810   0042    
 0810   0042        IF Frm.DoingMult THEN                       'Multiple Choic
                e field
 0810   0042           
 0810   0042           Frm.Presses = 0                          'No mouse press
                es
                                                                      PAGE  27
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0810   0042    
 0810   0042           VertMenu Work$(), Choice, VertLen, 0, Ky$, VAction, Cnf
 0810    **        I00043:   mov     TERMKEY%,0000h
 0816    **                  mov     ax,0Ah[bp]
 0819    **                  add     ax,0014h
 081C    **                  mov     si,ax
 081E    **                  mov     cx,[si]
 0820    **                  and     cx,cx
 0822    **                  jne     $+03h
 0824    **                  jmp     I00068
 0827    **                  mov     ax,0Ah[bp]
 082A    **                  add     ax,000Eh
 082D    **                  mov     si,ax
 082F    **                  mov     [si],0000h
 0833    **                  mov     t0042%,0000h
 0839    **                  push    offset WORK$
 083C    **                  push    offset CHOICE%
 083F    **                  push    offset VERTLEN%
 0842    **                  push    offset t0042%
 0845    **                  push    offset KY$
 0848    **                  push    offset VACTION%
 084B    **                  push    08h[bp]
 084E    **                  call    VERTMENU
 0853   004E    
 0853   004E    '    ELSEIF DoingNotes THEN                      'Notes field
 0853   004E    '
 0853   004E    '       QEdit Work$(), Ky$, QAction, Ed          'Poll "QEdit"
 0853   004E    '
 0853   004E    '       IF Ed.UnKnownKey AND LagKey <> -59 THEN
 0853   004E    '          TermKey = -1                          'Key not handl
                ed by "QEdit"?
 0853   004E    '
 0853   004E    '       END IF
 0853   004E    '       Frm.Presses = Ed.Presses                 'Copy QEdit's 
                mouse info.
 0853   004E    '
 0853   004E    '       Frm.MRow = Ed.MRow
 0853   004E    '       Frm.MCol = Ed.MCol
 0853   004E    
 0853   004E        ELSE                                        'All other fiel
                ds
 0853    **                  jmp     I00069
 0856   004E                                                    'Locate cursor,
                 turn it on
 0856   004E           IF Fld(Frm.FldNo).FType = Button THEN
 0856   004E              LOCATE Fld(Frm.FldNo).Row, (Fld(Frm.FldNo).RCol - Fld
                (Frm.FldNo).LCol) \ 2 + Fld(Frm.FldNo).LCol, 1
 0856   004E           ELSE
 0856    **        I00068:   mov     ax,0Ah[bp]
 0859    **                  add     ax,0002h
 085C    **                  mov     si,ax
 085E    **                  mov     bx,[si]
 0860    **                  sal     bx,1
 0862    **                  sal     bx,1
                                                                      PAGE  28
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0864    **                  sal     bx,1
 0866    **                  sal     bx,1
 0868    **                  sal     bx,1
 086A    **                  sal     bx,1
 086C    **                  mov     si,0Ch[bp]
 086F    **                  mov     dx,bx
 0871    **                  add     bx,0Ah[si]
 0874    **                  mov     es,02h[si]
 0877    **                  add     bx,0Ah
 087A    **                  es:     
 087B    **                  cmp     word ptr [bx],18h
 087E    **                  jne     I00070
 0880    **                  push    01h
 0882    **                  mov     bx,dx
 0884    **                  add     bx,0Ah[si]
 0887    **                  mov     es,02h[si]
 088A    **                  add     bx,02h
 088D    **                  es:     
 088E    **                  push    [bx]
 0890    **                  push    01h
 0892    **                  mov     bx,dx
 0894    **                  add     bx,0Ah[si]
 0897    **                  mov     es,02h[si]
 089A    **                  add     bx,06h
 089D    **                  es:     
 089E    **                  mov     ax,[bx]
 08A0    **                  mov     bx,dx
 08A2    **                  add     bx,0Ah[si]
 08A5    **                  mov     es,02h[si]
 08A8    **                  add     bx,04h
 08AB    **                  es:     
 08AC    **                  sub     ax,[bx]
 08AE    **                  mov     bx,dx
 08B0    **                  mov     cx,0002h
 08B3    **                  cwd     
 08B4    **                  idiv    cx
 08B6    **                  add     bx,0Ah[si]
 08B9    **                  mov     es,02h[si]
 08BC    **                  add     bx,04h
 08BF    **                  es:     
 08C0    **                  add     ax,[bx]
 08C2    **                  push    ax
 08C3    **                  push    01h
 08C5    **                  push    01h
 08C7    **                  push    06h
 08C9    **                  call    B$LOCT
 08CE    **                  jmp     I00071
 08D1   004E              LOCATE Fld(Frm.FldNo).Row, LeftCol + Frm.TxtPos - 1, 
                1
 08D1   004E           END IF
 08D1    **        I00070:   push    01h
 08D3    **                  mov     ax,0Ah[bp]
 08D6    **                  add     ax,0002h
 08D9    **                  mov     si,ax
                                                                      PAGE  29
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 08DB    **                  mov     bx,[si]
 08DD    **                  sal     bx,1
 08DF    **                  sal     bx,1
 08E1    **                  sal     bx,1
 08E3    **                  sal     bx,1
 08E5    **                  sal     bx,1
 08E7    **                  sal     bx,1
 08E9    **                  mov     si,0Ch[bp]
 08EC    **                  add     bx,0Ah[si]
 08EF    **                  mov     es,02h[si]
 08F2    **                  add     bx,02h
 08F5    **                  es:     
 08F6    **                  push    [bx]
 08F8    **                  push    01h
 08FA    **                  mov     ax,0Ah[bp]
 08FD    **                  add     ax,000Ah
 0900    **                  mov     si,ax
 0902    **                  mov     cx,[si]
 0904    **                  add     cx,LEFTCOL%
 0908    **                  dec     cx
 0909    **                  push    cx
 090A    **                  push    01h
 090C    **                  push    01h
 090E    **                  push    06h
 0910    **                  call    B$LOCT
 0915   004E    
 0915   004E           Ky$ = INKEY$                             'Get a key stro
                ke
 0915   004E    
 0915   004E           '----- Check Mouse activity
 0915   004E           ButtonPress 1, N, Frm.Presses, X, Y
 0915    **        I00071:   call    B$INKY
 091A    **                  push    ax
 091B    **                  push    offset KY$
 091E    **                  call    B$SASS
 0923    **                  mov     t004E%,0001h
 0929    **                  push    offset t004E%
 092C    **                  push    offset N%
 092F    **                  mov     ax,0Ah[bp]
 0932    **                  add     ax,000Eh
 0935    **                  push    ax
 0936    **                  push    offset X%
 0939    **                  push    offset Y%
 093C    **                  call    BUTTONPRESS
 0941   0056           IF Frm.Presses THEN
 0941   0056              Frm.MRow = (Y \ NPixLines) + 1        'Convert X, Y t
                o Row and Col.
 0941   0056              Frm.MCol = (X \ 8) + 1
 0941   0056           END IF
 0941    **                  mov     ax,0Ah[bp]
 0944    **                  add     ax,000Eh
 0947    **                  mov     si,ax
 0949    **                  mov     cx,[si]
 094B    **                  and     cx,cx
                                                                      PAGE  30
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 094D    **                  je      I00072
 094F    **                  mov     ax,Y%
 0952    **                  cwd     
 0953    **                  idiv    NPIXLINES%
 0957    **                  inc     ax
 0958    **                  mov     cx,0Ah[bp]
 095B    **                  add     cx,10h
 095E    **                  mov     si,cx
 0960    **                  mov     [si],ax
 0962    **                  mov     cx,0008h
 0965    **                  mov     ax,X%
 0968    **                  cwd     
 0969    **                  idiv    cx
 096B    **                  inc     ax
 096C    **                  mov     cx,0Ah[bp]
 096F    **                  add     cx,12h
 0972    **                  mov     si,cx
 0974    **                  mov     [si],ax
 0976   0058    
 0976   0058    '*** 06-30-94
 0976   0058    'Added Right moose button as the ESC key
 0976   0058    'major improvement in mouse handeling
 0976   0058           IF N AND 2 THEN                'if it was the right moos
                e button and
 0976   0058             DO                           'if they are still holdin
                g it down then
 0976    **        I00072:   mov     ax,N%
 0979    **                  and     ax,0002h
 097C    **                  and     ax,ax
 097E    **                  jne     $+03h
 0980    **                  jmp     I00073
 0983    **                  nop     
 0984   0058               GetCursor 0, 0, NewStatus  'wait till they let go of
                 the button
 0984    **        I00074:   mov     t0058%,0000h
 098A    **                  mov     t005A%,0000h
 0990    **                  push    offset t0058%
 0993    **                  push    offset t005A%
 0996    **                  push    offset NEWSTATUS%
 0999    **                  call    GETCURSOR
 099E   005E             LOOP WHILE NewStatus
 099E   005E             ButtonPress 0, 0, 0, 0, 0    'this has the effect of c
                learing all
 099E    **                  mov     ax,NEWSTATUS%
 09A1    **                  and     ax,ax
 09A3    **                  jne     I00074
 09A5    **                  mov     t005E%,0000h
 09AB    **                  mov     t0060%,0000h
 09B1    **                  mov     t0062%,0000h
 09B7    **                  mov     t0064%,0000h
 09BD    **                  mov     t0066%,0000h
 09C3    **                  push    offset t005E%
 09C6    **                  push    offset t0060%
 09C9    **                  push    offset t0062%
                                                                      PAGE  31
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 09CC    **                  push    offset t0064%
 09CF    **                  push    offset t0066%
 09D2    **                  call    BUTTONPRESS
 09D7   0068             Ky$ = CHR$(EscKey)           'moose buttons.
 09D7   0068             TermKey = -1
 09D7   0068          END IF
 09D7    **                  push    1Bh
 09D9    **                  call    B$FCHR
 09DE    **                  push    ax
 09DF    **                  push    offset KY$
 09E2    **                  call    B$SASS
 09E7    **                  mov     TERMKEY%,0FFFFh
 09ED   0068    
 09ED   0068        END IF
 09ED    **        I00073:
 09ED   0068    
 09ED   0068    
 09ED   0068        '----- Handle mouse activity
 09ED   0068        IF Frm.Presses THEN
 09ED   0068    
 09ED   0068           FOR N = Frm.StartEl + 1 TO EndOfForm     'Check all fiel
                ds to see if
 09ED    **        I00069:   mov     ax,0Ah[bp]
 09F0    **                  add     ax,000Eh
 09F3    **                  mov     si,ax
 09F5    **                  mov     cx,[si]
 09F7    **                  and     cx,cx
 09F9    **                  jne     $+03h
 09FB    **                  jmp     I00075
 09FE    **                  mov     ax,ENDOFFORM%
 0A01    **                  mov     t0068%,ax
 0A04    **                  mov     si,0Ah[bp]
 0A07    **                  mov     ax,[si]
 0A09    **                  inc     ax
 0A0A    **                  jmp     I00076
 0A0D    **                  nop     
 0A0E   006A                                                    '   mouse press
                ed in one
 0A0E   006A               IF Fld(N).FType = NotesFld THEN      'Set rows for n
                otes field
 0A0E   006A                  X = Fld(N).ScratchI
 0A0E   006A               ELSE
 0A0E    **        I00077:   sal     ax,1
 0A10    **                  sal     ax,1
 0A12    **                  sal     ax,1
 0A14    **                  sal     ax,1
 0A16    **                  sal     ax,1
 0A18    **                  sal     ax,1
 0A1A    **                  mov     bx,ax
 0A1C    **                  mov     si,0Ch[bp]
 0A1F    **                  add     bx,0Ah[si]
 0A22    **                  mov     es,02h[si]
 0A25    **                  add     bx,0Ah
 0A28    **                  es:     
                                                                      PAGE  32
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0A29    **                  cmp     word ptr [bx],11h
 0A2C    **                  jne     I00078
 0A2E    **                  mov     bx,ax
 0A30    **                  add     bx,0Ah[si]
 0A33    **                  mov     es,02h[si]
 0A36    **                  add     bx,26h
 0A39    **                  es:     
 0A3A    **                  mov     ax,[bx]
 0A3C    **                  mov     X%,ax
 0A3F    **                  jmp     I00079
 0A42   006A                  X = Fld(N).Row
 0A42   006A               END IF
 0A42    **        I00078:   mov     bx,N%
 0A46    **                  sal     bx,1
 0A48    **                  sal     bx,1
 0A4A    **                  sal     bx,1
 0A4C    **                  sal     bx,1
 0A4E    **                  sal     bx,1
 0A50    **                  sal     bx,1
 0A52    **                  mov     si,0Ch[bp]
 0A55    **                  add     bx,0Ah[si]
 0A58    **                  mov     es,02h[si]
 0A5B    **                  add     bx,02h
 0A5E    **                  es:     
 0A5F    **                  mov     ax,[bx]
 0A61    **                  mov     X%,ax
 0A64   006A                                                    'Check fields r
                ow range
 0A64   006A               IF Frm.MRow >= Fld(N).Row AND Frm.MRow <= X THEN
 0A64   006A                                                    'Check fields c
                olumn range
 0A64   006A                  IF Frm.MCol >= Fld(N).LCol AND Frm.MCol <= Fld(N)
                .RCol THEN
 0A64   006A                                                    'Is the field p
                rotected?
 0A64   006A                     IF NOT (SkipProtected AND Fld(N).Protected) TH
                EN
 0A64   006A                        IF N = Frm.FldNo THEN       'Pressed on the
                 current field?
 0A64   006A                           SELECT CASE Fld(N).FType
 0A64   006A                           CASE MultChAFld
 0A64   006A                              Ky$ = CHR$(13)
 0A64   006A                           CASE LogicalFld
 0A64    **        I00079:   mov     ax,0Ah[bp]
 0A67    **                  add     ax,0010h
 0A6A    **                  mov     si,ax
 0A6C    **                  mov     cx,[si]
 0A6E    **                  mov     bx,N%
 0A72    **                  sal     bx,1
 0A74    **                  sal     bx,1
 0A76    **                  sal     bx,1
 0A78    **                  sal     bx,1
 0A7A    **                  sal     bx,1
 0A7C    **                  sal     bx,1
                                                                      PAGE  33
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0A7E    **                  mov     si,0Ch[bp]
 0A81    **                  mov     dx,bx
 0A83    **                  add     bx,0Ah[si]
 0A86    **                  mov     es,02h[si]
 0A89    **                  add     bx,02h
 0A8C    **                  es:     
 0A8D    **                  cmp     cx,[bx]
 0A8F    **                  jnl     $+03h
 0A91    **                  jmp     I00080
 0A94    **                  cmp     cx,X%
 0A98    **                  jng     $+03h
 0A9A    **                  jmp     I00080
 0A9D    **                  mov     ax,0Ah[bp]
 0AA0    **                  add     ax,0012h
 0AA3    **                  mov     di,ax
 0AA5    **                  mov     cx,[di]
 0AA7    **                  mov     bx,dx
 0AA9    **                  add     bx,0Ah[si]
 0AAC    **                  mov     es,02h[si]
 0AAF    **                  add     bx,04h
 0AB2    **                  es:     
 0AB3    **                  cmp     cx,[bx]
 0AB5    **                  jnl     $+03h
 0AB7    **                  jmp     I00081
 0ABA    **                  mov     bx,dx
 0ABC    **                  add     bx,0Ah[si]
 0ABF    **                  mov     es,02h[si]
 0AC2    **                  add     bx,06h
 0AC5    **                  es:     
 0AC6    **                  cmp     cx,[bx]
 0AC8    **                  jng     $+03h
 0ACA    **                  jmp     I00081
 0ACD    **                  mov     bx,dx
 0ACF    **                  add     bx,0Ah[si]
 0AD2    **                  mov     es,02h[si]
 0AD5    **                  add     bx,24h
 0AD8    **                  es:     
 0AD9    **                  mov     ax,[bx]
 0ADB    **                  and     ax,0FFFFh
 0ADE    **                  not     ax
 0AE0    **                  and     ax,ax
 0AE2    **                  jne     $+03h
 0AE4    **                  jmp     I00082
 0AE7    **                  mov     ax,0Ah[bp]
 0AEA    **                  add     ax,0002h
 0AED    **                  mov     di,ax
 0AEF    **                  mov     cx,[di]
 0AF1    **                  cmp     cx,N%
 0AF5    **                  je      $+03h
 0AF7    **                  jmp     I00083
 0AFA    **                  mov     bx,dx
 0AFC    **                  add     bx,0Ah[si]
 0AFF    **                  mov     es,02h[si]
 0B02    **                  add     bx,0Ah
                                                                      PAGE  34
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0B05    **                  es:     
 0B06    **                  mov     ax,[bx]
 0B08    **                  mov     t006A%,ax
 0B0B    **                  cmp     word ptr t006A%,16h
 0B10    **                  jne     I00084
 0B12    **                  push    0Dh
 0B14    **                  call    B$FCHR
 0B19    **                  push    ax
 0B1A    **                  push    offset KY$
 0B1D    **                  call    B$SASS
 0B22    **                  jmp     I00085
 0B25   006C                              Ky$ = CHR$(32)
 0B25   006C                           CASE IS <> Button        'Move the curso
                r to mouse
 0B25    **        I00084:   cmp     word ptr t006A%,0Eh
 0B2A    **                  jne     I00086
 0B2C    **                  push    20h
 0B2E    **                  call    B$FCHR
 0B33    **                  push    ax
 0B34    **                  push    offset KY$
 0B37    **                  call    B$SASS
 0B3C    **                  jmp     I00085
 0B3F   006C                              Frm.TxtPos = Frm.MCol - LeftCol + 1
 0B3F   006C                           CASE ELSE
 0B3F    **        I00086:   cmp     word ptr t006A%,18h
 0B44    **                  je      I00087
 0B46    **                  mov     ax,0Ah[bp]
 0B49    **                  add     ax,0012h
 0B4C    **                  mov     si,ax
 0B4E    **                  mov     cx,[si]
 0B50    **                  sub     cx,LEFTCOL%
 0B54    **                  inc     cx
 0B55    **                  mov     ax,0Ah[bp]
 0B58    **                  add     ax,000Ah
 0B5B    **                  mov     si,ax
 0B5D    **                  mov     [si],cx
 0B5F    **                  jmp     I00085
 0B62   006C                           END SELECT
 0B62    **        I00087:
 0B62   006C                           FirstKey = 0
 0B62   006C                        ELSE                        'New field
 0B62    **        I00085:   mov     FIRSTKEY%,0000h
 0B68    **                  jmp     I00088
 0B6B   006C                           DoingNotes = 0
 0B6B   006C                           Frm.FldNo = N            'Set the new fi
                eld number
 0B6B   006C                        END IF
 0B6B    **        I00083:   mov     DOINGNOTES%,0000h
 0B71    **                  mov     ax,0Ah[bp]
 0B74    **                  add     ax,0002h
 0B77    **                  mov     si,ax
 0B79    **                  mov     cx,N%
 0B7D    **                  mov     [si],cx
 0B7F   006C                        
                                                                      PAGE  35
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0B7F   006C                        EXIT FOR                    'All done, bail
                 out
 0B7F   006C                     END IF
 0B7F    **        I00088:   jmp     I00089
 0B82   006C                  END IF
 0B82    **        I00082:
 0B82   006C               END IF
 0B82    **        I00081:
 0B82   006C           NEXT
 0B82    **        I00080:   mov     ax,N%
 0B85    **                  inc     ax
 0B86    **        I00076:   mov     N%,ax
 0B89    **                  cmp     ax,t0068%
 0B8D    **                  jg      $+03h
 0B8F    **                  jmp     I00077
 0B92   006C          
 0B92   006C           IF N > EndOfForm THEN                    'Not on any fie
                lds?
 0B92   006C    '         TermKey = -1
 0B92   006C    '         ^^^^^^^^^^^^
 0B92   006C    'This was done so external buttons (buttons not attached to a f
                orm)
 0B92   006C    'DO NOT ADJUST THE CURSOR POSTION.
 0B92   006C    '
 0B92   006C           ELSEIF Fld(Frm.FldNo).FType = Button THEN
 0B92    **        I00089:   mov     ax,ENDOFFORM%
 0B95    **                  cmp     ax,N%
 0B99    **                  jnl     I00090
 0B9B    **                  jmp     I00091
 0B9E   006C              Ky$ = CHR$(ABS(Fld(Frm.FldNo).ScratchI))
 0B9E   006C              IF Fld(Frm.FldNo).ScratchI < 0 THEN Ky$ = CHR$(0) + K
                y$
 0B9E    **        I00090:   mov     ax,0Ah[bp]
 0BA1    **                  add     ax,0002h
 0BA4    **                  mov     si,ax
 0BA6    **                  mov     bx,[si]
 0BA8    **                  sal     bx,1
 0BAA    **                  sal     bx,1
 0BAC    **                  sal     bx,1
 0BAE    **                  sal     bx,1
 0BB0    **                  sal     bx,1
 0BB2    **                  sal     bx,1
 0BB4    **                  mov     si,0Ch[bp]
 0BB7    **                  mov     dx,bx
 0BB9    **                  add     bx,0Ah[si]
 0BBC    **                  mov     es,02h[si]
 0BBF    **                  add     bx,0Ah
 0BC2    **                  es:     
 0BC3    **                  cmp     word ptr [bx],18h
 0BC6    **                  je      $+03h
 0BC8    **                  jmp     I00092
 0BCB    **                  mov     bx,dx
 0BCD    **                  add     bx,0Ah[si]
 0BD0    **                  mov     es,02h[si]
                                                                      PAGE  36
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0BD3    **                  add     bx,26h
 0BD6    **                  es:     
 0BD7    **                  mov     ax,[bx]
 0BD9    **                  mov     cx,dx
 0BDB    **                  cwd     
 0BDC    **                  xor     ax,dx
 0BDE    **                  sub     ax,dx
 0BE0    **                  push    ax
 0BE1    **                  mov     0E8h[bp],cx
 0BE4    **                  call    B$FCHR
 0BE9    **                  push    ax
 0BEA    **                  push    offset KY$
 0BED    **                  call    B$SASS
 0BF2    **                  mov     bx,0E8h[bp]
 0BF5    **                  add     bx,0Ah[si]
 0BF8    **                  mov     es,02h[si]
 0BFB    **                  add     bx,26h
 0BFE    **                  es:     
 0BFF    **                  cmp     word ptr [bx],00h
 0C02    **                  jnl     I00093
 0C04    **                  push    00h
 0C06    **                  call    B$FCHR
 0C0B    **                  push    ax
 0C0C    **                  push    offset KY$
 0C0F    **                  call    B$SCAT
 0C14    **                  push    ax
 0C15    **                  push    offset KY$
 0C18    **                  call    B$SASS
 0C1D   006C              FEPressButton Fld(Frm.FldNo)
 0C1D    **        I00093:   mov     ax,0Ah[bp]
 0C20    **                  add     ax,0002h
 0C23    **                  mov     si,ax
 0C25    **                  mov     bx,[si]
 0C27    **                  sal     bx,1
 0C29    **                  sal     bx,1
 0C2B    **                  sal     bx,1
 0C2D    **                  sal     bx,1
 0C2F    **                  sal     bx,1
 0C31    **                  sal     bx,1
 0C33    **                  mov     si,0Ch[bp]
 0C36    **                  mov     dx,bx
 0C38    **                  add     bx,0Ah[si]
 0C3B    **                  mov     es,02h[si]
 0C3E    **                  push    es
 0C3F    **                  push    bx
 0C40    **                  mov     ax,0040h
 0C43    **                  push    ax
 0C44    **                  push    ds
 0C45    **                  push    offset t006C
 0C48    **                  mov     ax,0040h
 0C4B    **                  push    ax
 0C4C    **                  mov     0E6h[bp],dx
 0C4F    **                  call    B$ASSN
 0C54    **                  push    offset t006C
                                                                      PAGE  37
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0C57    **                  call    FEPRESSBUTTON
 0C5C    **                  push    ds
 0C5D    **                  push    offset t006C
 0C60    **                  mov     ax,0040h
 0C63    **                  push    ax
 0C64    **                  mov     si,0Ch[bp]
 0C67    **                  mov     bx,0E6h[bp]
 0C6A    **                  add     bx,0Ah[si]
 0C6D    **                  mov     es,02h[si]
 0C70    **                  push    es
 0C71    **                  push    bx
 0C72    **                  mov     ax,0040h
 0C75    **                  push    ax
 0C76    **                  call    B$ASSN
 0C7B   00AC           END IF
 0C7B    **        I00091:
 0C7B   00AC        END IF
 0C7B    **        I00092:
 0C7B   00AC    
 0C7B   00AC    
 0C7B   00AC        '----- Turn key $ into code
 0C7B   00AC        SELECT CASE LEN(Ky$)
 0C7B   00AC           CASE 0
 0C7B   00AC              Frm.KeyCode = 0                       'No key pressed
 0C7B   00AC           CASE 1
 0C7B    **        I00075:   mov     ax,KY$
 0C7E    **                  mov     t00AC%,ax
 0C81    **                  cmp     word ptr t00AC%,00h
 0C86    **                  jne     I00094
 0C88    **                  mov     ax,0Ah[bp]
 0C8B    **                  add     ax,0008h
 0C8E    **                  mov     si,ax
 0C90    **                  mov     [si],0000h
 0C94    **                  jmp     I00095
 0C97   00AE              Frm.KeyCode = ASC(Ky$)                'Single charact
                er key
 0C97   00AE           CASE ELSE
 0C97    **        I00094:   cmp     word ptr t00AC%,01h
 0C9C    **                  jne     I00096
 0C9E    **                  push    offset KY$
 0CA1    **                  call    B$FASC
 0CA6    **                  mov     cx,0Ah[bp]
 0CA9    **                  add     cx,08h
 0CAC    **                  mov     si,cx
 0CAE    **                  mov     [si],ax
 0CB0    **                  jmp     I00095
 0CB3   00AE              Frm.KeyCode = -ASC(RIGHT$(Ky$, 1))    'Extended keys 
                are negative
 0CB3   00AE        END SELECT
 0CB3    **        I00096:   push    offset KY$
 0CB6    **                  push    01h
 0CB8    **                  call    B$RGHT
 0CBD    **                  push    ax
 0CBE    **                  call    B$FASC
                                                                      PAGE  38
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0CC3    **                  neg     ax
 0CC5    **                  mov     cx,0Ah[bp]
 0CC8    **                  add     cx,08h
 0CCB    **                  mov     si,cx
 0CCD    **                  mov     [si],ax
 0CCF   00AE    
 0CCF   00AE    
 0CCF   00AE        '----- Check for Button commands
 0CCF   00AE        IF Frm.KeyCode = 13 THEN
 0CCF   00AE           IF Fld(Frm.FldNo).FType = Button THEN
 0CCF   00AE              Frm.KeyCode = Fld(Frm.FldNo).ScratchI
 0CCF   00AE              FEPressButton Fld(Frm.FldNo)
 0CCF    **        I00095:   mov     ax,0Ah[bp]
 0CD2    **                  add     ax,0008h
 0CD5    **                  mov     si,ax
 0CD7    **                  cmp     word ptr [si],0Dh
 0CDA    **                  je      $+03h
 0CDC    **                  jmp     I00097
 0CDF    **                  mov     cx,0Ah[bp]
 0CE2    **                  add     cx,02h
 0CE5    **                  mov     di,cx
 0CE7    **                  mov     bx,[di]
 0CE9    **                  sal     bx,1
 0CEB    **                  sal     bx,1
 0CED    **                  sal     bx,1
 0CEF    **                  sal     bx,1
 0CF1    **                  sal     bx,1
 0CF3    **                  sal     bx,1
 0CF5    **                  mov     si,0Ch[bp]
 0CF8    **                  mov     dx,bx
 0CFA    **                  add     bx,0Ah[si]
 0CFD    **                  mov     es,02h[si]
 0D00    **                  add     bx,0Ah
 0D03    **                  es:     
 0D04    **                  cmp     word ptr [bx],18h
 0D07    **                  je      $+03h
 0D09    **                  jmp     I00098
 0D0C    **                  mov     bx,dx
 0D0E    **                  add     bx,0Ah[si]
 0D11    **                  mov     es,02h[si]
 0D14    **                  add     bx,26h
 0D17    **                  es:     
 0D18    **                  mov     cx,[bx]
 0D1A    **                  mov     si,ax
 0D1C    **                  mov     [si],cx
 0D1E    **                  mov     ax,0Ah[bp]
 0D21    **                  add     ax,0002h
 0D24    **                  mov     si,ax
 0D26    **                  mov     bx,[si]
 0D28    **                  sal     bx,1
 0D2A    **                  sal     bx,1
 0D2C    **                  sal     bx,1
 0D2E    **                  sal     bx,1
 0D30    **                  sal     bx,1
                                                                      PAGE  39
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0D32    **                  sal     bx,1
 0D34    **                  mov     si,0Ch[bp]
 0D37    **                  mov     dx,bx
 0D39    **                  add     bx,0Ah[si]
 0D3C    **                  mov     es,02h[si]
 0D3F    **                  push    es
 0D40    **                  push    bx
 0D41    **                  mov     ax,0040h
 0D44    **                  push    ax
 0D45    **                  push    ds
 0D46    **                  push    offset t00AE
 0D49    **                  mov     ax,0040h
 0D4C    **                  push    ax
 0D4D    **                  mov     0E4h[bp],dx
 0D50    **                  call    B$ASSN
 0D55    **                  push    offset t00AE
 0D58    **                  call    FEPRESSBUTTON
 0D5D    **                  push    ds
 0D5E    **                  push    offset t00AE
 0D61    **                  mov     ax,0040h
 0D64    **                  push    ax
 0D65    **                  mov     si,0Ch[bp]
 0D68    **                  mov     bx,0E4h[bp]
 0D6B    **                  add     bx,0Ah[si]
 0D6E    **                  mov     es,02h[si]
 0D71    **                  push    es
 0D72    **                  push    bx
 0D73    **                  mov     ax,0040h
 0D76    **                  push    ax
 0D77    **                  call    B$ASSN
 0D7C   00EE           END IF
 0D7C   00EE        END IF
 0D7C    **        I00098:
 0D7C   00EE    
 0D7C   00EE    
 0D7C   00EE        '----- Handle keys from "Multiple Choice" and "Notes" field
                s
 0D7C   00EE        IF Frm.DoingMult THEN
 0D7C   00EE                                                    'Enter or Escap
                e pressed?
 0D7C   00EE           IF Frm.KeyCode = 13 OR Frm.KeyCode = 27 THEN
 0D7C   00EE              Frm.DoingMult = 0                     'All done picki
                ng a choice
 0D7C   00EE                                                    'Erase the menu
 0D7C   00EE              VertMenu Work$(), Choice, VertLen, 0, Ky$, 5, Cnf
 0D7C    **        I00097:   mov     ax,0Ah[bp]
 0D7F    **                  add     ax,0014h
 0D82    **                  mov     si,ax
 0D84    **                  mov     cx,[si]
 0D86    **                  and     cx,cx
 0D88    **                  jne     $+03h
 0D8A    **                  jmp     I00099
 0D8D    **                  mov     ax,0Ah[bp]
 0D90    **                  add     ax,0008h
                                                                      PAGE  40
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0D93    **                  mov     si,ax
 0D95    **                  cmp     word ptr [si],0Dh
 0D98    **                  je      I00101
 0D9A    **                  cmp     word ptr [si],1Bh
 0D9D    **                  je      $+03h
 0D9F    **                  jmp     I00100
 0DA2    **        I00101:   mov     ax,0Ah[bp]
 0DA5    **                  add     ax,0014h
 0DA8    **                  mov     si,ax
 0DAA    **                  mov     [si],0000h
 0DAE    **                  mov     t00EE%,0000h
 0DB4    **                  mov     t00F0%,0005h
 0DBA    **                  push    offset WORK$
 0DBD    **                  push    offset CHOICE%
 0DC0    **                  push    offset VERTLEN%
 0DC3    **                  push    offset t00EE%
 0DC6    **                  push    offset KY$
 0DC9    **                  push    offset t00F0%
 0DCC    **                  push    08h[bp]
 0DCF    **                  call    VERTMENU
 0DD4   00F2    
 0DD4   00F2              IF Frm.KeyCode = 13 THEN              'Enter pressed
 0DD4   00F2                 
 0DD4   00F2                 LSET Form$(Frm.FldNo, 0) = Work$(Choice) 'Copy the
                 choice to edit $
 0DD4   00F2                 EdType = 0
 0DD4   00F2                 Frm.FldEdited = -1                 'Field was edit
                ed
 0DD4   00F2              ELSE
 0DD4    **                  mov     ax,0Ah[bp]
 0DD7    **                  add     ax,0008h
 0DDA    **                  mov     si,ax
 0DDC    **                  cmp     word ptr [si],0Dh
 0DDF    **                  jne     I00102
 0DE1    **                  mov     bx,CHOICE%
 0DE5    **                  sal     bx,1
 0DE7    **                  sal     bx,1
 0DE9    **                  mov     si,offset WORK$
 0DEC    **                  add     bx,0Ah[si]
 0DEF    **                  push    bx
 0DF0    **                  mov     ax,0Ah[bp]
 0DF3    **                  add     ax,0002h
 0DF6    **                  mov     si,ax
 0DF8    **                  mov     bx,[si]
 0DFA    **                  sal     bx,1
 0DFC    **                  sal     bx,1
 0DFE    **                  mov     si,0Eh[bp]
 0E01    **                  add     bx,0Ah[si]
 0E04    **                  push    ds
 0E05    **                  push    bx
 0E06    **                  xor     ax,ax
 0E08    **                  push    ax
 0E09    **                  call    B$LSET
 0E0E    **                  mov     EDTYPE%,0000h
                                                                      PAGE  41
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0E14    **                  mov     ax,0Ah[bp]
 0E17    **                  add     ax,0006h
 0E1A    **                  mov     si,ax
 0E1C    **                  mov     [si],0FFFFh
 0E20    **                  jmp     I00103
 0E23   00F2                 Frm.KeyCode = 0                    'Clear Escape k
                ey
 0E23   00F2              END IF
 0E23    **        I00102:   mov     ax,0Ah[bp]
 0E26    **                  add     ax,0008h
 0E29    **                  mov     si,ax
 0E2B    **                  mov     [si],0000h
 0E2F   00F2              ERASE Work$                           'Clean up tempo
                rary array
 0E2F    **        I00103:   push    offset WORK$
 0E32    **                  call    B$ERAS
 0E37   00F2           END IF
 0E37   00F2    
 0E37   00F2    '    ELSEIF DoingNotes THEN
 0E37   00F2    
 0E37   00F2    '       IF Frm.KeyCode AND LEN(Msg$) THEN        'Clear any hel
                p message
 0E37   00F2    '          Msg$ = ""
 0E37   00F2    '          Message Msg$
 0E37   00F2    '       END IF
 0E37   00F2    
 0E37   00F2    '       SELECT CASE Frm.KeyCode                  'Check for exi
                t keys
 0E37   00F2    '          CASE 9, -15, -117, -119
 0E37   00F2    '             DoingNotes = 0
 0E37   00F2    '             TermKey = -1
 0E37   00F2    '          CASE -80                              'Down arrow. I
                f at end of
 0E37   00F2    '             IF Ed.CurLine = UBOUND(Work$) THEN '  array, goto
                 next field
 0E37   00F2    '                DoingNotes = 0
 0E37   00F2    '                TermKey = -1
 0E37   00F2    '             END IF
 0E37   00F2    '          CASE -72, PgUpKey                     'Up arrow. If 
                at top of array
 0E37   00F2    '             IF Ed.CurLine = 1 THEN             '  goto previo
                us field
 0E37   00F2    '                DoingNotes = 0
 0E37   00F2    '                TermKey = -1
 0E37   00F2    ''                StuffBuf
 0E37   00F2    '             END IF
 0E37   00F2    '          CASE -59                              'Help key
 0E37   00F2    '             IF LEN(Form$(Frm.FldNo, 1)) AND LEN(Msg$) = 0 THE
                N
 0E37   00F2    '                Msg$ = Form$(Frm.FldNo, 1)      'Display help 
                message
 0E37   00F2    '                Message Msg$
 0E37   00F2    '                'Frm.KeyCode = 0
 0E37   00F2    '                'Ky$ = ""
                                                                      PAGE  42
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0E37   00F2    '             END IF
 0E37   00F2    '          CASE ELSE
 0E37   00F2    '       END SELECT
 0E37   00F2    
 0E37   00F2    '       IF DoingNotes THEN
 0E37   00F2    '          SWAP Frm.KeyCode, LagKey
 0E37   00F2    '       END IF
 0E37   00F2    '
 0E37   00F2        END IF
 0E37    **        I00100:
 0E37   00F2    
 0E37   00F2        '----- Handle keys in regular fields
 0E37   00F2        IF Frm.KeyCode <> 0 AND NOT DoingNotes AND NOT Frm.DoingMul
                t THEN
 0E37   00F2    
 0E37   00F2           '----- Branch according to the key pressed
 0E37   00F2           SELECT CASE Frm.KeyCode
 0E37   00F2    
 0E37   00F2              '----- Backspace
 0E37   00F2              CASE 8
 0E37   00F2    
 0E37   00F2                 IF EdType <> MultFld AND EdType <> ButtonFld THEN
 0E37   00F2                    IF Frm.TxtPos > 1 THEN
 0E37   00F2                      Frm.TxtPos = Frm.TxtPos - 1     'Back up the 
                text pointer
 0E37   00F2                    END IF
 0E37    **        I00099:   mov     ax,0Ah[bp]
 0E3A    **                  add     ax,0008h
 0E3D    **                  mov     si,ax
 0E3F    **                  cmp     word ptr [si],00h
 0E42    **                  mov     cx,0000h
 0E45    **                  je      $+01h
 0E47    **                  dec     cx
 0E48    **                  mov     dx,DOINGNOTES%
 0E4C    **                  not     dx
 0E4E    **                  and     cx,dx
 0E50    **                  mov     dx,0Ah[bp]
 0E53    **                  add     dx,14h
 0E56    **                  mov     di,dx
 0E58    **                  mov     bx,[di]
 0E5A    **                  not     bx
 0E5C    **                  and     cx,bx
 0E5E    **                  and     cx,cx
 0E60    **                  jne     $+03h
 0E62    **                  jmp     I00104
 0E65    **                  mov     cx,[si]
 0E67    **                  mov     t00F2%,cx
 0E6B    **                  cmp     word ptr t00F2%,08h
 0E70    **                  je      $+03h
 0E72    **                  jmp     I00105
 0E75    **                  cmp     word ptr EDTYPE%,05h
 0E7A    **                  jne     $+03h
 0E7C    **                  jmp     I00106
 0E7F    **                  cmp     word ptr EDTYPE%,07h
                                                                      PAGE  43
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0E84    **                  jne     $+03h
 0E86    **                  jmp     I00106
 0E89    **                  mov     ax,0Ah[bp]
 0E8C    **                  add     ax,000Ah
 0E8F    **                  mov     si,ax
 0E91    **                  cmp     word ptr [si],01h
 0E94    **                  jng     I00107
 0E96    **                  dec     [si]
 0E98   00F4                    IF Frm.TxtPos > 0 THEN          'Still within t
                he field?
 0E98   00F4                       LOCATE , LeftCol + Frm.TxtPos - 1, 0   'Loca
                te 1 to the left
 0E98   00F4                       IF ASCII(MID$(Mask$, Frm.TxtPos)) <> 29 THEN
 0E98   00F4                          IF Frm.InsStat THEN       'Truncate the s
                tring
 0E98   00F4                             GOSUB DeleteChar
 0E98    **        I00107:   mov     ax,0Ah[bp]
 0E9B    **                  add     ax,000Ah
 0E9E    **                  mov     si,ax
 0EA0    **                  cmp     word ptr [si],00h
 0EA3    **                  jg      $+03h
 0EA5    **                  jmp     I00108
 0EA8    **                  push    00h
 0EAA    **                  push    01h
 0EAC    **                  mov     cx,LEFTCOL%
 0EB0    **                  add     cx,[si]
 0EB2    **                  dec     cx
 0EB3    **                  push    cx
 0EB4    **                  push    01h
 0EB6    **                  push    00h
 0EB8    **                  push    05h
 0EBA    **                  call    B$LOCT
 0EBF    **                  push    offset MASK$
 0EC2    **                  push    [si]
 0EC4    **                  push    7FFFh
 0EC7    **                  call    B$FMID
 0ECC    **                  push    ax
 0ECD    **                  push    offset t00F4$
 0ED0    **                  call    B$SASS
 0ED5    **                  push    offset t00F4$
 0ED8    **                  call    ASCII%
 0EDD    **                  mov     t00F8%,ax
 0EE0    **                  push    offset t00F4$
 0EE3    **                  call    B$STDL
 0EE8    **                  cmp     word ptr t00F8%,1Dh
 0EED    **                  jne     $+03h
 0EEF    **                  jmp     I00109
 0EF2    **                  mov     ax,0Ah[bp]
 0EF5    **                  add     ax,000Ch
 0EF8    **                  mov     si,ax
 0EFA    **                  mov     cx,[si]
 0EFC    **                  and     cx,cx
 0EFE    **                  jne     $+03h
 0F00    **                  jmp     I00110
                                                                      PAGE  44
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0F03    **                  call    I00111
 0F06   00FA                          ELSE                      'Blank the lett
                er
 0F06    **                  jmp     I00112
 0F09   00FA                             MID$(Form$(Frm.FldNo, 0), Frm.TxtPos) 
                = " "
 0F09   00FA                          END IF
 0F09    **        I00110:   mov     ax,0Ah[bp]
 0F0C    **                  add     ax,0002h
 0F0F    **                  mov     si,ax
 0F11    **                  mov     bx,[si]
 0F13    **                  sal     bx,1
 0F15    **                  sal     bx,1
 0F17    **                  mov     si,0Eh[bp]
 0F1A    **                  add     bx,0Ah[si]
 0F1D    **                  push    ds
 0F1E    **                  push    bx
 0F1F    **                  xor     ax,ax
 0F21    **                  push    ax
 0F22    **                  push    offset <const>
 0F25    **                  push    7FFFh
 0F28    **                  mov     ax,0Ah[bp]
 0F2B    **                  add     ax,000Ah
 0F2E    **                  mov     si,ax
 0F30    **                  push    [si]
 0F32    **                  call    B$SMID
 0F37   00FA                                                    'Print the new 
                part of text
 0F37   00FA                          MQPrint MID$(Form$(Frm.FldNo, 0), Frm.Txt
                Pos), -1
 0F37    **        I00112:   mov     ax,0Ah[bp]
 0F3A    **                  add     ax,0002h
 0F3D    **                  mov     si,ax
 0F3F    **                  mov     bx,[si]
 0F41    **                  sal     bx,1
 0F43    **                  sal     bx,1
 0F45    **                  mov     si,0Eh[bp]
 0F48    **                  add     bx,0Ah[si]
 0F4B    **                  push    bx
 0F4C    **                  mov     ax,0Ah[bp]
 0F4F    **                  add     ax,000Ah
 0F52    **                  mov     si,ax
 0F54    **                  push    [si]
 0F56    **                  push    7FFFh
 0F59    **                  call    B$FMID
 0F5E    **                  push    ax
 0F5F    **                  push    offset t00FA$
 0F62    **                  call    B$SASS
 0F67    **                  mov     t00FE%,0FFFFh
 0F6D    **                  push    offset t00FA$
 0F70    **                  push    offset t00FE%
 0F73    **                  call    MQPRINT
 0F78    **                  push    offset t00FA$
 0F7B    **                  call    B$STDL
                                                                      PAGE  45
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0F80   0100                          'MQPrint MID$(Form$(Frm.FldNo, 0), Frm.Tx
                tPos), 112
 0F80   0100                          Frm.FldEdited = -1
 0F80   0100                       END IF
 0F80    **                  mov     ax,0Ah[bp]
 0F83    **                  add     ax,0006h
 0F86    **                  mov     si,ax
 0F88    **                  mov     [si],0FFFFh
 0F8C   0100                    END IF
 0F8C    **        I00109:
 0F8C   0100                 END IF
 0F8C    **        I00108:
 0F8C   0100    
 0F8C   0100              '----- Letter keys
 0F8C   0100              CASE 32 TO 254
 0F8C    **        I00106:   jmp     I00113
 0F8F   0100                 SELECT CASE EdType                 'Filter keys
 0F8F   0100                    CASE 0                          'Normal strings
                 (no setup)
 0F8F   0100    
 0F8F   0100                    CASE Propr                      'Capitalize fir
                st letter of
 0F8F    **        I00105:   cmp     word ptr t00F2%,20h
 0F94    **                  jnl     $+03h
 0F96    **                  jmp     I00114
 0F99    **                  cmp     t00F2%,00FEh
 0F9F    **                  jng     $+03h
 0FA1    **                  jmp     I00114
 0FA4    **                  mov     ax,EDTYPE%
 0FA7    **                  mov     t0100%,ax
 0FAA    **                  cmp     word ptr t0100%,00h
 0FAF    **                  jne     I00115
 0FB1    **                  jmp     I00116
 0FB4   0102                       IF Frm.TxtPos = 1 THEN       '  words in "Pr
                oper Name"
 0FB4   0102                          Ky$ = UCASE$(Ky$)         '  Fields
 0FB4   0102                       ELSEIF MID$(Form$(Frm.FldNo, 0), Frm.TxtPos 
                - 1, 1) = " " THEN
 0FB4    **        I00115:   cmp     word ptr t0100%,06h
 0FB9    **                  je      $+03h
 0FBB    **                  jmp     I00117
 0FBE    **                  mov     ax,0Ah[bp]
 0FC1    **                  add     ax,000Ah
 0FC4    **                  mov     si,ax
 0FC6    **                  cmp     word ptr [si],01h
 0FC9    **                  jne     I00118
 0FCB    **                  push    offset KY$
 0FCE    **                  call    B$UCAS
 0FD3    **                  push    ax
 0FD4    **                  push    offset KY$
 0FD7    **                  call    B$SASS
 0FDC    **                  jmp     I00119
 0FDF   0102                          Ky$ = UCASE$(Ky$)
 0FDF   0102                       END IF
                                                                      PAGE  46
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 0FDF    **        I00118:   mov     ax,0Ah[bp]
 0FE2    **                  add     ax,0002h
 0FE5    **                  mov     si,ax
 0FE7    **                  mov     bx,[si]
 0FE9    **                  sal     bx,1
 0FEB    **                  sal     bx,1
 0FED    **                  mov     si,0Eh[bp]
 0FF0    **                  add     bx,0Ah[si]
 0FF3    **                  push    bx
 0FF4    **                  mov     ax,0Ah[bp]
 0FF7    **                  add     ax,000Ah
 0FFA    **                  mov     si,ax
 0FFC    **                  mov     cx,[si]
 0FFE    **                  dec     cx
 0FFF    **                  push    cx
 1000    **                  push    01h
 1002    **                  call    B$FMID
 1007    **                  push    ax
 1008    **                  push    offset t0102$
 100B    **                  call    B$SASS
 1010    **                  push    offset t0102$
 1013    **                  push    offset <const>
 1016    **                  call    B$SCMP
 101B    **                  je      $+03h
 101D    **                  jmp     I00120
 1020    **                  push    offset KY$
 1023    **                  call    B$UCAS
 1028    **                  push    ax
 1029    **                  push    offset KY$
 102C    **                  call    B$SASS
 1031    **        I00119:
 1031   0106                    CASE UCase
 1031    **        I00120:   jmp     I00116
 1034   0106                       Ky$ = UCASE$(Ky$)            'Make key upper
                 case
 1034   0106    
 1034   0106                    CASE Intgr                      'Skip if not in
                 legal table
 1034    **        I00117:   cmp     word ptr t0100%,01h
 1039    **                  jne     I00121
 103B    **                  push    offset KY$
 103E    **                  call    B$UCAS
 1043    **                  push    ax
 1044    **                  push    offset KY$
 1047    **                  call    B$SASS
 104C    **                  jmp     I00116
 104F   0106                       Temp = INSTR(IntChars$, Ky$)
 104F   0106    
 104F   0106                       SELECT CASE FType
 104F   0106                          CASE NumericStrFld, IntFld, LongIntFld
 104F    **        I00121:   cmp     word ptr t0100%,02h
 1054    **                  je      $+03h
 1056    **                  jmp     I00122
 1059    **                  push    offset <const>
                                                                      PAGE  47
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 105C    **                  push    offset KY$
 105F    **                  call    B$INS2
 1064    **                  mov     TEMP%,ax
 1067    **                  mov     ax,FTYPE%
 106A    **                  mov     t0106%,ax
 106D    **                  cmp     word ptr t0106%,10h
 1072    **                  je      I00123
 1074    **                  cmp     word ptr t0106%,03h
 1079    **                  je      I00123
 107B    **                  cmp     word ptr t0106%,12h
 1080    **                  je      $+03h
 1082    **                  jmp     I00124
 1085   0108                             IF Temp = 0 THEN EXIT SUB
 1085    **        I00123:   cmp     word ptr TEMP%,00h
 108A    **                  jne     $+03h
 108C    **                  jmp     I00037
 108F   0108                          CASE ELSE
 108F    **                  jmp     I00126
 1092   0108                             IF Temp < 3 THEN EXIT SUB
 1092    **        I00124:   cmp     word ptr TEMP%,03h
 1097    **                  jnl     $+03h
 1099    **                  jmp     I00037
 109C   0108                       END SELECT
 109C   0108    
 109C   0108                    CASE FloatP                     'Skip if not in
                 legal table
 109C    **        I00126:   jmp     I00116
 109F   0108                       IF INSTR(FloatChars$, Ky$) = 0 THEN EXIT SUB
 109F    **        I00122:   cmp     word ptr t0100%,03h
 10A4    **                  je      $+03h
 10A6    **                  jmp     I00128
 10A9    **                  push    offset <const>
 10AC    **                  push    offset KY$
 10AF    **                  call    B$INS2
 10B4    **                  or      ax,ax
 10B6    **                  jne     $+03h
 10B8    **                  jmp     I00037
 10BB   0108    
 10BB   0108                    CASE Money                   'Skip if not in le
                gal table
 10BB    **                  jmp     I00116
 10BE   0108                       IF INSTR(MoneyChars$, Ky$) = 0 THEN EXIT SUB
 10BE    **        I00128:   cmp     word ptr t0100%,04h
 10C3    **                  je      $+03h
 10C5    **                  jmp     I00130
 10C8    **                  push    offset <const>
 10CB    **                  push    offset KY$
 10CE    **                  call    B$INS2
 10D3    **                  or      ax,ax
 10D5    **                  jne     $+03h
 10D7    **                  jmp     I00037
 10DA   0108    
 10DA   0108                    CASE LogicalFld
 10DA    **                  jmp     I00116
                                                                      PAGE  48
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 10DD   0108                       Ky$ = UCASE$(Ky$)            'Make it upper 
                case
 10DD   0108                       IF Frm.KeyCode = 32 THEN     'Space bar pres
                sed. Toggle it
 10DD   0108                          IF INSTR(LogicChars$, Form$(Frm.FldNo, 0)
                ) = 2 THEN
 10DD   0108                             Ky$ = MID$(LogicChars$, 1, 1)
 10DD   0108                          ELSE
 10DD    **        I00130:   cmp     word ptr t0100%,0Eh
 10E2    **                  je      $+03h
 10E4    **                  jmp     I00132
 10E7    **                  push    offset KY$
 10EA    **                  call    B$UCAS
 10EF    **                  push    ax
 10F0    **                  push    offset KY$
 10F3    **                  call    B$SASS
 10F8    **                  mov     ax,0Ah[bp]
 10FB    **                  add     ax,0008h
 10FE    **                  mov     si,ax
 1100    **                  cmp     word ptr [si],20h
 1103    **                  je      $+03h
 1105    **                  jmp     I00133
 1108    **                  push    offset LOGICCHARS$
 110B    **                  mov     ax,0Ah[bp]
 110E    **                  add     ax,0002h
 1111    **                  mov     si,ax
 1113    **                  mov     bx,[si]
 1115    **                  sal     bx,1
 1117    **                  sal     bx,1
 1119    **                  mov     si,0Eh[bp]
 111C    **                  add     bx,0Ah[si]
 111F    **                  push    bx
 1120    **                  call    B$INS2
 1125    **                  cmp     ax,0002h
 1128    **                  jne     I00134
 112A    **                  push    offset LOGICCHARS$
 112D    **                  push    01h
 112F    **                  push    01h
 1131    **                  call    B$FMID
 1136    **                  push    ax
 1137    **                  push    offset KY$
 113A    **                  call    B$SASS
 113F    **                  jmp     I00135
 1142   0108                             Ky$ = MID$(LogicChars$, 2, 1)
 1142   0108                          END IF
 1142    **        I00134:   push    offset LOGICCHARS$
 1145    **                  push    02h
 1147    **                  push    01h
 1149    **                  call    B$FMID
 114E    **                  push    ax
 114F    **                  push    offset KY$
 1152    **                  call    B$SASS
 1157   0108                       END IF                       'Skip if not on
                e of the two
                                                                      PAGE  49
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1157    **        I00135:
 1157   0108                       IF INSTR(LogicChars$, Ky$) = 0 THEN EXIT SUB
 1157    **        I00133:   push    offset LOGICCHARS$
 115A    **                  push    offset KY$
 115D    **                  call    B$INS2
 1162    **                  or      ax,ax
 1164    **                  jne     $+03h
 1166    **                  jmp     I00037
 1169   0108                       FirstKey = -1                'Force previous
                 letter to be
 1169   0108                                                    '  cleared
 1169   0108                    CASE MultFld
 1169    **                  mov     FIRSTKEY%,0FFFFh
 116F    **                  jmp     I00116
 1172   0108                       'GOSUB SetupMult
 1172   0108                       FESetupMult Form$(), Fld(), Frm, Cnf
 1172    **        I00132:   cmp     word ptr t0100%,05h
 1177    **                  je      $+03h
 1179    **                  jmp     I00137
 117C    **                  push    0Eh[bp]
 117F    **                  push    0Ch[bp]
 1182    **                  push    0Ah[bp]
 1185    **                  push    08h[bp]
 1188    **                  call    FESETUPMULT
 118D   0108                       StuffBuf Ky$
 118D    **                  push    offset KY$
 1190    **                  call    STUFFBUF
 1195   0108                       EXIT SUB
 1195   0108    
 1195   0108                    CASE ELSE
 1195    **                  jmp     I00037
 1198    **                  jmp     I00116
 119B   0108                       Ky$ = ""
 119B   0108                 END SELECT
 119B    **        I00137:   push    offset <const>
 119E    **                  push    offset KY$
 11A1    **                  call    B$SASS
 11A6   0108    
 11A6   0108                 IF FirstKey THEN                   'Blank if first
                 key and
 11A6   0108                    SELECT CASE FType               '  number field
 11A6   0108                       CASE IntFld, LongIntFld, SngFld, DblFld, Mon
                eyFld', LogicalFld
 11A6    **        I00116:   mov     ax,FIRSTKEY%
 11A9    **                  and     ax,ax
 11AB    **                  jne     $+03h
 11AD    **                  jmp     I00138
 11B0    **                  mov     ax,FTYPE%
 11B3    **                  mov     t0108%,ax
 11B6    **                  cmp     word ptr t0108%,03h
 11BB    **                  je      I00139
 11BD    **                  cmp     word ptr t0108%,12h
 11C2    **                  je      I00139
 11C4    **                  cmp     word ptr t0108%,04h
                                                                      PAGE  50
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 11C9    **                  je      I00139
 11CB    **                  cmp     word ptr t0108%,05h
 11D0    **                  je      I00139
 11D2    **                  cmp     word ptr t0108%,0Ah
 11D7    **                  je      $+03h
 11D9    **                  jmp     I00140
 11DC   010A                          LSET Form$(Frm.FldNo, 0) = ""
 11DC   010A                          Frm.TxtPos = 1
 11DC   010A                       CASE ELSE
 11DC    **        I00139:   push    offset <const>
 11DF    **                  mov     ax,0Ah[bp]
 11E2    **                  add     ax,0002h
 11E5    **                  mov     si,ax
 11E7    **                  mov     bx,[si]
 11E9    **                  sal     bx,1
 11EB    **                  sal     bx,1
 11ED    **                  mov     si,0Eh[bp]
 11F0    **                  add     bx,0Ah[si]
 11F3    **                  push    ds
 11F4    **                  push    bx
 11F5    **                  xor     ax,ax
 11F7    **                  push    ax
 11F8    **                  call    B$LSET
 11FD    **                  mov     ax,0Ah[bp]
 1200    **                  add     ax,000Ah
 1203    **                  mov     si,ax
 1205    **                  mov     [si],0001h
 1209    **                  jmp     I00141
 120C   010A                    END SELECT
 120C    **        I00140:
 120C   010A                 END IF
 120C    **        I00141:
 120C   010A    
 120C   010A    
 120C   010A                 IF EdType <> ButtonFld THEN
 120C   010A                    IF Frm.InsStat THEN             'Expand the tex
                t string
 120C   010A                       Nd = INSTR(Frm.TxtPos, Mask$, "")
 120C   010A                       IF Nd = 0 THEN Nd = LEN(Form$(Frm.FldNo, 0))
                 + 1
 120C    **        I00138:   cmp     word ptr EDTYPE%,07h
 1211    **                  jne     $+03h
 1213    **                  jmp     I00142
 1216    **                  mov     ax,0Ah[bp]
 1219    **                  add     ax,000Ch
 121C    **                  mov     si,ax
 121E    **                  mov     cx,[si]
 1220    **                  and     cx,cx
 1222    **                  jne     $+03h
 1224    **                  jmp     I00143
 1227    **                  mov     ax,0Ah[bp]
 122A    **                  add     ax,000Ah
 122D    **                  mov     si,ax
 122F    **                  push    [si]
                                                                      PAGE  51
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1231    **                  push    offset MASK$
 1234    **                  push    offset <const>
 1237    **                  call    B$INS3
 123C    **                  mov     ND%,ax
 123F    **                  or      ax,ax
 1241    **                  jne     I00144
 1243    **                  mov     ax,0Ah[bp]
 1246    **                  add     ax,0002h
 1249    **                  mov     si,ax
 124B    **                  mov     bx,[si]
 124D    **                  sal     bx,1
 124F    **                  sal     bx,1
 1251    **                  mov     si,0Eh[bp]
 1254    **                  add     bx,0Ah[si]
 1257    **                  mov     si,bx
 1259    **                  mov     ax,[bx]
 125B    **                  inc     ax
 125C    **                  mov     ND%,ax
 125F   010C                       MID$(Form$(Frm.FldNo, 0), Frm.TxtPos) = Ky$ 
                + MID$(Form$(Frm.FldNo, 0), Frm.TxtPos, Nd - Frm.TxtPos - 1)
 125F   010C                    ELSE                            'Put the new le
                tter in string
 125F    **        I00144:   mov     ax,0Ah[bp]
 1262    **                  add     ax,0002h
 1265    **                  mov     si,ax
 1267    **                  mov     bx,[si]
 1269    **                  sal     bx,1
 126B    **                  sal     bx,1
 126D    **                  mov     si,0Eh[bp]
 1270    **                  mov     dx,bx
 1272    **                  add     bx,0Ah[si]
 1275    **                  push    bx
 1276    **                  mov     ax,0Ah[bp]
 1279    **                  add     ax,000Ah
 127C    **                  mov     si,ax
 127E    **                  push    [si]
 1280    **                  mov     cx,ND%
 1284    **                  sub     cx,[si]
 1286    **                  dec     cx
 1287    **                  push    cx
 1288    **                  mov     0E2h[bp],dx
 128B    **                  call    B$FMID
 1290    **                  push    ax
 1291    **                  push    offset t010C$
 1294    **                  call    B$SASS
 1299    **                  mov     dx,si
 129B    **                  mov     si,0Eh[bp]
 129E    **                  mov     bx,0E2h[bp]
 12A1    **                  add     bx,0Ah[si]
 12A4    **                  push    ds
 12A5    **                  push    bx
 12A6    **                  xor     ax,ax
 12A8    **                  push    ax
 12A9    **                  push    offset KY$
                                                                      PAGE  52
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 12AC    **                  push    offset t010C$
 12AF    **                  mov     0E0h[bp],dx
 12B2    **                  call    B$SCAT
 12B7    **                  push    ax
 12B8    **                  push    7FFFh
 12BB    **                  mov     si,0E0h[bp]
 12BE    **                  push    [si]
 12C0    **                  call    B$SMID
 12C5    **                  jmp     I00145
 12C8   0110                       MID$(Form$(Frm.FldNo, 0), Frm.TxtPos) = Ky$
 12C8   0110                    END IF
 12C8    **        I00143:   mov     ax,0Ah[bp]
 12CB    **                  add     ax,0002h
 12CE    **                  mov     si,ax
 12D0    **                  mov     bx,[si]
 12D2    **                  sal     bx,1
 12D4    **                  sal     bx,1
 12D6    **                  mov     si,0Eh[bp]
 12D9    **                  add     bx,0Ah[si]
 12DC    **                  push    ds
 12DD    **                  push    bx
 12DE    **                  xor     ax,ax
 12E0    **                  push    ax
 12E1    **                  push    offset KY$
 12E4    **                  push    7FFFh
 12E7    **                  mov     ax,0Ah[bp]
 12EA    **                  add     ax,000Ah
 12ED    **                  mov     si,ax
 12EF    **                  push    [si]
 12F1    **                  call    B$SMID
 12F6   0110    
 12F6   0110                    LOCATE , LeftCol, 0             'Print the new 
                letter
 12F6   0110                    MQPrint Form$(Frm.FldNo, 0), -1
 12F6    **        I00145:   push    00h
 12F8    **                  push    01h
 12FA    **                  push    LEFTCOL%
 12FE    **                  push    01h
 1300    **                  push    00h
 1302    **                  push    05h
 1304    **                  call    B$LOCT
 1309    **                  mov     ax,0Ah[bp]
 130C    **                  add     ax,0002h
 130F    **                  mov     si,ax
 1311    **                  mov     bx,[si]
 1313    **                  sal     bx,1
 1315    **                  sal     bx,1
 1317    **                  mov     si,0Eh[bp]
 131A    **                  mov     dx,bx
 131C    **                  add     bx,0Ah[si]
 131F    **                  push    bx
 1320    **                  push    offset t0110$
 1323    **                  mov     0DEh[bp],dx
 1326    **                  call    B$SASS
                                                                      PAGE  53
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 132B    **                  mov     t0114%,0FFFFh
 1331    **                  push    offset t0110$
 1334    **                  push    offset t0114%
 1337    **                  call    MQPRINT
 133C    **                  push    offset t0110$
 133F    **                  mov     si,0Eh[bp]
 1342    **                  mov     bx,0DEh[bp]
 1345    **                  add     bx,0Ah[si]
 1348    **                  push    bx
 1349    **                  call    B$SASF
 134E    **                  push    offset t0110$
 1351    **                  call    B$STDL
 1356   0116                    'MQPrint Form$(Frm.FldNo, 0), 112
 1356   0116                    Frm.FldEdited = -1
 1356   0116    
 1356   0116                    IF EdType = LogicalFld THEN     'If this is a L
                ogical field,
 1356   0116                                                    '  check formul
                as for reference
 1356   0116                       CalcFields Frm.StartEl, Frm.FldNo, Form$(), 
                Fld()
 1356    **                  mov     ax,0Ah[bp]
 1359    **                  add     ax,0006h
 135C    **                  mov     si,ax
 135E    **                  mov     [si],0FFFFh
 1362    **                  cmp     word ptr EDTYPE%,0Eh
 1367    **                  je      $+03h
 1369    **                  jmp     I00146
 136C    **                  push    0Ah[bp]
 136F    **                  mov     ax,0Ah[bp]
 1372    **                  add     ax,0002h
 1375    **                  push    ax
 1376    **                  push    0Eh[bp]
 1379    **                  push    0Ch[bp]
 137C    **                  call    CALCFIELDS
 1381   0116                       IF Frm.KeyCode = 32 THEN Frm.TxtPos = Frm.Tx
                tPos - 1
 1381    **                  mov     ax,0Ah[bp]
 1384    **                  add     ax,0008h
 1387    **                  mov     si,ax
 1389    **                  cmp     word ptr [si],20h
 138C    **                  jne     I00147
 138E    **                  mov     ax,0Ah[bp]
 1391    **                  add     ax,000Ah
 1394    **                  mov     si,ax
 1396    **                  dec     [si]
 1398   0116                    END IF
 1398    **        I00147:
 1398   0116    
 1398   0116                    IF FType <> MultChAFld THEN
 1398   0116                       IF NOT StayOnField OR Frm.TxtPos < LEN(Form$
                (Frm.FldNo, 0)) THEN
 1398   0116                          Frm.TxtPos = Frm.TxtPos + 1 'Advance the 
                cursor
                                                                      PAGE  54
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1398   0116                       END IF
 1398    **        I00146:   cmp     word ptr FTYPE%,16h
 139D    **                  jne     $+03h
 139F    **                  jmp     I00148
 13A2    **                  mov     ax,0Ah[bp]
 13A5    **                  add     ax,0002h
 13A8    **                  mov     si,ax
 13AA    **                  mov     bx,[si]
 13AC    **                  sal     bx,1
 13AE    **                  sal     bx,1
 13B0    **                  mov     si,0Eh[bp]
 13B3    **                  add     bx,0Ah[si]
 13B6    **                  mov     si,bx
 13B8    **                  mov     ax,[bx]
 13BA    **                  mov     cx,0Ah[bp]
 13BD    **                  add     cx,0Ah
 13C0    **                  mov     si,cx
 13C2    **                  cmp     ax,[si]
 13C4    **                  mov     dx,0000h
 13C7    **                  jng     $+01h
 13C9    **                  dec     dx
 13CA    **                  or      dx,0FFh
 13CD    **                  and     dx,dx
 13CF    **                  je      I00149
 13D1    **                  inc     [si]
 13D3   0116                    END IF
 13D3    **        I00149:
 13D3   0116                 END IF
 13D3    **        I00148:
 13D3   0116    
 13D3   0116              CASE -68  'catch f10 key
 13D3    **        I00142:   jmp     I00113
 13D6   0116                'beep
 13D6   0116                Frm.FldEdited = -1
 13D6   0116                TermKey = -1
 13D6   0116                Frm.FldNo = Frm.FldNo + 1
 13D6   0116    
 13D6   0116              '----- Left arrow
 13D6   0116              CASE -75
 13D6    **        I00114:   cmp     word ptr t00F2%,0BCh
 13DB    **                  jne     I00150
 13DD    **                  mov     ax,0Ah[bp]
 13E0    **                  add     ax,0006h
 13E3    **                  mov     si,ax
 13E5    **                  mov     [si],0FFFFh
 13E9    **                  mov     TERMKEY%,0FFFFh
 13EF    **                  mov     ax,0Ah[bp]
 13F2    **                  add     ax,0002h
 13F5    **                  mov     si,ax
 13F7    **                  inc     [si]
 13F9    **                  jmp     I00113
 13FC   0116    
 13FC   0116                 Frm.TxtPos = Frm.TxtPos - 1        'Decrement the 
                text pointer
                                                                      PAGE  55
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 13FC   0116    
 13FC   0116              '----- Right arrow
 13FC   0116              CASE -77
 13FC    **        I00150:   cmp     word ptr t00F2%,0B5h
 1401    **                  jne     I00151
 1403    **                  mov     ax,0Ah[bp]
 1406    **                  add     ax,000Ah
 1409    **                  mov     si,ax
 140B    **                  dec     [si]
 140D    **                  jmp     I00113
 1410   0116                 IF Fld(Frm.FldNo).FType = Button THEN
 1410   0116                    Frm.FldNo = Frm.FldNo + 1       'Bump field num
                ber
 1410   0116                 ELSE
 1410    **        I00151:   cmp     word ptr t00F2%,0B3h
 1415    **                  je      $+03h
 1417    **                  jmp     I00152
 141A    **                  mov     ax,0Ah[bp]
 141D    **                  add     ax,0002h
 1420    **                  mov     si,ax
 1422    **                  mov     bx,[si]
 1424    **                  mov     dx,bx
 1426    **                  sal     bx,1
 1428    **                  sal     bx,1
 142A    **                  sal     bx,1
 142C    **                  sal     bx,1
 142E    **                  sal     bx,1
 1430    **                  sal     bx,1
 1432    **                  mov     si,0Ch[bp]
 1435    **                  add     bx,0Ah[si]
 1438    **                  mov     es,02h[si]
 143B    **                  add     bx,0Ah
 143E    **                  es:     
 143F    **                  cmp     word ptr [bx],18h
 1442    **                  jne     I00153
 1444    **                  mov     si,ax
 1446    **                  inc     [si]
 1448    **                  jmp     I00154
 144B   0116                    Frm.TxtPos = Frm.TxtPos + 1     'Increment the 
                text pointer
 144B   0116                 END IF
 144B    **        I00153:   mov     ax,0Ah[bp]
 144E    **                  add     ax,000Ah
 1451    **                  mov     si,ax
 1453    **                  inc     [si]
 1455   0116    
 1455   0116    
 1455   0116              '----- Home
 1455   0116              CASE -71
 1455    **        I00154:   jmp     I00113
 1458   0116                 Frm.TxtPos = 1                     'Move text poin
                ter to 1
 1458   0116    
 1458   0116              '----- End
                                                                      PAGE  56
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1458   0116              CASE -79                              'Look backwards
                 for non-blank
 1458    **        I00152:   cmp     word ptr t00F2%,0B9h
 145D    **                  jne     I00155
 145F    **                  mov     ax,0Ah[bp]
 1462    **                  add     ax,000Ah
 1465    **                  mov     si,ax
 1467    **                  mov     [si],0001h
 146B    **                  jmp     I00113
 146E   0116                 FOR N = LEN(Form$(Frm.FldNo, 0)) TO 1 STEP -1
 146E    **        I00155:   cmp     word ptr t00F2%,0B1h
 1473    **                  je      $+03h
 1475    **                  jmp     I00156
 1478    **                  mov     ax,0Ah[bp]
 147B    **                  add     ax,0002h
 147E    **                  mov     si,ax
 1480    **                  mov     bx,[si]
 1482    **                  sal     bx,1
 1484    **                  sal     bx,1
 1486    **                  mov     si,0Eh[bp]
 1489    **                  add     bx,0Ah[si]
 148C    **                  mov     si,bx
 148E    **                  mov     ax,[bx]
 1490    **                  jmp     I00157
 1493    **                  nop     
 1494   0116                    IF ASCII(MID$(Form$(Frm.FldNo, 0), N, 1)) <> 32
                 THEN EXIT FOR
 1494    **        I00158:   mov     cx,0Ah[bp]
 1497    **                  add     cx,02h
 149A    **                  mov     si,cx
 149C    **                  mov     bx,[si]
 149E    **                  sal     bx,1
 14A0    **                  sal     bx,1
 14A2    **                  mov     si,0Eh[bp]
 14A5    **                  add     bx,0Ah[si]
 14A8    **                  push    bx
 14A9    **                  push    ax
 14AA    **                  push    01h
 14AC    **                  call    B$FMID
 14B1    **                  push    ax
 14B2    **                  push    offset t0116$
 14B5    **                  call    B$SASS
 14BA    **                  push    offset t0116$
 14BD    **                  call    ASCII%
 14C2    **                  mov     t011A%,ax
 14C5    **                  push    offset t0116$
 14C8    **                  call    B$STDL
 14CD    **                  cmp     word ptr t011A%,20h
 14D2    **                  je      $+03h
 14D4    **                  jmp     I00160
 14D7   011C                 NEXT
 14D7    **                  mov     ax,N%
 14DA    **                  dec     ax
 14DB    **        I00157:   mov     N%,ax
                                                                      PAGE  57
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 14DE    **                  cmp     ax,0001h
 14E1    **                  jnl     I00158
 14E3   011C                 Frm.TxtPos = MinInt(N + 1, LEN(Form$(Frm.FldNo, 0)
                ))
 14E3   011C    
 14E3   011C              '----- Insert key
 14E3   011C              CASE -82
 14E3    **        I00160:   mov     ax,N%
 14E6    **                  inc     ax
 14E7    **                  mov     t011C%,ax
 14EA    **                  mov     ax,0Ah[bp]
 14ED    **                  add     ax,0002h
 14F0    **                  mov     si,ax
 14F2    **                  mov     bx,[si]
 14F4    **                  sal     bx,1
 14F6    **                  sal     bx,1
 14F8    **                  mov     si,0Eh[bp]
 14FB    **                  add     bx,0Ah[si]
 14FE    **                  push    bx
 14FF    **                  call    B$FLEN
 1504    **                  mov     t011E%,ax
 1507    **                  push    offset t011C%
 150A    **                  push    offset t011E%
 150D    **                  call    MININT%
 1512    **                  mov     t0120%,ax
 1515    **                  mov     ax,0Ah[bp]
 1518    **                  add     ax,000Ah
 151B    **                  mov     si,ax
 151D    **                  mov     cx,t0120%
 1521    **                  mov     [si],cx
 1523    **                  jmp     I00113
 1526   0122                 Frm.InsStat = NOT Frm.InsStat      'Toggle the Ins
                ert state
 1526   0122                 GOSUB SetCursor
 1526    **        I00156:   cmp     word ptr t00F2%,0AEh
 152B    **                  je      $+03h
 152D    **                  jmp     I00161
 1530    **                  mov     ax,0Ah[bp]
 1533    **                  add     ax,000Ch
 1536    **                  mov     si,ax
 1538    **                  mov     cx,[si]
 153A    **                  not     cx
 153C    **                  mov     [si],cx
 153E    **                  call    I00042
 1541   0122    
 1541   0122              '----- Delete
 1541   0122              CASE -83                              'Truncate the t
                ext
 1541    **                  jmp     I00113
 1544   0122                 IF EdType <> MultFld AND EdType <> ButtonFld THEN
 1544   0122                    GOSUB DeleteChar                'Print the trun
                cated part
 1544    **        I00161:   cmp     word ptr t00F2%,0ADh
 1549    **                  je      $+03h
                                                                      PAGE  58
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 154B    **                  jmp     I00162
 154E    **                  cmp     word ptr EDTYPE%,05h
 1553    **                  jne     $+03h
 1555    **                  jmp     I00163
 1558    **                  cmp     word ptr EDTYPE%,07h
 155D    **                  jne     $+03h
 155F    **                  jmp     I00163
 1562    **                  call    I00111
 1565   0122                    MQPrint MID$(Form$(Frm.FldNo, 0), Frm.TxtPos), 
                -1
 1565    **                  mov     ax,0Ah[bp]
 1568    **                  add     ax,0002h
 156B    **                  mov     si,ax
 156D    **                  mov     bx,[si]
 156F    **                  sal     bx,1
 1571    **                  sal     bx,1
 1573    **                  mov     si,0Eh[bp]
 1576    **                  add     bx,0Ah[si]
 1579    **                  push    bx
 157A    **                  mov     ax,0Ah[bp]
 157D    **                  add     ax,000Ah
 1580    **                  mov     si,ax
 1582    **                  push    [si]
 1584    **                  push    7FFFh
 1587    **                  call    B$FMID
 158C    **                  push    ax
 158D    **                  push    offset t0122$
 1590    **                  call    B$SASS
 1595    **                  mov     t0126%,0FFFFh
 159B    **                  push    offset t0122$
 159E    **                  push    offset t0126%
 15A1    **                  call    MQPRINT
 15A6    **                  push    offset t0122$
 15A9    **                  call    B$STDL
 15AE   0128                    'MQPrint MID$(Form$(Frm.FldNo, 0), Frm.TxtPos),
                 112
 15AE   0128                    Frm.FldEdited = -1
 15AE   0128                 ELSEIF EdType = MultFld THEN
 15AE    **                  mov     ax,0Ah[bp]
 15B1    **                  add     ax,0006h
 15B4    **                  mov     si,ax
 15B6    **                  mov     [si],0FFFFh
 15BA    **                  jmp     I00164
 15BD   0128                    LSET Form$(Frm.FldNo, 0) = ""
 15BD   0128                    TermKey = -1
 15BD   0128                    Frm.FldEdited = -1
 15BD   0128                    Frm.TxtPos = 1
 15BD   0128                 END IF
 15BD    **        I00163:   cmp     word ptr EDTYPE%,05h
 15C2    **                  je      $+03h
 15C4    **                  jmp     I00165
 15C7    **                  push    offset <const>
 15CA    **                  mov     ax,0Ah[bp]
 15CD    **                  add     ax,0002h
                                                                      PAGE  59
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 15D0    **                  mov     si,ax
 15D2    **                  mov     bx,[si]
 15D4    **                  sal     bx,1
 15D6    **                  sal     bx,1
 15D8    **                  mov     si,0Eh[bp]
 15DB    **                  add     bx,0Ah[si]
 15DE    **                  push    ds
 15DF    **                  push    bx
 15E0    **                  xor     ax,ax
 15E2    **                  push    ax
 15E3    **                  call    B$LSET
 15E8    **                  mov     TERMKEY%,0FFFFh
 15EE    **                  mov     ax,0Ah[bp]
 15F1    **                  add     ax,0006h
 15F4    **                  mov     si,ax
 15F6    **                  mov     [si],0FFFFh
 15FA    **                  mov     ax,0Ah[bp]
 15FD    **                  add     ax,000Ah
 1600    **                  mov     si,ax
 1602    **                  mov     [si],0001h
 1606    **        I00164:
 1606   0128    
 1606   0128    '**** 10-06-94  Modifed up & down arror to move sequentialy
 1606   0128              '----- Up Arrow Procedure
 1606   0128              CASE -72, -141
 1606    **        I00165:   jmp     I00113
 1609    **        I00162:   cmp     word ptr t00F2%,0B8h
 160E    **                  je      I00166
 1610    **                  cmp     t00F2%,0FF73h
 1616    **                  je      $+03h
 1618    **                  jmp     I00167
 161B   0128                 IF Frm.KeyCode = -141 THEN
 161B   0128                   FEUpArrow Fld(), Frm
 161B    **        I00166:   mov     ax,0Ah[bp]
 161E    **                  add     ax,0008h
 1621    **                  mov     si,ax
 1623    **                  cmp     [si],0FF73h
 1627    **                  je      $+03h
 1629    **                  jmp     I00168
 162C    **                  push    0Ch[bp]
 162F    **                  push    0Ah[bp]
 1632    **                  call    FEUPARROW
 1637   0128                 ELSE
 1637    **                  jmp     I00169
 163A   0128                   Frm.FldNo = Frm.FldNo - 1          'Decrement fi
                eld number
 163A   0128                 END IF
 163A    **        I00168:   mov     ax,0Ah[bp]
 163D    **                  add     ax,0002h
 1640    **                  mov     si,ax
 1642    **                  dec     [si]
 1644   0128              '----- Down Arrow Proceedure
 1644   0128              CASE -80, -145                        'IF NOT Frm.Seq
                uential THEN
                                                                      PAGE  60
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1644    **        I00169:   jmp     I00113
 1647    **        I00167:   cmp     word ptr t00F2%,0B0h
 164C    **                  je      I00170
 164E    **                  cmp     t00F2%,0FF6Fh
 1654    **                  je      $+03h
 1656    **                  jmp     I00171
 1659   0128                 IF Frm.KeyCode = -145 THEN
 1659   0128                   FEDownArrow Fld(), Frm
 1659    **        I00170:   mov     ax,0Ah[bp]
 165C    **                  add     ax,0008h
 165F    **                  mov     si,ax
 1661    **                  cmp     [si],0FF6Fh
 1665    **                  je      $+03h
 1667    **                  jmp     I00172
 166A    **                  push    0Ch[bp]
 166D    **                  push    0Ah[bp]
 1670    **                  call    FEDOWNARROW
 1675   0128                 ELSE
 1675    **                  jmp     I00173
 1678   0128                   Frm.FldNo = Frm.FldNo + 1          'Bump field n
                umber
 1678   0128                 END IF
 1678    **        I00172:   mov     ax,0Ah[bp]
 167B    **                  add     ax,0002h
 167E    **                  mov     si,ax
 1680    **                  inc     [si]
 1682   0128              '----- Enter or Tab
 1682   0128              CASE 13
 1682    **        I00173:   jmp     I00113
 1685   0128                 SELECT CASE EdType
 1685   0128                    CASE MultFld                    'If on a Multip
                le choice field
 1685   0128                       'GOSUB SetupMult
 1685   0128                       FESetupMult Form$(), Fld(), Frm, Cnf
 1685    **        I00171:   cmp     word ptr t00F2%,0Dh
 168A    **                  je      $+03h
 168C    **                  jmp     I00174
 168F    **                  mov     ax,EDTYPE%
 1692    **                  mov     t0128%,ax
 1695    **                  cmp     word ptr t0128%,05h
 169A    **                  je      $+03h
 169C    **                  jmp     I00175
 169F    **                  push    0Eh[bp]
 16A2    **                  push    0Ch[bp]
 16A5    **                  push    0Ah[bp]
 16A8    **                  push    08h[bp]
 16AB    **                  call    FESETUPMULT
 16B0   012A                       Frm.KeyCode = 0
 16B0   012A                    CASE ELSE                       'Regular fields
 16B0    **                  mov     ax,0Ah[bp]
 16B3    **                  add     ax,0008h
 16B6    **                  mov     si,ax
 16B8    **                  mov     [si],0000h
 16BC    **                  jmp     I00176
                                                                      PAGE  61
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 16BF   012A                       Frm.FldNo = Frm.FldNo + 1    'Bump field num
                ber
 16BF   012A                 END SELECT
 16BF    **        I00175:   mov     ax,0Ah[bp]
 16C2    **                  add     ax,0002h
 16C5    **                  mov     si,ax
 16C7    **                  inc     [si]
 16C9   012A    
 16C9   012A              '----- Tab
 16C9   012A              CASE 9
 16C9    **        I00176:   jmp     I00113
 16CC   012A                 Frm.FldNo = Frm.FldNo + 1          'Bump field num
                ber
 16CC   012A    
 16CC   012A              '----- Shift Tab pressed
 16CC   012A              CASE -15
 16CC    **        I00174:   cmp     word ptr t00F2%,09h
 16D1    **                  jne     I00177
 16D3    **                  mov     ax,0Ah[bp]
 16D6    **                  add     ax,0002h
 16D9    **                  mov     si,ax
 16DB    **                  inc     [si]
 16DD    **                  jmp     I00113
 16E0   012A                 Frm.FldNo = Frm.FldNo - 1          'Decrement fiel
                d number
 16E0   012A    
 16E0   012A              '----- Ctrl Home
 16E0   012A              CASE -119
 16E0    **        I00177:   cmp     word ptr t00F2%,0F1h
 16E5    **                  jne     I00178
 16E7    **                  mov     ax,0Ah[bp]
 16EA    **                  add     ax,0002h
 16ED    **                  mov     si,ax
 16EF    **                  dec     [si]
 16F1    **                  jmp     I00113
 16F4   012A                 Frm.FldNo = Frm.StartEl + 1        'Set to first f
                ield
 16F4   012A    
 16F4   012A              '----- Ctrl End
 16F4   012A              CASE -117
 16F4    **        I00178:   cmp     word ptr t00F2%,89h
 16F9    **                  jne     I00179
 16FB    **                  mov     si,0Ah[bp]
 16FE    **                  mov     ax,[si]
 1700    **                  inc     ax
 1701    **                  add     si,02h
 1704    **                  mov     [si],ax
 1706    **                  jmp     I00113
 1709   012A                 Frm.FldNo = EndOfForm              'Set to last fi
                eld
 1709   012A    
 1709   012A              '----- Page up
 1709   012A              CASE -73
 1709    **        I00179:   cmp     word ptr t00F2%,8Bh
                                                                      PAGE  62
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 170E    **                  jne     I00180
 1710    **                  mov     ax,0Ah[bp]
 1713    **                  add     ax,0002h
 1716    **                  mov     si,ax
 1718    **                  mov     cx,ENDOFFORM%
 171C    **                  mov     [si],cx
 171E    **                  jmp     I00113
 1721   012A                IF NOT Frm.PageDisable THEN
 1721   012A                  Frm.FldNo = Frm.StartEl
 1721   012A                END IF
 1721    **        I00180:   cmp     word ptr t00F2%,0B7h
 1726    **                  je      $+03h
 1728    **                  jmp     I00181
 172B    **                  mov     ax,0Ah[bp]
 172E    **                  add     ax,0018h
 1731    **                  mov     si,ax
 1733    **                  mov     cx,[si]
 1735    **                  not     cx
 1737    **                  and     cx,cx
 1739    **                  je      I00182
 173B    **                  mov     si,0Ah[bp]
 173E    **                  mov     ax,[si]
 1740    **                  add     si,02h
 1743    **                  mov     [si],ax
 1745   012A    
 1745   012A              '----- Page down
 1745   012A              CASE -81
 1745    **        I00182:   jmp     I00113
 1748   012A                IF NOT Frm.PageDisable THEN
 1748   012A                  Frm.FldNo = EndOfForm + 1
 1748   012A                END IF
 1748    **        I00181:   cmp     word ptr t00F2%,0AFh
 174D    **                  je      $+03h
 174F    **                  jmp     I00183
 1752    **                  mov     ax,0Ah[bp]
 1755    **                  add     ax,0018h
 1758    **                  mov     si,ax
 175A    **                  mov     cx,[si]
 175C    **                  not     cx
 175E    **                  and     cx,cx
 1760    **                  je      I00184
 1762    **                  mov     ax,ENDOFFORM%
 1765    **                  inc     ax
 1766    **                  mov     cx,0Ah[bp]
 1769    **                  add     cx,02h
 176C    **                  mov     si,cx
 176E    **                  mov     [si],ax
 1770   012A    
 1770   012A              '----- F1 - Help
 1770   012A              CASE -59
 1770    **        I00184:   jmp     I00113
 1773   012A                 IF LEN(Msg$) = 0 THEN
 1773   012A                    IF LEN(Form$(Frm.FldNo, 1)) THEN    'If this fi
                eld has a help $,
                                                                      PAGE  63
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1773   012A                       Msg$ = Form$(Frm.FldNo, 1)       '  use it.
 1773   012A                    ELSE
 1773    **        I00183:   cmp     word ptr t00F2%,0C5h
 1778    **                  je      $+03h
 177A    **                  jmp     I00185
 177D    **                  cmp     word ptr MSG$,00h
 1782    **                  je      $+03h
 1784    **                  jmp     I00186
 1787    **                  mov     ax,0Eh[bp]
 178A    **                  add     ax,0012h
 178D    **                  mov     si,ax
 178F    **                  mov     bx,[si]
 1791    **                  mov     cx,0Ah[bp]
 1794    **                  add     cx,02h
 1797    **                  mov     si,cx
 1799    **                  add     bx,[si]
 179B    **                  sal     bx,1
 179D    **                  sal     bx,1
 179F    **                  mov     si,0Eh[bp]
 17A2    **                  add     bx,0Ah[si]
 17A5    **                  mov     si,bx
 17A7    **                  mov     ax,[bx]
 17A9    **                  and     ax,ax
 17AB    **                  je      I00187
 17AD    **                  mov     ax,0Eh[bp]
 17B0    **                  add     ax,0012h
 17B3    **                  mov     si,ax
 17B5    **                  mov     bx,[si]
 17B7    **                  mov     di,cx
 17B9    **                  add     bx,[di]
 17BB    **                  sal     bx,1
 17BD    **                  sal     bx,1
 17BF    **                  mov     si,0Eh[bp]
 17C2    **                  add     bx,0Ah[si]
 17C5    **                  push    bx
 17C6    **                  push    offset MSG$
 17C9    **                  call    B$SASS
 17CE    **                  jmp     I00188
 17D1   012E                       Msg$ = "No help for this field."
 17D1   012E                    END IF
 17D1    **        I00187:   push    offset <const>
 17D4    **                  push    offset MSG$
 17D7    **                  call    B$SASS
 17DC   012E                    Message Msg$                    'Display the me
                ssage
 17DC    **        I00188:   push    offset MSG$
 17DF    **                  call    MESSAGE
 17E4   012E                 END IF
 17E4   012E    
 17E4   012E              CASE ELSE                             'Unknown key?
 17E4    **        I00186:   jmp     I00113
 17E7   012E                 TermKey = -1                       'Set flag
 17E7   012E           END SELECT
 17E7    **        I00185:   mov     TERMKEY%,0FFFFh
                                                                      PAGE  64
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 17ED   012E    
 17ED   012E           FirstKey = 0                             'No longer the 
                first key for
 17ED   012E                                                    '  field
 17ED   012E        END IF
 17ED    **        I00113:   mov     FIRSTKEY%,0000h
 17F3   012E    
 17F3   012E        '----- See if the cursor has moved
 17F3   012E        Movement = Frm.TxtPos - PosWas
 17F3   012E        IF Movement THEN
 17F3   012E           IF Frm.PrevFld = Frm.FldNo THEN
 17F3   012E    
 17F3   012E              '----- Adjust position
 17F3   012E              DO
 17F3    **        I00104:   mov     ax,0Ah[bp]
 17F6    **                  add     ax,000Ah
 17F9    **                  mov     si,ax
 17FB    **                  mov     cx,[si]
 17FD    **                  sub     cx,POSWAS%
 1801    **                  mov     MOVEMENT%,cx
 1805    **                  and     cx,cx
 1807    **                  jne     $+03h
 1809    **                  jmp     I00189
 180C    **                  mov     ax,0Ah[bp]
 180F    **                  add     ax,0004h
 1812    **                  mov     si,ax
 1814    **                  mov     cx,[si]
 1816    **                  mov     dx,0Ah[bp]
 1819    **                  add     dx,02h
 181C    **                  mov     si,dx
 181E    **                  cmp     cx,[si]
 1820    **                  je      $+03h
 1822    **                  jmp     I00190
 1825    **                  nop     
 1826   0130                 '----- Did we get past the end of the Edit$?
 1826   0130                 IF Frm.TxtPos > LEN(Form$(Frm.FldNo, 0)) THEN
 1826   0130                     SELECT CASE Frm.KeyCode
 1826   0130                       CASE -77         'RightArrow
 1826   0130                         IF FrmFldNo < EndOfForms(Fld()) THEN
 1826   0130                           Frm.FldNo = Frm.FldNo + 1       'Bump th
                e field number
 1826   0130                           Frm.TxtPos = Frm.TxtPos - 1
 1826   0130                         END IF
 1826    **        I00191:   mov     ax,0Ah[bp]
 1829    **                  add     ax,0002h
 182C    **                  mov     si,ax
 182E    **                  mov     bx,[si]
 1830    **                  sal     bx,1
 1832    **                  sal     bx,1
 1834    **                  mov     si,0Eh[bp]
 1837    **                  add     bx,0Ah[si]
 183A    **                  mov     si,bx
 183C    **                  mov     ax,[bx]
 183E    **                  mov     cx,0Ah[bp]
                                                                      PAGE  65
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1841    **                  add     cx,0Ah
 1844    **                  mov     si,cx
 1846    **                  cmp     ax,[si]
 1848    **                  jl      $+03h
 184A    **                  jmp     I00192
 184D    **                  mov     ax,0Ah[bp]
 1850    **                  add     ax,0008h
 1853    **                  mov     si,ax
 1855    **                  mov     cx,[si]
 1857    **                  mov     t0130%,cx
 185B    **                  cmp     word ptr t0130%,0B3h
 1860    **                  je      $+03h
 1862    **                  jmp     I00193
 1865    **                  push    0Ch[bp]
 1868    **                  call    ENDOFFORMS%
 186D    **                  mov     t0132%,ax
 1870    **                  mov     ax,t0132%
 1873    **                  cmp     ax,FRMFLDNO%
 1877    **                  jng     I00194
 1879    **                  mov     ax,0Ah[bp]
 187C    **                  add     ax,0002h
 187F    **                  mov     si,ax
 1881    **                  inc     [si]
 1883    **                  mov     cx,0Ah[bp]
 1886    **                  add     cx,0Ah
 1889    **                  mov     di,cx
 188B    **                  dec     [di]
 188D   0136                       CASE ELSE
 188D    **        I00194:   jmp     I00195
 1890   0136                         Frm.TxtPos = LEN(Form$(Frm.FldNo, 0))
 1890   0136                     END SELECT
 1890    **        I00193:   mov     ax,0Ah[bp]
 1893    **                  add     ax,0002h
 1896    **                  mov     si,ax
 1898    **                  mov     bx,[si]
 189A    **                  sal     bx,1
 189C    **                  sal     bx,1
 189E    **                  mov     si,0Eh[bp]
 18A1    **                  add     bx,0Ah[si]
 18A4    **                  mov     si,bx
 18A6    **                  mov     ax,[bx]
 18A8    **                  mov     cx,0Ah[bp]
 18AB    **                  add     cx,0Ah
 18AE    **                  mov     si,cx
 18B0    **                  mov     [si],ax
 18B2   0136    
 18B2   0136                     EXIT DO
 18B2   0136    
 18B2   0136                 '----- Did we get past the beginning of the Edit$?
 18B2   0136                 ELSEIF Frm.TxtPos < 1 THEN
 18B2    **        I00195:   jmp     I00196
 18B5    **                  jmp     I00197
 18B8   0136    
 18B8   0136                   SELECT CASE Frm.KeyCode
                                                                      PAGE  66
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 18B8   0136                     CASE -75        'leftarrow
 18B8   0136                       IF Frm.FldNo > 1 THEN
 18B8   0136                         Frm.FldNo = Frm.FldNo - 1       'Bump the 
                field number
 18B8   0136                         'Frm.TxtPos = Frm.TxtPos - 1
 18B8   0136                         Frm.TxtPos = 1
 18B8   0136                       ELSE
 18B8    **        I00192:   mov     ax,0Ah[bp]
 18BB    **                  add     ax,000Ah
 18BE    **                  mov     si,ax
 18C0    **                  cmp     word ptr [si],01h
 18C3    **                  jl      $+03h
 18C5    **                  jmp     I00198
 18C8    **                  mov     cx,0Ah[bp]
 18CB    **                  add     cx,08h
 18CE    **                  mov     di,cx
 18D0    **                  mov     dx,[di]
 18D2    **                  mov     t0136%,dx
 18D6    **                  cmp     word ptr t0136%,0B5h
 18DB    **                  je      $+03h
 18DD    **                  jmp     I00199
 18E0    **                  mov     cx,0Ah[bp]
 18E3    **                  add     cx,02h
 18E6    **                  mov     di,cx
 18E8    **                  cmp     word ptr [di],01h
 18EB    **                  jng     I00200
 18ED    **                  dec     [di]
 18EF    **                  mov     [si],0001h
 18F3    **                  jmp     I00201
 18F6   0138                         Frm.TxtPos = 1
 18F6   0138                       END IF
 18F6    **        I00200:   mov     ax,0Ah[bp]
 18F9    **                  add     ax,000Ah
 18FC    **                  mov     si,ax
 18FE    **                  mov     [si],0001h
 1902   0138                    END SELECT
 1902    **        I00201:   jmp     I00202
 1905    **        I00199:
 1905   0138                    EXIT DO
 1905   0138                 END IF
 1905    **        I00202:   jmp     I00196
 1908    **        I00197:
 1908   0138                 '----- Skip over delimiters
 1908   0138                 IF ASCII(MID$(Mask$, Frm.TxtPos)) <> 29 THEN EXIT 
                DO
 1908    **        I00198:   push    offset MASK$
 190B    **                  mov     ax,0Ah[bp]
 190E    **                  add     ax,000Ah
 1911    **                  mov     si,ax
 1913    **                  push    [si]
 1915    **                  push    7FFFh
 1918    **                  call    B$FMID
 191D    **                  push    ax
 191E    **                  push    offset t0138$
                                                                      PAGE  67
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1921    **                  call    B$SASS
 1926    **                  push    offset t0138$
 1929    **                  call    ASCII%
 192E    **                  mov     t013C%,ax
 1931    **                  push    offset t0138$
 1934    **                  call    B$STDL
 1939    **                  cmp     word ptr t013C%,1Dh
 193E    **                  je      $+03h
 1940    **                  jmp     I00196
 1943   013E                 Frm.TxtPos = Frm.TxtPos + Movement
 1943   013E                 IF FType = DateFld OR FType = EuroDateFld THEN
 1943   013E                    IF Frm.TxtPos = 7 THEN Frm.TxtPos = 9
 1943    **                  mov     ax,0Ah[bp]
 1946    **                  add     ax,000Ah
 1949    **                  mov     si,ax
 194B    **                  mov     cx,MOVEMENT%
 194F    **                  add     [si],cx
 1951    **                  cmp     word ptr FTYPE%,06h
 1956    **                  je      I00206
 1958    **                  cmp     word ptr FTYPE%,13h
 195D    **                  je      $+03h
 195F    **                  jmp     I00204
 1962    **        I00206:   mov     ax,0Ah[bp]
 1965    **                  add     ax,000Ah
 1968    **                  mov     si,ax
 196A    **                  cmp     word ptr [si],07h
 196D    **                  jne     I00205
 196F    **                  mov     [si],0009h
 1973   013E                 END IF
 1973    **        I00205:
 1973   013E              LOOP
 1973    **        I00204:   jmp     I00191
 1976   013E    
 1976   013E           END IF
 1976    **        I00196:
 1976   013E           PosWas = Frm.TxtPos
 1976   013E        END IF
 1976    **        I00190:   mov     ax,0Ah[bp]
 1979    **                  add     ax,000Ah
 197C    **                  mov     si,ax
 197E    **                  mov     cx,[si]
 1980    **                  mov     POSWAS%,cx
 1984   013E    
 1984   013E    
 1984   013E    
 1984   013E        '----- Did we move to a new field or encounter an unknown k
                ey
 1984   013E        IF Frm.FldNo <> Frm.PrevFld OR TermKey THEN
 1984   013E    
 1984   013E           '----- Erase prvious messages
 1984   013E           IF LEN(Msg$) THEN
 1984   013E              Msg$ = ""
 1984   013E              Message Msg$                     'Null string clears 
                box
                                                                      PAGE  68
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1984    **        I00189:   mov     ax,0Ah[bp]
 1987    **                  add     ax,0002h
 198A    **                  mov     si,ax
 198C    **                  mov     cx,[si]
 198E    **                  mov     dx,0Ah[bp]
 1991    **                  add     dx,04h
 1994    **                  mov     si,dx
 1996    **                  cmp     cx,[si]
 1998    **                  mov     ax,0000h
 199B    **                  je      $+01h
 199D    **                  dec     ax
 199E    **                  or      ax,TERMKEY%
 19A2    **                  and     ax,ax
 19A4    **                  jne     $+03h
 19A6    **                  jmp     I00207
 19A9    **                  mov     ax,MSG$
 19AC    **                  and     ax,ax
 19AE    **                  jne     $+03h
 19B0    **                  jmp     I00208
 19B3    **                  push    offset <const>
 19B6    **                  push    offset MSG$
 19B9    **                  call    B$SASS
 19BE    **                  push    offset MSG$
 19C1    **                  call    MESSAGE
 19C6   013E              Frm.KeyCode = False
 19C6   013E              Ky$ = ""
 19C6   013E           END IF
 19C6    **                  mov     ax,0Ah[bp]
 19C9    **                  add     ax,0008h
 19CC    **                  mov     si,ax
 19CE    **                  mov     cx,FALSE%
 19D2    **                  mov     [si],cx
 19D4    **                  push    offset <const>
 19D7    **                  push    offset KY$
 19DA    **                  call    B$SASS
 19DF   0140    
 19DF   0140           '----- Were we on a "Notes" field?
 19DF   0140    '       IF Fld(Frm.PrevFld).FType = NotesFld THEN
 19DF   0140    '                                                'Paint the win
                dow to clear
 19DF   0140    '                                                '  painted blo
                ck
 19DF   0140    '          MPaintBox Fld(Frm.PrevFld).Row, Fld(Frm.PrevFld).LCo
                l, Fld(Frm.PrevFld).ScratchI, Fld(Frm.PrevFld).RCol, Ed.AColor
 19DF   0140    '
 19DF   0140    '          Frm.FldEdited = Ed.Changed            'Copy editors 
                "Changed" flag
 19DF   0140    '          IF Frm.FldEdited THEN                 'Was the text 
                edited?
 19DF   0140    '             Form$(Frm.PrevFld, 0) = ""         'Un-wrap the t
                ext and put it
 19DF   0140    '             Temp = UBOUND(Work$)               '  in the form
                 array
 19DF   0140    '             Ed.LCount = FindLast%(VARPTR(Work$(Temp)), Temp)
                                                                      PAGE  69
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 19DF   0140    '             FOR N = 1 TO Ed.LCount
 19DF   0140    '                 Form$(Frm.PrevFld, 0) = Form$(Frm.PrevFld, 0)
                 + Work$(N) + ""
 19DF   0140    '             NEXT
 19DF   0140    '          END IF
 19DF   0140    '                                                'If moving to 
                a new field,
 19DF   0140    '          'IF Frm.FldNo <> Frm.PrevFld THEN ERASE Work$ ' eras
                e the array
 19DF   0140    '
 19DF   0140    '          Frm.InsStat = Ed.InsStat = -1         'Copy QEdit's 
                insert state
 19DF   0140    '       END IF
 19DF   0140    
 19DF   0140           '----- If the field was edited, save and print it.
 19DF   0140           IF Frm.FldEdited THEN
 19DF   0140              Frm.Edited = -1                       'Set "Form Chan
                ged" flag
 19DF   0140                                                    'Save the field
                 into buffer
 19DF   0140                                                    '  and format n
                umbers
 19DF   0140              SaveField Frm.PrevFld, Form$(), Fld(), BadFld
 19DF    **        I00208:   mov     ax,0Ah[bp]
 19E2    **                  add     ax,0006h
 19E5    **                  mov     si,ax
 19E7    **                  mov     cx,[si]
 19E9    **                  and     cx,cx
 19EB    **                  jne     $+03h
 19ED    **                  jmp     I00209
 19F0    **                  mov     ax,0Ah[bp]
 19F3    **                  add     ax,0016h
 19F6    **                  mov     si,ax
 19F8    **                  mov     [si],0FFFFh
 19FC    **                  mov     ax,0Ah[bp]
 19FF    **                  add     ax,0004h
 1A02    **                  push    ax
 1A03    **                  push    0Eh[bp]
 1A06    **                  push    0Ch[bp]
 1A09    **                  push    offset BADFLD%
 1A0C    **                  call    SAVEFIELD
 1A11   0142    
 1A11   0142              IF BadFld THEN SWAP Form$(Frm.PrevFld, 0), FieldWas$
 1A11    **                  mov     ax,BADFLD%
 1A14    **                  and     ax,ax
 1A16    **                  je      I00210
 1A18    **                  mov     ax,0Ah[bp]
 1A1B    **                  add     ax,0004h
 1A1E    **                  mov     si,ax
 1A20    **                  mov     bx,[si]
 1A22    **                  sal     bx,1
 1A24    **                  sal     bx,1
 1A26    **                  mov     si,0Eh[bp]
 1A29    **                  add     bx,0Ah[si]
                                                                      PAGE  70
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1A2C    **                  mov     si,bx
 1A2E    **                  mov     di,offset FIELDWAS$
 1A31    **                  call    B$SWSD
 1A36   0142    
 1A36   0142              IF Fld(Frm.PrevFld).FType <> NotesFld THEN  'If it's 
                not a "Notes" field
 1A36   0142                                                    '  print it.
 1A36   0142                 PrintArray Frm.PrevFld, Frm.PrevFld, Form$(), Fld(
                )
 1A36    **        I00210:   mov     ax,0Ah[bp]
 1A39    **                  add     ax,0004h
 1A3C    **                  mov     si,ax
 1A3E    **                  mov     bx,[si]
 1A40    **                  sal     bx,1
 1A42    **                  sal     bx,1
 1A44    **                  sal     bx,1
 1A46    **                  sal     bx,1
 1A48    **                  sal     bx,1
 1A4A    **                  sal     bx,1
 1A4C    **                  mov     si,0Ch[bp]
 1A4F    **                  add     bx,0Ah[si]
 1A52    **                  mov     es,02h[si]
 1A55    **                  add     bx,0Ah
 1A58    **                  es:     
 1A59    **                  cmp     word ptr [bx],11h
 1A5C    **                  jne     $+03h
 1A5E    **                  jmp     I00211
 1A61    **                  mov     ax,0Ah[bp]
 1A64    **                  add     ax,0004h
 1A67    **                  push    ax
 1A68    **                  push    ax
 1A69    **                  push    0Eh[bp]
 1A6C    **                  push    0Ch[bp]
 1A6F    **                  call    PRINTARRAY
 1A74   0142              END IF
 1A74   0142    
 1A74   0142              '----- Display message if value out of range
 1A74   0142              IF BadFld THEN
 1A74   0142                 '----- Make Range strings for message
 1A74   0142                 IF FType = DateFld THEN            'US date field
 1A74   0142                    Temp$ = Num2Date$(CINT(Fld(Frm.PrevFld).LowRang
                e))
 1A74   0142                    Temp2$ = Num2Date$(CINT(Fld(Frm.PrevFld).HiRang
                e))
 1A74   0142                 ELSEIF FType = EuroDateFld THEN    'European date 
                field
 1A74    **        I00211:   mov     ax,BADFLD%
 1A77    **                  and     ax,ax
 1A79    **                  jne     $+03h
 1A7B    **                  jmp     I00212
 1A7E    **                  cmp     word ptr FTYPE%,06h
 1A83    **                  je      $+03h
 1A85    **                  jmp     I00213
 1A88    **                  mov     ax,0Ah[bp]
                                                                      PAGE  71
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1A8B    **                  add     ax,0004h
 1A8E    **                  mov     si,ax
 1A90    **                  mov     bx,[si]
 1A92    **                  sal     bx,1
 1A94    **                  sal     bx,1
 1A96    **                  sal     bx,1
 1A98    **                  sal     bx,1
 1A9A    **                  sal     bx,1
 1A9C    **                  sal     bx,1
 1A9E    **                  mov     si,0Ch[bp]
 1AA1    **                  add     bx,0Ah[si]
 1AA4    **                  mov     es,02h[si]
 1AA7    **                  add     bx,28h
 1AAA    **                  int     3Ch
 1AAC    **                  db      0DDh
 1AAD    **                  db      07h
 1AAE    **                  call    B$FIS2
 1AB3    **                  mov     t0142%,ax
 1AB6    **                  push    offset t0142%
 1AB9    **                  call    NUM2DATE$
 1ABE    **                  push    ax
 1ABF    **                  push    offset t0144$
 1AC2    **                  call    B$SASS
 1AC7    **                  push    offset t0144$
 1ACA    **                  push    offset TEMP$
 1ACD    **                  call    B$SASS
 1AD2    **                  mov     ax,0Ah[bp]
 1AD5    **                  add     ax,0004h
 1AD8    **                  mov     si,ax
 1ADA    **                  mov     bx,[si]
 1ADC    **                  sal     bx,1
 1ADE    **                  sal     bx,1
 1AE0    **                  sal     bx,1
 1AE2    **                  sal     bx,1
 1AE4    **                  sal     bx,1
 1AE6    **                  sal     bx,1
 1AE8    **                  mov     si,0Ch[bp]
 1AEB    **                  add     bx,0Ah[si]
 1AEE    **                  mov     es,02h[si]
 1AF1    **                  add     bx,30h
 1AF4    **                  int     3Ch
 1AF6    **                  db      0DDh
 1AF7    **                  db      07h
 1AF8    **                  call    B$FIS2
 1AFD    **                  mov     t0148%,ax
 1B00    **                  push    offset t0148%
 1B03    **                  call    NUM2DATE$
 1B08    **                  push    ax
 1B09    **                  push    offset t014A$
 1B0C    **                  call    B$SASS
 1B11    **                  push    offset t014A$
 1B14    **                  push    offset TEMP2$
 1B17    **                  call    B$SASS
 1B1C    **                  jmp     I00214
                                                                      PAGE  72
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1B1F   0152                    Temp$ = ENum2Date$(CINT(Fld(Frm.PrevFld).LowRan
                ge))
 1B1F   0152                    Temp2$ = ENum2Date$(CINT(Fld(Frm.PrevFld).HiRan
                ge))
 1B1F   0152                 ELSE                               'Number fields
 1B1F    **        I00213:   cmp     word ptr FTYPE%,13h
 1B24    **                  je      $+03h
 1B26    **                  jmp     I00215
 1B29    **                  mov     ax,0Ah[bp]
 1B2C    **                  add     ax,0004h
 1B2F    **                  mov     si,ax
 1B31    **                  mov     bx,[si]
 1B33    **                  sal     bx,1
 1B35    **                  sal     bx,1
 1B37    **                  sal     bx,1
 1B39    **                  sal     bx,1
 1B3B    **                  sal     bx,1
 1B3D    **                  sal     bx,1
 1B3F    **                  mov     si,0Ch[bp]
 1B42    **                  add     bx,0Ah[si]
 1B45    **                  mov     es,02h[si]
 1B48    **                  add     bx,28h
 1B4B    **                  int     3Ch
 1B4D    **                  db      0DDh
 1B4E    **                  db      07h
 1B4F    **                  call    B$FIS2
 1B54    **                  mov     t0152%,ax
 1B57    **                  push    offset t0152%
 1B5A    **                  call    ENUM2DATE$
 1B5F    **                  push    ax
 1B60    **                  push    offset t0154$
 1B63    **                  call    B$SASS
 1B68    **                  push    offset t0154$
 1B6B    **                  push    offset TEMP$
 1B6E    **                  call    B$SASS
 1B73    **                  mov     ax,0Ah[bp]
 1B76    **                  add     ax,0004h
 1B79    **                  mov     si,ax
 1B7B    **                  mov     bx,[si]
 1B7D    **                  sal     bx,1
 1B7F    **                  sal     bx,1
 1B81    **                  sal     bx,1
 1B83    **                  sal     bx,1
 1B85    **                  sal     bx,1
 1B87    **                  sal     bx,1
 1B89    **                  mov     si,0Ch[bp]
 1B8C    **                  add     bx,0Ah[si]
 1B8F    **                  mov     es,02h[si]
 1B92    **                  add     bx,30h
 1B95    **                  int     3Ch
 1B97    **                  db      0DDh
 1B98    **                  db      07h
 1B99    **                  call    B$FIS2
 1B9E    **                  mov     t0158%,ax
                                                                      PAGE  73
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1BA1    **                  push    offset t0158%
 1BA4    **                  call    ENUM2DATE$
 1BA9    **                  push    ax
 1BAA    **                  push    offset t015A$
 1BAD    **                  call    B$SASS
 1BB2    **                  push    offset t015A$
 1BB5    **                  push    offset TEMP2$
 1BB8    **                  call    B$SASS
 1BBD    **                  jmp     I00214
 1BC0   015E                    Temp$ = STR$(Fld(Frm.PrevFld).LowRange)
 1BC0   015E                    Temp2$ = STR$(Fld(Frm.PrevFld).HiRange)
 1BC0   015E                 END IF
 1BC0    **        I00215:   mov     ax,0Ah[bp]
 1BC3    **                  add     ax,0004h
 1BC6    **                  mov     si,ax
 1BC8    **                  mov     bx,[si]
 1BCA    **                  sal     bx,1
 1BCC    **                  sal     bx,1
 1BCE    **                  sal     bx,1
 1BD0    **                  sal     bx,1
 1BD2    **                  sal     bx,1
 1BD4    **                  sal     bx,1
 1BD6    **                  mov     si,0Ch[bp]
 1BD9    **                  mov     dx,bx
 1BDB    **                  add     bx,0Ah[si]
 1BDE    **                  mov     es,02h[si]
 1BE1    **                  add     bx,28h
 1BE4    **                  es:     
 1BE5    **                  push    06h[bx]
 1BE8    **                  es:     
 1BE9    **                  push    04h[bx]
 1BEC    **                  es:     
 1BED    **                  push    02h[bx]
 1BF0    **                  es:     
 1BF1    **                  push    [bx]
 1BF3    **                  mov     0DCh[bp],dx
 1BF6    **                  call    B$STR8
 1BFB    **                  push    ax
 1BFC    **                  push    offset TEMP$
 1BFF    **                  call    B$SASS
 1C04    **                  mov     bx,0DCh[bp]
 1C07    **                  add     bx,0Ah[si]
 1C0A    **                  mov     es,02h[si]
 1C0D    **                  add     bx,30h
 1C10    **                  es:     
 1C11    **                  push    06h[bx]
 1C14    **                  es:     
 1C15    **                  push    04h[bx]
 1C18    **                  es:     
 1C19    **                  push    02h[bx]
 1C1C    **                  es:     
 1C1D    **                  push    [bx]
 1C1F    **                  call    B$STR8
 1C24    **                  push    ax
                                                                      PAGE  74
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1C25    **                  push    offset TEMP2$
 1C28    **                  call    B$SASS
 1C2D   015E                
 1C2D   015E                 '----- Make the message string
 1C2D   015E                 IF BadFld = -1 THEN
 1C2D   015E                    Msg$ = "Value out of range!  (" + FieldWas$
                 + ")" + CHR$(13)
 1C2D   015E                    Msg$ = Msg$ + Temp$ + " .. " + Temp2$
 1C2D   015E                 ELSE
 1C2D    **        I00214:   cmp     word ptr BADFLD%,0FFh
 1C32    **                  jne     I00216
 1C34    **                  push    offset <const>
 1C37    **                  push    offset FIELDWAS$
 1C3A    **                  call    B$SCAT
 1C3F    **                  push    ax
 1C40    **                  push    offset <const>
 1C43    **                  call    B$SCAT
 1C48    **                  push    ax
 1C49    **                  push    0Dh
 1C4B    **                  call    B$FCHR
 1C50    **                  push    ax
 1C51    **                  call    B$SCAT
 1C56    **                  push    ax
 1C57    **                  push    offset MSG$
 1C5A    **                  call    B$SASS
 1C5F    **                  push    offset MSG$
 1C62    **                  push    offset TEMP$
 1C65    **                  call    B$SCAT
 1C6A    **                  push    ax
 1C6B    **                  push    offset <const>
 1C6E    **                  call    B$SCAT
 1C73    **                  push    ax
 1C74    **                  push    offset TEMP2$
 1C77    **                  call    B$SCAT
 1C7C    **                  push    ax
 1C7D    **                  push    offset MSG$
 1C80    **                  call    B$SASS
 1C85    **                  jmp     I00217
 1C88   015E                    Msg$ = "Invalid Date!  (" + FieldWas$ + ")"
 1C88   015E                 END IF
 1C88    **        I00216:   push    offset <const>
 1C8B    **                  push    offset FIELDWAS$
 1C8E    **                  call    B$SCAT
 1C93    **                  push    ax
 1C94    **                  push    offset <const>
 1C97    **                  call    B$SCAT
 1C9C    **                  push    ax
 1C9D    **                  push    offset MSG$
 1CA0    **                  call    B$SASS
 1CA5   015E    
 1CA5   015E                 Message Msg$                       'Display the me
                ssage box
 1CA5    **        I00217:   push    offset MSG$
 1CA8    **                  call    MESSAGE
                                                                      PAGE  75
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1CAD   015E                 BEEP
 1CAD   015E    
 1CAD   015E                 LeftCol = Fld(Frm.PrevFld).LCol    'Reset editing 
                parameters
 1CAD   015E                 Frm.TxtPos = 1
 1CAD   015E                 FirstKey = -1
 1CAD   015E                 Frm.FldNo = Frm.PrevFld
 1CAD   015E                 Frm.KeyCode = 0
 1CAD   015E                 EXIT SUB                           'Bail out
 1CAD   015E              END IF
 1CAD    **                  call    B$BEEP
 1CB2    **                  mov     ax,0Ah[bp]
 1CB5    **                  add     ax,0004h
 1CB8    **                  mov     si,ax
 1CBA    **                  mov     bx,[si]
 1CBC    **                  sal     bx,1
 1CBE    **                  sal     bx,1
 1CC0    **                  sal     bx,1
 1CC2    **                  sal     bx,1
 1CC4    **                  sal     bx,1
 1CC6    **                  sal     bx,1
 1CC8    **                  mov     si,0Ch[bp]
 1CCB    **                  add     bx,0Ah[si]
 1CCE    **                  mov     es,02h[si]
 1CD1    **                  add     bx,04h
 1CD4    **                  es:     
 1CD5    **                  mov     cx,[bx]
 1CD7    **                  mov     LEFTCOL%,cx
 1CDB    **                  mov     cx,0Ah[bp]
 1CDE    **                  add     cx,0Ah
 1CE1    **                  mov     si,cx
 1CE3    **                  mov     [si],0001h
 1CE7    **                  mov     FIRSTKEY%,0FFFFh
 1CED    **                  mov     si,ax
 1CEF    **                  mov     cx,[si]
 1CF1    **                  mov     dx,0Ah[bp]
 1CF4    **                  add     dx,02h
 1CF7    **                  mov     si,dx
 1CF9    **                  mov     [si],cx
 1CFB    **                  mov     ax,0Ah[bp]
 1CFE    **                  add     ax,0008h
 1D01    **                  mov     si,ax
 1D03    **                  mov     [si],0000h
 1D07    **                  jmp     I00037
 1D0A   015E    
 1D0A   015E              '----- Recalculate fields.  NOTE: This routine can be
                 called from
 1D0A   015E              '      your module after changing a number.
 1D0A   015E              IF UBOUND(Form$, 2) THEN
 1D0A   015E                 CalcFields Frm.StartEl, Frm.PrevFld, Form$(), Fld(
                )
 1D0A    **        I00212:   push    0Eh[bp]
 1D0D    **                  push    02h
 1D0F    **                  call    B$UBND
                                                                      PAGE  76
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1D14    **                  and     ax,ax
 1D16    **                  jne     $+03h
 1D18    **                  jmp     I00218
 1D1B    **                  push    0Ah[bp]
 1D1E    **                  mov     ax,0Ah[bp]
 1D21    **                  add     ax,0004h
 1D24    **                  push    ax
 1D25    **                  push    0Eh[bp]
 1D28    **                  push    0Ch[bp]
 1D2B    **                  call    CALCFIELDS
 1D30   015E              END IF
 1D30   015E           END IF
 1D30    **        I00218:
 1D30   015E    
 1D30   015E        END IF
 1D30    **        I00209:
 1D30   015E    
 1D30   015E    
 1D30   015E        '----- Make sure we stay within the form
 1D30   015E        IF Frm.FldNo > EndOfForm THEN               'Off the end?
 1D30   015E           GOSUB SetNextPage
 1D30    **        I00207:   mov     ax,0Ah[bp]
 1D33    **                  add     ax,0002h
 1D36    **                  mov     si,ax
 1D38    **                  mov     cx,[si]
 1D3A    **                  cmp     cx,ENDOFFORM%
 1D3E    **                  jg      $+03h
 1D40    **                  jmp     I00219
 1D43    **                  call    I00220
 1D46   015E        ELSEIF Frm.FldNo <= Frm.StartEl THEN        'Past the begin
                ning?
 1D46    **                  jmp     I00221
 1D49   015E           GOSUB SetPrevPage
 1D49    **        I00219:   mov     si,0Ah[bp]
 1D4C    **                  mov     ax,[si]
 1D4E    **                  add     si,02h
 1D51    **                  cmp     ax,[si]
 1D53    **                  jnl     $+03h
 1D55    **                  jmp     I00222
 1D58    **                  call    I00223
 1D5B   015E        END IF
 1D5B    **        I00221:
 1D5B   015E    
 1D5B   015E       
 1D5B   015E        EXIT SUB
 1D5B   015E    
 1D5B   015E    
 1D5B   015E    DeleteChar:
 1D5B    **        I00222:   jmp     I00037
 1D5E   015E        Nd = INSTR(Frm.TxtPos + 1, Mask$, "")      'Look for skip 
                character
 1D5E   015E        IF Nd = 0 THEN Nd = LEN(Form$(Frm.FldNo, 0)) + 1
 1D5E    **        I00111:   mov     ax,0Ah[bp]
 1D61    **                  add     ax,000Ah
                                                                      PAGE  77
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1D64    **                  mov     si,ax
 1D66    **                  mov     cx,[si]
 1D68    **                  inc     cx
 1D69    **                  push    cx
 1D6A    **                  push    offset MASK$
 1D6D    **                  push    offset <const>
 1D70    **                  call    B$INS3
 1D75    **                  mov     ND%,ax
 1D78    **                  or      ax,ax
 1D7A    **                  jne     I00224
 1D7C    **                  mov     ax,0Ah[bp]
 1D7F    **                  add     ax,0002h
 1D82    **                  mov     si,ax
 1D84    **                  mov     bx,[si]
 1D86    **                  sal     bx,1
 1D88    **                  sal     bx,1
 1D8A    **                  mov     si,0Eh[bp]
 1D8D    **                  add     bx,0Ah[si]
 1D90    **                  mov     si,bx
 1D92    **                  mov     ax,[bx]
 1D94    **                  inc     ax
 1D95    **                  mov     ND%,ax
 1D98   015E    
 1D98   015E        MID$(Form$(Frm.FldNo, 0), Frm.TxtPos) = MID$(Form$(Frm.FldN
                o, 0), Frm.TxtPos + 1, Nd - Frm.TxtPos - 1) + " "
 1D98   015E    RETURN
 1D98   015E    
 1D98   015E    
 1D98   015E    '----- Adjust the cursor size
 1D98   015E    SetCursor:
 1D98    **        I00224:   mov     ax,0Ah[bp]
 1D9B    **                  add     ax,0002h
 1D9E    **                  mov     si,ax
 1DA0    **                  mov     bx,[si]
 1DA2    **                  sal     bx,1
 1DA4    **                  sal     bx,1
 1DA6    **                  mov     si,0Eh[bp]
 1DA9    **                  mov     dx,bx
 1DAB    **                  add     bx,0Ah[si]
 1DAE    **                  push    bx
 1DAF    **                  mov     ax,0Ah[bp]
 1DB2    **                  add     ax,000Ah
 1DB5    **                  mov     si,ax
 1DB7    **                  mov     cx,[si]
 1DB9    **                  mov     bx,cx
 1DBB    **                  inc     cx
 1DBC    **                  push    cx
 1DBD    **                  mov     cx,bx
 1DBF    **                  sub     bx,ND%
 1DC3    **                  neg     bx
 1DC5    **                  dec     bx
 1DC6    **                  push    bx
 1DC7    **                  mov     0DAh[bp],cx
 1DCA    **                  mov     0D8h[bp],dx
                                                                      PAGE  78
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1DCD    **                  call    B$FMID
 1DD2    **                  push    ax
 1DD3    **                  push    offset t015E$
 1DD6    **                  call    B$SASS
 1DDB    **                  mov     si,0Eh[bp]
 1DDE    **                  mov     bx,0D8h[bp]
 1DE1    **                  add     bx,0Ah[si]
 1DE4    **                  push    ds
 1DE5    **                  push    bx
 1DE6    **                  xor     ax,ax
 1DE8    **                  push    ax
 1DE9    **                  push    offset t015E$
 1DEC    **                  push    offset <const>
 1DEF    **                  call    B$SCAT
 1DF4    **                  push    ax
 1DF5    **                  push    7FFFh
 1DF8    **                  push    0DAh[bp]
 1DFB    **                  call    B$SMID
 1E00    **                  ret     
 1E01   0162        Instate = Frm.InsStat
 1E01   0162        IF Frm.InsStat THEN
 1E01   0162           LOCATE , , , Cnf.CsrSize \ 2, Cnf.CsrSize
 1E01   0162        ELSE
 1E01    **        I00042:   mov     ax,0Ah[bp]
 1E04    **                  add     ax,000Ch
 1E07    **                  mov     si,ax
 1E09    **                  mov     cx,[si]
 1E0B    **                  mov     INSTATE%,cx
 1E0F    **                  and     cx,cx
 1E11    **                  je      I00225
 1E13    **                  push    00h
 1E15    **                  push    00h
 1E17    **                  push    00h
 1E19    **                  push    01h
 1E1B    **                  mov     ax,08h[bp]
 1E1E    **                  add     ax,0004h
 1E21    **                  mov     si,ax
 1E23    **                  mov     ax,[si]
 1E25    **                  mov     cx,0002h
 1E28    **                  mov     bx,ax
 1E2A    **                  cwd     
 1E2B    **                  idiv    cx
 1E2D    **                  push    ax
 1E2E    **                  push    01h
 1E30    **                  push    bx
 1E31    **                  push    07h
 1E33    **                  call    B$LOCT
 1E38    **                  jmp     I00226
 1E3B   0164           LOCATE , , , Cnf.CsrSize - 1, Cnf.CsrSize
 1E3B   0164        END IF
 1E3B    **        I00225:   push    00h
 1E3D    **                  push    00h
 1E3F    **                  push    00h
 1E41    **                  push    01h
                                                                      PAGE  79
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1E43    **                  mov     ax,08h[bp]
 1E46    **                  add     ax,0004h
 1E49    **                  mov     si,ax
 1E4B    **                  mov     cx,[si]
 1E4D    **                  mov     bx,cx
 1E4F    **                  dec     cx
 1E50    **                  push    cx
 1E51    **                  push    01h
 1E53    **                  push    bx
 1E54    **                  push    07h
 1E56    **                  call    B$LOCT
 1E5B   0164    RETURN
 1E5B   0164    
 1E5B   0164    
 1E5B   0164    '-----
 1E5B   0164    ForwardSkipProtected:
 1E5B    **        I00226:   ret     
 1E5C   0164        DO WHILE Fld(Frm.FldNo).Protected
 1E5C    **        I00046:
 1E5C   0164           Frm.FldNo = Frm.FldNo + 1
 1E5C   0164           IF Frm.FldNo > EndOfForm THEN
 1E5C   0164              GOSUB SetNextPage
 1E5C    **        I00227:   mov     ax,0Ah[bp]
 1E5F    **                  add     ax,0002h
 1E62    **                  mov     si,ax
 1E64    **                  mov     bx,[si]
 1E66    **                  mov     dx,bx
 1E68    **                  sal     bx,1
 1E6A    **                  sal     bx,1
 1E6C    **                  sal     bx,1
 1E6E    **                  sal     bx,1
 1E70    **                  sal     bx,1
 1E72    **                  sal     bx,1
 1E74    **                  mov     si,0Ch[bp]
 1E77    **                  add     bx,0Ah[si]
 1E7A    **                  mov     es,02h[si]
 1E7D    **                  add     bx,24h
 1E80    **                  es:     
 1E81    **                  mov     cx,[bx]
 1E83    **                  and     cx,cx
 1E85    **                  jne     $+03h
 1E87    **                  jmp     I00228
 1E8A    **                  mov     si,ax
 1E8C    **                  inc     [si]
 1E8E    **                  mov     ax,ENDOFFORM%
 1E91    **                  cmp     ax,[si]
 1E93    **                  jl      $+03h
 1E95    **                  jmp     I00229
 1E98    **                  call    I00220
 1E9B   0164           END IF
 1E9B   0164        LOOP
 1E9B    **        I00229:   jmp     I00227
 1E9D    **                  nop     
 1E9E   0164    RETURN
                                                                      PAGE  80
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1E9E   0164    
 1E9E   0164    BackwardSkipProtected:
 1E9E    **        I00228:   ret     
 1E9F   0164        DO WHILE Fld(Frm.FldNo).Protected
 1E9F    **        I00048:   nop     
 1EA0   0164           Frm.FldNo = Frm.FldNo - 1
 1EA0   0164           IF Frm.FldNo <= Frm.StartEl THEN
 1EA0   0164              GOSUB SetPrevPage
 1EA0    **        I00230:   mov     ax,0Ah[bp]
 1EA3    **                  add     ax,0002h
 1EA6    **                  mov     si,ax
 1EA8    **                  mov     bx,[si]
 1EAA    **                  mov     dx,bx
 1EAC    **                  sal     bx,1
 1EAE    **                  sal     bx,1
 1EB0    **                  sal     bx,1
 1EB2    **                  sal     bx,1
 1EB4    **                  sal     bx,1
 1EB6    **                  sal     bx,1
 1EB8    **                  mov     si,0Ch[bp]
 1EBB    **                  add     bx,0Ah[si]
 1EBE    **                  mov     es,02h[si]
 1EC1    **                  add     bx,24h
 1EC4    **                  es:     
 1EC5    **                  mov     cx,[bx]
 1EC7    **                  and     cx,cx
 1EC9    **                  jne     $+03h
 1ECB    **                  jmp     I00231
 1ECE    **                  mov     si,ax
 1ED0    **                  dec     [si]
 1ED2    **                  mov     di,0Ah[bp]
 1ED5    **                  mov     cx,[di]
 1ED7    **                  cmp     cx,[si]
 1ED9    **                  jnl     $+03h
 1EDB    **                  jmp     I00232
 1EDE    **                  call    I00223
 1EE1   0164           END IF
 1EE1   0164        LOOP
 1EE1    **        I00232:   jmp     I00230
 1EE3    **                  nop     
 1EE4   0164    RETURN
 1EE4   0164    
 1EE4   0164    
 1EE4   0164    SetNextPage:
 1EE4    **        I00231:   ret     
 1EE5   0164    
 1EE5   0164        N = Frm.StartEl + Fld(Frm.StartEl).Fields + 1
 1EE5   0164        IF N < UBOUND(Fld) THEN
 1EE5   0164           IF Fld(N).Fields THEN
 1EE5   0164              Frm.StartEl = N
 1EE5   0164              Frm.FldNo = Frm.StartEl + 1
 1EE5   0164              EndOfForm = N + Fld(N).Fields
 1EE5   0164              IF Fld(Frm.FldNo).Protected AND SkipProtected THEN
 1EE5   0164                 GOSUB ForwardSkipProtected
                                                                      PAGE  81
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1EE5    **        I00220:   mov     si,0Ah[bp]
 1EE8    **                  mov     bx,[si]
 1EEA    **                  mov     dx,bx
 1EEC    **                  sal     bx,1
 1EEE    **                  sal     bx,1
 1EF0    **                  sal     bx,1
 1EF2    **                  sal     bx,1
 1EF4    **                  sal     bx,1
 1EF6    **                  sal     bx,1
 1EF8    **                  mov     si,0Ch[bp]
 1EFB    **                  add     bx,0Ah[si]
 1EFE    **                  mov     es,02h[si]
 1F01    **                  es:     
 1F02    **                  mov     ax,[bx]
 1F04    **                  add     ax,dx
 1F06    **                  inc     ax
 1F07    **                  mov     N%,ax
 1F0A    **                  push    0Ch[bp]
 1F0D    **                  push    01h
 1F0F    **                  call    B$UBND
 1F14    **                  cmp     ax,N%
 1F18    **                  jg      $+03h
 1F1A    **                  jmp     I00233
 1F1D    **                  mov     bx,N%
 1F21    **                  sal     bx,1
 1F23    **                  sal     bx,1
 1F25    **                  sal     bx,1
 1F27    **                  sal     bx,1
 1F29    **                  sal     bx,1
 1F2B    **                  sal     bx,1
 1F2D    **                  mov     dx,bx
 1F2F    **                  add     bx,0Ah[si]
 1F32    **                  mov     es,02h[si]
 1F35    **                  es:     
 1F36    **                  mov     ax,[bx]
 1F38    **                  and     ax,ax
 1F3A    **                  jne     $+03h
 1F3C    **                  jmp     I00234
 1F3F    **                  mov     ax,N%
 1F42    **                  mov     di,0Ah[bp]
 1F45    **                  mov     [di],ax
 1F47    **                  mov     cx,[di]
 1F49    **                  inc     cx
 1F4A    **                  add     di,02h
 1F4D    **                  mov     [di],cx
 1F4F    **                  mov     bx,dx
 1F51    **                  add     bx,0Ah[si]
 1F54    **                  mov     es,02h[si]
 1F57    **                  es:     
 1F58    **                  add     ax,[bx]
 1F5A    **                  mov     ENDOFFORM%,ax
 1F5D    **                  mov     bx,[di]
 1F5F    **                  sal     bx,1
 1F61    **                  sal     bx,1
                                                                      PAGE  82
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1F63    **                  sal     bx,1
 1F65    **                  sal     bx,1
 1F67    **                  sal     bx,1
 1F69    **                  sal     bx,1
 1F6B    **                  add     bx,0Ah[si]
 1F6E    **                  mov     es,02h[si]
 1F71    **                  add     bx,24h
 1F74    **                  es:     
 1F75    **                  mov     ax,[bx]
 1F77    **                  and     ax,0FFFFh
 1F7A    **                  and     ax,ax
 1F7C    **                  jne     $+03h
 1F7E    **                  jmp     I00235
 1F81    **                  call    I00046
 1F84   0164              END IF
 1F84   0164              Action = 1
 1F84   0164              EXIT SUB
 1F84   0164           END IF
 1F84    **        I00235:   mov     si,06h[bp]
 1F87    **                  mov     [si],0001h
 1F8B    **                  jmp     I00037
 1F8E   0164        END IF
 1F8E    **        I00234:
 1F8E   0164        Frm.FldNo = EndOfForm
 1F8E   0164        Frm.PrevFld = 0
 1F8E   0164        IF Fld(Frm.FldNo).Protected AND SkipProtected THEN
 1F8E   0164           GOSUB BackwardSkipProtected
 1F8E    **        I00233:   mov     ax,0Ah[bp]
 1F91    **                  add     ax,0002h
 1F94    **                  mov     si,ax
 1F96    **                  mov     cx,ENDOFFORM%
 1F9A    **                  mov     [si],cx
 1F9C    **                  mov     cx,0Ah[bp]
 1F9F    **                  add     cx,04h
 1FA2    **                  mov     di,cx
 1FA4    **                  mov     [di],0000h
 1FA8    **                  mov     bx,[si]
 1FAA    **                  sal     bx,1
 1FAC    **                  sal     bx,1
 1FAE    **                  sal     bx,1
 1FB0    **                  sal     bx,1
 1FB2    **                  sal     bx,1
 1FB4    **                  sal     bx,1
 1FB6    **                  mov     si,0Ch[bp]
 1FB9    **                  add     bx,0Ah[si]
 1FBC    **                  mov     es,02h[si]
 1FBF    **                  add     bx,24h
 1FC2    **                  es:     
 1FC3    **                  mov     ax,[bx]
 1FC5    **                  and     ax,0FFFFh
 1FC8    **                  and     ax,ax
 1FCA    **                  jne     $+03h
 1FCC    **                  jmp     I00236
 1FCF    **                  call    I00048
                                                                      PAGE  83
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 1FD2   0164        END IF
 1FD2   0164    
 1FD2   0164    RETURN
 1FD2   0164    
 1FD2   0164    SetPrevPage:
 1FD2    **        I00236:   ret     
 1FD3   0164    
 1FD3   0164        FOR N = Frm.StartEl - 1 TO 0 STEP -1
 1FD3    **        I00223:   mov     si,0Ah[bp]
 1FD6    **                  mov     ax,[si]
 1FD8    **                  dec     ax
 1FD9    **                  jmp     I00237
 1FDC   0164           IF Fld(N).FType = 0 THEN EXIT FOR
 1FDC    **        I00238:   sal     ax,1
 1FDE    **                  sal     ax,1
 1FE0    **                  sal     ax,1
 1FE2    **                  sal     ax,1
 1FE4    **                  sal     ax,1
 1FE6    **                  sal     ax,1
 1FE8    **                  mov     bx,ax
 1FEA    **                  mov     si,0Ch[bp]
 1FED    **                  add     bx,0Ah[si]
 1FF0    **                  mov     es,02h[si]
 1FF3    **                  add     bx,0Ah
 1FF6    **                  es:     
 1FF7    **                  cmp     word ptr [bx],00h
 1FFA    **                  jne     $+03h
 1FFC    **                  jmp     I00240
 1FFF   0164        NEXT
 1FFF    **                  mov     ax,N%
 2002    **                  dec     ax
 2003    **        I00237:   mov     N%,ax
 2006    **                  or      ax,ax
 2008    **                  jnl     I00238
 200A   0164    
 200A   0164        IF N < Frm.StartEl AND N >= 0 THEN
 200A   0164           Frm.FldNo = Frm.StartEl - 1
 200A   0164           Frm.StartEl = N
 200A   0164           EndOfForm = N + Fld(N).Fields
 200A   0164           GOSUB BackwardSkipProtected
 200A    **        I00240:   mov     si,0Ah[bp]
 200D    **                  mov     ax,[si]
 200F    **                  cmp     ax,N%
 2013    **                  jg      $+03h
 2015    **                  jmp     I00241
 2018    **                  cmp     word ptr N%,00h
 201D    **                  jnl     $+03h
 201F    **                  jmp     I00241
 2022    **                  dec     ax
 2023    **                  add     si,02h
 2026    **                  mov     [si],ax
 2028    **                  mov     ax,N%
 202B    **                  mov     si,0Ah[bp]
 202E    **                  mov     [si],ax
                                                                      PAGE  84
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2030    **                  sal     ax,1
 2032    **                  sal     ax,1
 2034    **                  sal     ax,1
 2036    **                  sal     ax,1
 2038    **                  sal     ax,1
 203A    **                  sal     ax,1
 203C    **                  mov     bx,ax
 203E    **                  mov     si,0Ch[bp]
 2041    **                  add     bx,0Ah[si]
 2044    **                  mov     es,02h[si]
 2047    **                  es:     
 2048    **                  mov     ax,[bx]
 204A    **                  add     ax,N%
 204E    **                  mov     ENDOFFORM%,ax
 2051    **                  call    I00048
 2054   0164           Action = 1
 2054   0164           EXIT SUB
 2054   0164        ELSE
 2054    **                  mov     si,06h[bp]
 2057    **                  mov     [si],0001h
 205B    **                  jmp     I00037
 205E    **                  jmp     I00242
 2061   0164           Frm.FldNo = Frm.StartEl + 1
 2061   0164           IF (Fld(Frm.FldNo).Protected AND SkipProtected) THEN
 2061   0164              GOSUB ForwardSkipProtected
 2061    **        I00241:   mov     si,0Ah[bp]
 2064    **                  mov     ax,[si]
 2066    **                  inc     ax
 2067    **                  add     si,02h
 206A    **                  mov     [si],ax
 206C    **                  mov     bx,[si]
 206E    **                  sal     bx,1
 2070    **                  sal     bx,1
 2072    **                  sal     bx,1
 2074    **                  sal     bx,1
 2076    **                  sal     bx,1
 2078    **                  sal     bx,1
 207A    **                  mov     si,0Ch[bp]
 207D    **                  add     bx,0Ah[si]
 2080    **                  mov     es,02h[si]
 2083    **                  add     bx,24h
 2086    **                  es:     
 2087    **                  mov     ax,[bx]
 2089    **                  and     ax,0FFFFh
 208C    **                  and     ax,ax
 208E    **                  jne     $+03h
 2090    **                  jmp     I00243
 2093    **                  call    I00046
 2096   0164           END IF
 2096   0164        END IF
 2096    **        I00243:
 2096   0164    
 2096   0164    RETURN
 2096   0164    
                                                                      PAGE  85
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2096   0164    END SUB
 2096    **        I00242:   ret     
 2097    **        I00037:   push    offset t015E$
 209A    **                  call    B$STDL
 209F    **                  push    offset t015A$
 20A2    **                  call    B$STDL
 20A7    **                  push    offset t0154$
 20AA    **                  call    B$STDL
 20AF    **                  push    offset t014A$
 20B2    **                  call    B$STDL
 20B7    **                  push    offset t0144$
 20BA    **                  call    B$STDL
 20BF    **                  push    offset t0138$
 20C2    **                  call    B$STDL
 20C7    **                  push    offset t0122$
 20CA    **                  call    B$STDL
 20CF    **                  push    offset t0116$
 20D2    **                  call    B$STDL
 20D7    **                  push    offset t0110$
 20DA    **                  call    B$STDL
 20DF    **                  push    offset t010C$
 20E2    **                  call    B$STDL
 20E7    **                  push    offset t0102$
 20EA    **                  call    B$STDL
 20EF    **                  push    offset t00FA$
 20F2    **                  call    B$STDL
 20F7    **                  push    offset t00F4$
 20FA    **                  call    B$STDL
 2107   0164    
 2107   0164    FUNCTION EndOfForms (Fld() AS FieldInfo) STATIC
 20FF    **        I00036:   jmp     I00244
 2120   0164    
 2120   0164        S = 0
 2120   0164        DO
 210A    **                  mov     S%,0000h
 2126   0166           LFld = S + Fld(S).Fields
 2126   0166           IF LFld + 1 < UBOUND(Fld) THEN
 2126   0166              IF Fld(LFld + 1).Fields THEN
 2126   0166                 S = LFld + 1
 2126   0166              END IF
 2126    **        I00246:   mov     bx,S%
 212A    **                  sal     bx,1
 212C    **                  sal     bx,1
 212E    **                  sal     bx,1
 2130    **                  sal     bx,1
 2132    **                  sal     bx,1
 2134    **                  sal     bx,1
 2136    **                  mov     si,06h[bp]
 2139    **                  add     bx,0Ah[si]
 213C    **                  mov     es,02h[si]
 213F    **                  es:     
 2140    **                  mov     ax,[bx]
 2142    **                  add     ax,S%
 2146    **                  mov     LFLD%,ax
                                                                      PAGE  86
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2149    **                  inc     ax
 214A    **                  push    06h[bp]
 214D    **                  push    01h
 214F    **                  mov     0ECh[bp],ax
 2152    **                  call    B$UBND
 2157    **                  cmp     ax,0ECh[bp]
 215A    **                  jg      $+03h
 215C    **                  jmp     I00247
 215F    **                  mov     ax,LFLD%
 2162    **                  sal     ax,1
 2164    **                  sal     ax,1
 2166    **                  sal     ax,1
 2168    **                  sal     ax,1
 216A    **                  sal     ax,1
 216C    **                  sal     ax,1
 216E    **                  add     ax,0040h
 2171    **                  mov     bx,ax
 2173    **                  add     bx,0Ah[si]
 2176    **                  mov     es,02h[si]
 2179    **                  es:     
 217A    **                  mov     ax,[bx]
 217C    **                  and     ax,ax
 217E    **                  je      I00248
 2180    **                  mov     ax,0ECh[bp]
 2183    **                  mov     S%,ax
 2186   0168           END IF
 2186    **        I00248:
 2186   0168        LOOP WHILE S = LFld + 1
 2186   0168    
 2186   0168        EndOfForms = LFld
 2186   0168    
 2186   0168    END FUNCTION
 2186    **        I00247:   mov     ax,LFLD%
 2189    **                  inc     ax
 218A    **                  cmp     ax,S%
 218E    **                  je      I00246
 2190    **                  mov     ax,LFLD%
 2193    **                  mov     ENDOFFORMS%,ax
 2196    **        I00245:   mov     ax,ENDOFFORMS%
 21A1   016A    
 21A1   016A    SUB FEInitForm (Form$(), Fld() AS FieldInfo, Frm AS FormInfo)
 2199    **        I00244:   jmp     I00249
 21BA   016A    
 21BA   016A        SHARED EndOfForm, ScrRows, TopRow, BottomRow, NPixLines, In
                state
 21BA   016A    '    SHARED Ed AS EditInfo
 21BA   016A    
 21BA   016A        Frm.Edited = 0                              'New form hasn'
                t been edited
 21BA   016A        GetVMode 0, 0, 0, ScrRows, 0                'See how many l
                ines on screen
 21A4    **                  mov     ax,06h[bp]
 21BD    **                  add     ax,0016h
 21C0    **                  mov     si,ax
                                                                      PAGE  87
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 21C2    **                  mov     [si],0000h
 21C6    **                  mov     0ECh[bp],0000h
 21CB    **                  mov     0EAh[bp],0000h
 21D0    **                  mov     0E8h[bp],0000h
 21D5    **                  mov     0E6h[bp],0000h
 21DA    **                  lea     ax,0ECh[bp]
 21DD    **                  push    ax
 21DE    **                  lea     ax,0EAh[bp]
 21E1    **                  push    ax
 21E2    **                  lea     ax,0E8h[bp]
 21E5    **                  push    ax
 21E6    **                  push    offset SCRROWS%
 21E9    **                  lea     ax,0E6h[bp]
 21EC    **                  push    ax
 21ED    **                  call    GETVMODE
 21F2   016C        MouseTrap 1, 1, ScrRows, 80                 'Let mouse use 
                full screen
 21F2    **                  mov     0E4h[bp],0001h
 21F7    **                  mov     0E2h[bp],0001h
 21FC    **                  mov     0E0h[bp],0050h
 2201    **                  lea     ax,0E4h[bp]
 2204    **                  push    ax
 2205    **                  lea     ax,0E2h[bp]
 2208    **                  push    ax
 2209    **                  push    offset SCRROWS%
 220C    **                  lea     ax,0E0h[bp]
 220F    **                  push    ax
 2210    **                  call    MOUSETRAP
 2215   016C        NPixLines = 8                               'Set mouse pixe
                ls/character
 2215   016C        IF ScrRows > 43 AND DOSVer% >= 1000 THEN NPixLines = 7
 2215    **                  mov     NPIXLINES%,0008h
 221B    **                  call    DOSVER%
 2220    **                  mov     0DEh[bp],ax
 2223    **                  cmp     word ptr SCRROWS%,2Bh
 2228    **                  jng     I00251
 222A    **                  cmp     0DEh[bp],03E8h
 222F    **                  jl      I00251
 2231    **                  mov     NPIXLINES%,0007h
 2237   016C    
 2237   016C        Instate = Frm.InsStat
 2237   016C    '    IF Frm.InsStat THEN                         'Set QEdit's i
                nsert state
 2237   016C    '       Ed.InsStat = Frm.InsStat
 2237   016C    '    ELSE
 2237   016C    '       Ed.InsStat = 1
 2237   016C    '    END IF
 2237   016C    
 2237   016C        Frm.PrevFld = 0                             'Set previous f
                ield # to 0
 2237   016C                                                    'Check current 
                field #
 2237   016C        IF Frm.FldNo <= Frm.StartEl THEN Frm.FldNo = Frm.StartEl + 
                1
                                                                      PAGE  88
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2237    **        I00251:   mov     ax,06h[bp]
 223A    **                  add     ax,000Ch
 223D    **                  mov     si,ax
 223F    **                  mov     cx,[si]
 2241    **                  mov     INSTATE%,cx
 2245    **                  mov     ax,06h[bp]
 2248    **                  add     ax,0004h
 224B    **                  mov     si,ax
 224D    **                  mov     [si],0000h
 2251    **                  mov     si,06h[bp]
 2254    **                  mov     ax,[si]
 2256    **                  add     si,02h
 2259    **                  cmp     ax,[si]
 225B    **                  jl      I00252
 225D    **                  inc     ax
 225E    **                  mov     [si],ax
 2260   016C                                                    'Pad the record
                 buffer
 2260   016C        IF LEN(Form$(0, 0)) = 0 THEN
 2260   016C           Form$(0, 0) = SPACE$(Fld(0).Row)
 2260   016C        END IF
 2260    **        I00252:   mov     si,0Ah[bp]
 2263    **                  xor     bx,bx
 2265    **                  add     bx,0Ah[si]
 2268    **                  mov     si,bx
 226A    **                  cmp     word ptr [bx],00h
 226D    **                  jne     I00253
 226F    **                  mov     si,08h[bp]
 2272    **                  xor     bx,bx
 2274    **                  add     bx,0Ah[si]
 2277    **                  mov     es,02h[si]
 227A    **                  add     bx,02h
 227D    **                  es:     
 227E    **                  push    [bx]
 2280    **                  call    B$SPAC
 2285    **                  push    ax
 2286    **                  lea     ax,0DAh[bp]
 2289    **                  push    ax
 228A    **                  call    B$SASS
 228F    **                  lea     ax,0DAh[bp]
 2292    **                  push    ax
 2293    **                  mov     si,0Ah[bp]
 2296    **                  xor     bx,bx
 2298    **                  add     bx,0Ah[si]
 229B    **                  push    bx
 229C    **                  call    B$SASS
 22A1   016C    
 22A1   016C        EndOfForm = Frm.StartEl + Fld(Frm.StartEl).Fields
 22A1   016C        BottomRow = 0
 22A1   016C        TopRow = 60
 22A1   016C    
 22A1   016C        '----- Check all field strings for length and format
 22A1   016C        FOR N = 1 TO EndOfForms(Fld())
 22A1    **        I00253:   mov     si,06h[bp]
                                                                      PAGE  89
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 22A4    **                  mov     bx,[si]
 22A6    **                  mov     dx,bx
 22A8    **                  sal     bx,1
 22AA    **                  sal     bx,1
 22AC    **                  sal     bx,1
 22AE    **                  sal     bx,1
 22B0    **                  sal     bx,1
 22B2    **                  sal     bx,1
 22B4    **                  mov     si,08h[bp]
 22B7    **                  add     bx,0Ah[si]
 22BA    **                  mov     es,02h[si]
 22BD    **                  es:     
 22BE    **                  mov     ax,[bx]
 22C0    **                  add     dx,ax
 22C2    **                  mov     ENDOFFORM%,dx
 22C6    **                  mov     BOTTOMROW%,0000h
 22CC    **                  mov     TOPROW%,003Ch
 22D2    **                  push    08h[bp]
 22D5    **                  call    ENDOFFORMS%
 22DA    **                  mov     0D8h[bp],ax
 22DD    **                  mov     ax,0D8h[bp]
 22E0    **                  mov     0D6h[bp],ax
 22E3    **                  mov     ax,0001h
 22E6    **                  jmp     I00254
 22E9    **                  nop     
 22EA   016C    
 22EA   016C            IF Fld(N).FType = 0 THEN N = N + 1
 22EA    **        I00255:   sal     ax,1
 22EC    **                  sal     ax,1
 22EE    **                  sal     ax,1
 22F0    **                  sal     ax,1
 22F2    **                  sal     ax,1
 22F4    **                  sal     ax,1
 22F6    **                  mov     bx,ax
 22F8    **                  mov     si,08h[bp]
 22FB    **                  add     bx,0Ah[si]
 22FE    **                  mov     es,02h[si]
 2301    **                  add     bx,0Ah
 2304    **                  es:     
 2305    **                  cmp     word ptr [bx],00h
 2308    **                  jne     I00256
 230A    **                  inc     0D4h[bp]
 230D   016C    
 230D   016C            BottomRow = MaxInt(BottomRow, Fld(N).Row)
 230D   016C            TopRow = MinInt(TopRow, Fld(N).Row)
 230D   016C    
 230D   016C            '----- Skip Notes fields and Buttons
 230D   016C            IF Fld(N).FType <> NotesFld AND Fld(N).FType <> Button 
                THEN
 230D   016C               Temp = LEN(Form$(N, 0))              'Get current le
                ngth
 230D   016C               Temp2 = Fld(N).RCol - Fld(N).LCol + 1
 230D   016C    
 230D   016C               IF Temp < Temp2 THEN                 'field too shor
                                                                      PAGE  90
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

                t?
 230D   016C                  Form$(N, 0) = Form$(N, 0) + SPACE$(Temp2 - Temp)
 230D   016C               ELSEIF Temp > Temp2 THEN             'field too long
 230D    **        I00256:   mov     bx,0D4h[bp]
 2310    **                  sal     bx,1
 2312    **                  sal     bx,1
 2314    **                  sal     bx,1
 2316    **                  sal     bx,1
 2318    **                  sal     bx,1
 231A    **                  sal     bx,1
 231C    **                  mov     si,08h[bp]
 231F    **                  add     bx,0Ah[si]
 2322    **                  mov     es,02h[si]
 2325    **                  add     bx,02h
 2328    **                  es:     
 2329    **                  mov     ax,[bx]
 232B    **                  mov     0D2h[bp],ax
 232E    **                  push    offset BOTTOMROW%
 2331    **                  lea     ax,0D2h[bp]
 2334    **                  push    ax
 2335    **                  call    MAXINT%
 233A    **                  mov     0D0h[bp],ax
 233D    **                  mov     bx,0D4h[bp]
 2340    **                  sal     bx,1
 2342    **                  sal     bx,1
 2344    **                  sal     bx,1
 2346    **                  sal     bx,1
 2348    **                  sal     bx,1
 234A    **                  sal     bx,1
 234C    **                  mov     si,08h[bp]
 234F    **                  mov     dx,bx
 2351    **                  add     bx,0Ah[si]
 2354    **                  mov     es,02h[si]
 2357    **                  add     bx,02h
 235A    **                  mov     ax,0D2h[bp]
 235D    **                  es:     
 235E    **                  mov     [bx],ax
 2360    **                  mov     ax,0D0h[bp]
 2363    **                  mov     BOTTOMROW%,ax
 2366    **                  mov     bx,dx
 2368    **                  add     bx,0Ah[si]
 236B    **                  mov     es,02h[si]
 236E    **                  add     bx,02h
 2371    **                  es:     
 2372    **                  mov     ax,[bx]
 2374    **                  mov     0CEh[bp],ax
 2377    **                  push    offset TOPROW%
 237A    **                  lea     ax,0CEh[bp]
 237D    **                  push    ax
 237E    **                  call    MININT%
 2383    **                  mov     0CCh[bp],ax
 2386    **                  mov     bx,0D4h[bp]
 2389    **                  sal     bx,1
 238B    **                  sal     bx,1
                                                                      PAGE  91
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 238D    **                  sal     bx,1
 238F    **                  sal     bx,1
 2391    **                  sal     bx,1
 2393    **                  sal     bx,1
 2395    **                  mov     si,08h[bp]
 2398    **                  mov     dx,bx
 239A    **                  add     bx,0Ah[si]
 239D    **                  mov     es,02h[si]
 23A0    **                  add     bx,02h
 23A3    **                  mov     ax,0CEh[bp]
 23A6    **                  es:     
 23A7    **                  mov     [bx],ax
 23A9    **                  mov     ax,0CCh[bp]
 23AC    **                  mov     TOPROW%,ax
 23AF    **                  mov     bx,dx
 23B1    **                  add     bx,0Ah[si]
 23B4    **                  mov     es,02h[si]
 23B7    **                  add     bx,0Ah
 23BA    **                  es:     
 23BB    **                  cmp     word ptr [bx],11h
 23BE    **                  jne     $+03h
 23C0    **                  jmp     I00257
 23C3    **                  mov     bx,dx
 23C5    **                  add     bx,0Ah[si]
 23C8    **                  mov     es,02h[si]
 23CB    **                  add     bx,0Ah
 23CE    **                  es:     
 23CF    **                  cmp     word ptr [bx],18h
 23D2    **                  jne     $+03h
 23D4    **                  jmp     I00257
 23D7    **                  mov     bx,0D4h[bp]
 23DA    **                  sal     bx,1
 23DC    **                  sal     bx,1
 23DE    **                  mov     si,0Ah[bp]
 23E1    **                  mov     cx,bx
 23E3    **                  add     bx,0Ah[si]
 23E6    **                  mov     si,bx
 23E8    **                  mov     ax,[bx]
 23EA    **                  mov     0C6h[bp],ax
 23ED    **                  mov     bx,dx
 23EF    **                  mov     si,08h[bp]
 23F2    **                  add     bx,0Ah[si]
 23F5    **                  mov     es,02h[si]
 23F8    **                  add     bx,06h
 23FB    **                  es:     
 23FC    **                  mov     bx,[bx]
 23FE    **                  mov     0C4h[bp],bx
 2401    **                  mov     bx,dx
 2403    **                  add     bx,0Ah[si]
 2406    **                  mov     es,02h[si]
 2409    **                  add     bx,04h
 240C    **                  es:     
 240D    **                  mov     dx,[bx]
 240F    **                  mov     bx,0C4h[bp]
                                                                      PAGE  92
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2412    **                  sub     bx,dx
 2414    **                  inc     bx
 2415    **                  mov     0C2h[bp],bx
 2418    **                  cmp     bx,ax
 241A    **                  jng     I00258
 241C    **                  sub     bx,ax
 241E    **                  push    bx
 241F    **                  mov     0C0h[bp],cx
 2422    **                  call    B$SPAC
 2427    **                  push    ax
 2428    **                  lea     ax,0C8h[bp]
 242B    **                  push    ax
 242C    **                  call    B$SASS
 2431    **                  mov     si,0Ah[bp]
 2434    **                  mov     bx,0C0h[bp]
 2437    **                  mov     dx,bx
 2439    **                  add     bx,0Ah[si]
 243C    **                  push    bx
 243D    **                  mov     bx,dx
 243F    **                  mov     si,0Ah[bp]
 2442    **                  add     bx,0Ah[si]
 2445    **                  push    bx
 2446    **                  lea     ax,0C8h[bp]
 2449    **                  push    ax
 244A    **                  call    B$SACT
 244F    **                  jmp     I00259
 2452   016C                  Form$(N, 0) = LEFT$(Form$(N, 0), Temp2)
 2452   016C               END IF
 2452    **        I00258:   mov     ax,0C2h[bp]
 2455    **                  cmp     ax,0C6h[bp]
 2458    **                  jl      $+03h
 245A    **                  jmp     I00260
 245D    **                  mov     bx,0D4h[bp]
 2460    **                  sal     bx,1
 2462    **                  sal     bx,1
 2464    **                  mov     si,0Ah[bp]
 2467    **                  mov     dx,bx
 2469    **                  add     bx,0Ah[si]
 246C    **                  push    bx
 246D    **                  push    ax
 246E    **                  mov     0BAh[bp],dx
 2471    **                  call    B$LEFT
 2476    **                  push    ax
 2477    **                  lea     ax,0BCh[bp]
 247A    **                  push    ax
 247B    **                  call    B$SASS
 2480    **                  lea     ax,0BCh[bp]
 2483    **                  push    ax
 2484    **                  mov     si,0Ah[bp]
 2487    **                  mov     bx,0BAh[bp]
 248A    **                  add     bx,0Ah[si]
 248D    **                  push    bx
 248E    **                  call    B$SASS
 2493    **        I00259:
                                                                      PAGE  93
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2493   016C    
 2493   016C               SELECT CASE Fld(N).FType             'Check formatin
                g
 2493   016C                  CASE DateFld, EuroDateFld
 2493    **        I00260:   mov     bx,0D4h[bp]
 2496    **                  sal     bx,1
 2498    **                  sal     bx,1
 249A    **                  sal     bx,1
 249C    **                  sal     bx,1
 249E    **                  sal     bx,1
 24A0    **                  sal     bx,1
 24A2    **                  mov     si,08h[bp]
 24A5    **                  add     bx,0Ah[si]
 24A8    **                  mov     es,02h[si]
 24AB    **                  add     bx,0Ah
 24AE    **                  es:     
 24AF    **                  mov     ax,[bx]
 24B1    **                  mov     0B8h[bp],ax
 24B4    **                  cmp     word ptr 0B8h[bp],06h
 24B8    **                  je      I00261
 24BA    **                  cmp     word ptr 0B8h[bp],13h
 24BE    **                  je      $+03h
 24C0    **                  jmp     I00262
 24C3   016C                     MID$(Form$(N, 0), 3) = "-"
 24C3   016C                     MID$(Form$(N, 0), 6) = "-"
 24C3   016C                     IF MID$(Form$(N, 0), 7, 2) = "  " THEN
 24C3   016C                        MID$(Form$(N, 0), 7, 2) = "19"
 24C3   016C                     END IF
 24C3    **        I00261:   mov     bx,0D4h[bp]
 24C6    **                  sal     bx,1
 24C8    **                  sal     bx,1
 24CA    **                  mov     si,0Ah[bp]
 24CD    **                  mov     dx,bx
 24CF    **                  add     bx,0Ah[si]
 24D2    **                  push    ds
 24D3    **                  push    bx
 24D4    **                  xor     ax,ax
 24D6    **                  push    ax
 24D7    **                  push    offset <const>
 24DA    **                  push    7FFFh
 24DD    **                  push    03h
 24DF    **                  mov     0B2h[bp],dx
 24E2    **                  call    B$SMID
 24E7    **                  mov     si,0Ah[bp]
 24EA    **                  mov     bx,0B2h[bp]
 24ED    **                  mov     dx,bx
 24EF    **                  add     bx,0Ah[si]
 24F2    **                  push    ds
 24F3    **                  push    bx
 24F4    **                  xor     ax,ax
 24F6    **                  push    ax
 24F7    **                  push    offset <const>
 24FA    **                  push    7FFFh
 24FD    **                  push    06h
                                                                      PAGE  94
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 24FF    **                  call    B$SMID
 2504    **                  mov     si,0Ah[bp]
 2507    **                  mov     bx,0B2h[bp]
 250A    **                  mov     dx,bx
 250C    **                  add     bx,0Ah[si]
 250F    **                  push    bx
 2510    **                  push    07h
 2512    **                  push    02h
 2514    **                  call    B$FMID
 2519    **                  push    ax
 251A    **                  lea     ax,0B4h[bp]
 251D    **                  push    ax
 251E    **                  call    B$SASS
 2523    **                  lea     ax,0B4h[bp]
 2526    **                  push    ax
 2527    **                  push    offset <const>
 252A    **                  call    B$SCMP
 252F    **                  jne     I00263
 2531    **                  mov     si,0Ah[bp]
 2534    **                  mov     bx,0B2h[bp]
 2537    **                  add     bx,0Ah[si]
 253A    **                  push    ds
 253B    **                  push    bx
 253C    **                  xor     ax,ax
 253E    **                  push    ax
 253F    **                  push    offset <const>
 2542    **                  push    02h
 2544    **                  push    07h
 2546    **                  call    B$SMID
 254B   016C                  CASE PhoneFld
 254B    **        I00263:   jmp     I00264
 254E   016C                     MID$(Form$(N, 0), 1) = "("
 254E   016C                     MID$(Form$(N, 0), 5) = ")"
 254E   016C                     MID$(Form$(N, 0), 10) = "-"
 254E   016C                  CASE SoSecFld
 254E    **        I00262:   cmp     word ptr 0B8h[bp],07h
 2552    **                  jne     I00265
 2554    **                  mov     bx,0D4h[bp]
 2557    **                  sal     bx,1
 2559    **                  sal     bx,1
 255B    **                  mov     si,0Ah[bp]
 255E    **                  mov     dx,bx
 2560    **                  add     bx,0Ah[si]
 2563    **                  push    ds
 2564    **                  push    bx
 2565    **                  xor     ax,ax
 2567    **                  push    ax
 2568    **                  push    offset <const>
 256B    **                  push    7FFFh
 256E    **                  push    01h
 2570    **                  mov     0B0h[bp],dx
 2573    **                  call    B$SMID
 2578    **                  mov     si,0Ah[bp]
 257B    **                  mov     bx,0B0h[bp]
                                                                      PAGE  95
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 257E    **                  mov     dx,bx
 2580    **                  add     bx,0Ah[si]
 2583    **                  push    ds
 2584    **                  push    bx
 2585    **                  xor     ax,ax
 2587    **                  push    ax
 2588    **                  push    offset <const>
 258B    **                  push    7FFFh
 258E    **                  push    05h
 2590    **                  call    B$SMID
 2595    **                  mov     si,0Ah[bp]
 2598    **                  mov     bx,0B0h[bp]
 259B    **                  add     bx,0Ah[si]
 259E    **                  push    ds
 259F    **                  push    bx
 25A0    **                  xor     ax,ax
 25A2    **                  push    ax
 25A3    **                  push    offset <const>
 25A6    **                  push    7FFFh
 25A9    **                  push    0Ah
 25AB    **                  call    B$SMID
 25B0    **                  jmp     I00264
 25B3   016C                     MID$(Form$(N, 0), 4) = "-"
 25B3   016C                     MID$(Form$(N, 0), 7) = "-"
 25B3   016C                  CASE ZipFld
 25B3    **        I00265:   cmp     word ptr 0B8h[bp],08h
 25B7    **                  jne     I00266
 25B9    **                  mov     bx,0D4h[bp]
 25BC    **                  sal     bx,1
 25BE    **                  sal     bx,1
 25C0    **                  mov     si,0Ah[bp]
 25C3    **                  mov     dx,bx
 25C5    **                  add     bx,0Ah[si]
 25C8    **                  push    ds
 25C9    **                  push    bx
 25CA    **                  xor     ax,ax
 25CC    **                  push    ax
 25CD    **                  push    offset <const>
 25D0    **                  push    7FFFh
 25D3    **                  push    04h
 25D5    **                  mov     0AEh[bp],dx
 25D8    **                  call    B$SMID
 25DD    **                  mov     si,0Ah[bp]
 25E0    **                  mov     bx,0AEh[bp]
 25E3    **                  add     bx,0Ah[si]
 25E6    **                  push    ds
 25E7    **                  push    bx
 25E8    **                  xor     ax,ax
 25EA    **                  push    ax
 25EB    **                  push    offset <const>
 25EE    **                  push    7FFFh
 25F1    **                  push    07h
 25F3    **                  call    B$SMID
 25F8    **                  jmp     I00264
                                                                      PAGE  96
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 25FB   016C                     MID$(Form$(N, 0), 6) = "-"
 25FB   016C                  CASE ELSE
 25FB    **        I00266:   cmp     word ptr 0B8h[bp],09h
 25FF    **                  jne     I00267
 2601    **                  mov     bx,0D4h[bp]
 2604    **                  sal     bx,1
 2606    **                  sal     bx,1
 2608    **                  mov     si,0Ah[bp]
 260B    **                  add     bx,0Ah[si]
 260E    **                  push    ds
 260F    **                  push    bx
 2610    **                  xor     ax,ax
 2612    **                  push    ax
 2613    **                  push    offset <const>
 2616    **                  push    7FFFh
 2619    **                  push    06h
 261B    **                  call    B$SMID
 2620    **                  jmp     I00264
 2623   016C               END SELECT
 2623    **        I00267:
 2623   016C    
 2623   016C                                                    'Save field int
                o buffer
 2623   016C               SaveField N, Form$(), Fld(), BadFld
 2623    **        I00264:   lea     ax,0D4h[bp]
 2626    **                  push    ax
 2627    **                  push    0Ah[bp]
 262A    **                  push    08h[bp]
 262D    **                  lea     ax,0ACh[bp]
 2630    **                  push    ax
 2631    **                  call    SAVEFIELD
 2636   016C    
 2636   016C            END IF
 2636   016C    
 2636   016C        NEXT
 2636    **        I00257:   mov     ax,0D4h[bp]
 2639    **                  inc     ax
 263A    **        I00254:   mov     0D4h[bp],ax
 263D    **                  cmp     ax,0D6h[bp]
 2640    **                  jg      $+03h
 2642    **                  jmp     I00255
 2645   016C                                                    'Display the fi
                eld on form
 2645   016C        PrintArray Frm.StartEl + 1, EndOfForm, Form$(), Fld()
 2645    **                  mov     si,06h[bp]
 2648    **                  mov     ax,[si]
 264A    **                  inc     ax
 264B    **                  mov     0AAh[bp],ax
 264E    **                  lea     ax,0AAh[bp]
 2651    **                  push    ax
 2652    **                  push    offset ENDOFFORM%
 2655    **                  push    0Ah[bp]
 2658    **                  push    08h[bp]
 265B    **                  call    PRINTARRAY
                                                                      PAGE  97
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2660   016C    
 2660   016C    END SUB
 2660    **        I00250:   lea     ax,0B4h[bp]
 2663    **                  push    ax
 2664    **                  call    B$STDL
 2669    **                  lea     ax,0BCh[bp]
 266C    **                  push    ax
 266D    **                  call    B$STDL
 2672    **                  lea     ax,0C8h[bp]
 2675    **                  push    ax
 2676    **                  call    B$STDL
 267B    **                  lea     ax,0DAh[bp]
 267E    **                  push    ax
 267F    **                  call    B$STDL
 268C   016C    
 268C   016C    SUB FEPressButton (Fld AS FieldInfo)
 2684    **        I00249:   jmp     I00268
 26A5   016C    
 26A5   016C       Cols = Fld.RCol - Fld.LCol + 1
 26A5   016C       REDIM Btn(Cols)
 268F    **                  mov     ax,06h[bp]
 26A8    **                  add     ax,0006h
 26AB    **                  mov     si,ax
 26AD    **                  mov     cx,[si]
 26AF    **                  mov     dx,06h[bp]
 26B2    **                  add     dx,04h
 26B5    **                  mov     si,dx
 26B7    **                  sub     cx,[si]
 26B9    **                  inc     cx
 26BA    **                  mov     0DAh[bp],cx
 26BD    **                  push    00h
 26BF    **                  push    cx
 26C0    **                  push    02h
 26C2    **                  push    0101h
 26C5    **                  lea     ax,0DCh[bp]
 26C8    **                  push    ax
 26C9    **                  call    B$RDIM
 26CE   016C       MScrnSave Fld.Row, Fld.LCol, Fld.Row, Fld.RCol, Btn(1)
 26CE    **                  mov     ax,06h[bp]
 26D1    **                  add     ax,0002h
 26D4    **                  push    ax
 26D5    **                  mov     cx,06h[bp]
 26D8    **                  add     cx,04h
 26DB    **                  push    cx
 26DC    **                  push    ax
 26DD    **                  mov     ax,06h[bp]
 26E0    **                  add     ax,0006h
 26E3    **                  push    ax
 26E4    **                  lea     si,0DCh[bp]
 26E7    **                  mov     bx,0002h
 26EA    **                  add     bx,0Ah[si]
 26ED    **                  mov     es,02h[si]
 26F0    **                  push    es
 26F1    **                  push    bx
                                                                      PAGE  98
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 26F2    **                  call    MSCRNSAVE
 26F7   016C       
 26F7   016C    
 26F7   016C       MPaintBox Fld.Row, Fld.LCol, Fld.Row, Fld.RCol, 15
 26F7    **                  mov     0D8h[bp],000Fh
 26FC    **                  mov     ax,06h[bp]
 26FF    **                  add     ax,0002h
 2702    **                  push    ax
 2703    **                  mov     cx,06h[bp]
 2706    **                  add     cx,04h
 2709    **                  push    cx
 270A    **                  push    ax
 270B    **                  mov     ax,06h[bp]
 270E    **                  add     ax,0006h
 2711    **                  push    ax
 2712    **                  lea     ax,0D8h[bp]
 2715    **                  push    ax
 2716    **                  call    MPAINTBOX
 271B   016C    
 271B   016C       Pause 2
 271B    **                  mov     0D6h[bp],0002h
 2720    **                  lea     ax,0D6h[bp]
 2723    **                  push    ax
 2724    **                  call    PAUSE
 2729   016C       DO
 2729    **                  nop     
 272A   016C          Pause 2
 272A    **        I00270:   mov     0D4h[bp],0002h
 272F    **                  lea     ax,0D4h[bp]
 2732    **                  push    ax
 2733    **                  call    PAUSE
 2738   016C          GetCursor 0, 0, I
 2738    **                  mov     0D2h[bp],0000h
 273D    **                  mov     0D0h[bp],0000h
 2742    **                  lea     ax,0D2h[bp]
 2745    **                  push    ax
 2746    **                  lea     ax,0D0h[bp]
 2749    **                  push    ax
 274A    **                  lea     ax,0CEh[bp]
 274D    **                  push    ax
 274E    **                  call    GETCURSOR
 2753   016C       '   zz$ = INKEY$
 2753   016C          DO: LOOP WHILE LEN(zz$)
 2753    **                  nop     
 2754   016C       LOOP WHILE I
 2754   016C    
 2754   016C       MScrnRest Fld.Row, Fld.LCol, Fld.Row, Fld.RCol, Btn(1)
 2754    **        I00271:   mov     ax,0CAh[bp]
 2757    **                  and     ax,ax
 2759    **                  jne     I00271
 275B    **                  mov     ax,0CEh[bp]
 275E    **                  and     ax,ax
 2760    **                  jne     I00270
 2762    **                  mov     ax,06h[bp]
                                                                      PAGE  99
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2765    **                  add     ax,0002h
 2768    **                  push    ax
 2769    **                  mov     cx,06h[bp]
 276C    **                  add     cx,04h
 276F    **                  push    cx
 2770    **                  push    ax
 2771    **                  mov     ax,06h[bp]
 2774    **                  add     ax,0006h
 2777    **                  push    ax
 2778    **                  lea     si,0DCh[bp]
 277B    **                  mov     bx,0002h
 277E    **                  add     bx,0Ah[si]
 2781    **                  mov     es,02h[si]
 2784    **                  push    es
 2785    **                  push    bx
 2786    **                  call    MSCRNREST
 278B   016C    
 278B   016C    END SUB
 278B    **        I00269:   lea     ax,0DCh[bp]
 278E    **                  push    ax
 278F    **                  call    B$ERAS
 2794    **                  lea     ax,0CAh[bp]
 2797    **                  push    ax
 2798    **                  call    B$STDL
 27A5   016C    
 27A5   016C    SUB FESetupMult (Form$(), Fld() AS FieldInfo, Frm AS FormInfo, 
                Cnf AS Config)
 279D    **        I00268:   jmp     I00272
 27BE   016C        SHARED Work$()
 27BE   016C        SHARED Choice$()                            'Multiple choic
                e array
 27BE   016C        SHARED VertLen, VAction, Choice, ScrRows
 27BE   016C    
 27BE   016C        FOR C = 0 TO UBOUND(Choice$, 2)             'Find the array
                 column that
 27A8    **                  push    offset CHOICE$
 27C1    **                  push    02h
 27C3    **                  call    B$UBND
 27C8    **                  mov     0ECh[bp],ax
 27CB    **                  xor     ax,ax
 27CD    **                  jmp     I00274
 27D0   016C            N = 0                                   '  goes with th
                is field
 27D0   016C            DO
 27D0    **        I00275:   mov     0EAh[bp],0000h
 27D5    **                  nop     
 27D6   016C               IF VAL(MID$(Choice$(0, C), N + 1)) = Frm.FldNo THEN 
                EXIT FOR
 27D6    **        I00276:   mov     ax,CHOICE$+0012h
 27D9    **                  imul    0E4h[bp]
 27DC    **                  sal     ax,1
 27DE    **                  sal     ax,1
 27E0    **                  mov     bx,ax
 27E2    **                  mov     si,offset CHOICE$
                                                                      PAGE 100
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 27E5    **                  add     bx,0Ah[si]
 27E8    **                  push    bx
 27E9    **                  mov     ax,0EAh[bp]
 27EC    **                  inc     ax
 27ED    **                  push    ax
 27EE    **                  push    7FFFh
 27F1    **                  call    B$FMID
 27F6    **                  push    ax
 27F7    **                  lea     ax,0E6h[bp]
 27FA    **                  push    ax
 27FB    **                  call    B$SASS
 2800    **                  mov     ax,08h[bp]
 2803    **                  add     ax,0002h
 2806    **                  mov     si,ax
 2808    **                  int     3Bh
 280A    **                  db      04h
 280B    **                  lea     ax,0E6h[bp]
 280E    **                  push    ax
 280F    **                  call    B$FVAL
 2814    **                  mov     di,ax
 2816    **                  int     39h
 2818    **                  db      05h
 2819    **                  int     3Dh
 281B    **                  call    B$FCMP
 2820    **                  jne     $+03h
 2822    **                  jmp     I00278
 2825   016C               N = INSTR(N + 1, Choice$(0, C), ",")
 2825   016C            LOOP WHILE N
 2825   016C        NEXT
 2825    **                  mov     ax,0EAh[bp]
 2828    **                  inc     ax
 2829    **                  push    ax
 282A    **                  mov     ax,CHOICE$+0012h
 282D    **                  imul    0E4h[bp]
 2830    **                  sal     ax,1
 2832    **                  sal     ax,1
 2834    **                  mov     bx,ax
 2836    **                  mov     si,offset CHOICE$
 2839    **                  add     bx,0Ah[si]
 283C    **                  push    bx
 283D    **                  push    offset <const>
 2840    **                  call    B$INS3
 2845    **                  mov     0EAh[bp],ax
 2848    **                  and     ax,ax
 284A    **                  jne     I00276
 284C    **                  mov     ax,0E4h[bp]
 284F    **                  inc     ax
 2850    **        I00274:   mov     0E4h[bp],ax
 2853    **                  cmp     ax,0ECh[bp]
 2856    **                  jg      $+03h
 2858    **                  jmp     I00275
 285B   016C    
 285B   016C        IF C <= UBOUND(Choice$, 2) THEN             'If we found it
                , make a temp.
                                                                      PAGE 101
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 285B   016C           REDIM Work$(UBOUND(Choice$))             '  array to hol
                d choices
 285B    **        I00278:   push    offset CHOICE$
 285E    **                  push    02h
 2860    **                  call    B$UBND
 2865    **                  cmp     ax,0E4h[bp]
 2868    **                  jnl     $+03h
 286A    **                  jmp     I00279
 286D    **                  push    00h
 286F    **                  push    offset CHOICE$
 2872    **                  push    01h
 2874    **                  call    B$UBND
 2879    **                  push    ax
 287A    **                  push    04h
 287C    **                  push    8001h
 287F    **                  push    offset WORK$
 2882    **                  call    B$RDIM
 2887   016C           Temp$ = SPACE$(Fld(Frm.FldNo).StorLen)
 2887   016C           Choice = 1                               'Preset Choice 
                to 1
 2887   016C           Row = 0                                  'Init number of
                 rows
 2887   016C           VertLen = 0
 2887   016C           FOR N = 1 TO UBOUND(Choice$)             'Read choices i
                nto array
 2887    **                  mov     ax,08h[bp]
 288A    **                  add     ax,0002h
 288D    **                  mov     si,ax
 288F    **                  mov     bx,[si]
 2891    **                  sal     bx,1
 2893    **                  sal     bx,1
 2895    **                  sal     bx,1
 2897    **                  sal     bx,1
 2899    **                  sal     bx,1
 289B    **                  sal     bx,1
 289D    **                  mov     si,0Ah[bp]
 28A0    **                  add     bx,0Ah[si]
 28A3    **                  mov     es,02h[si]
 28A6    **                  add     bx,08h
 28A9    **                  es:     
 28AA    **                  push    [bx]
 28AC    **                  call    B$SPAC
 28B1    **                  push    ax
 28B2    **                  push    offset TEMP$
 28B5    **                  call    B$SASS
 28BA    **                  mov     CHOICE%,0001h
 28C0    **                  mov     0E0h[bp],0000h
 28C5    **                  mov     VERTLEN%,0000h
 28CB    **                  push    offset CHOICE$
 28CE    **                  push    01h
 28D0    **                  call    B$UBND
 28D5    **                  mov     0E2h[bp],ax
 28D8    **                  mov     ax,0001h
 28DB    **                  jmp     I00280
                                                                      PAGE 102
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 28DE   016C               IF LEN(Choice$(N, C)) THEN
 28DE   016C                  LSET Temp$ = Choice$(N, C)
 28DE   016C                                                    'If current $ m
                atches Choice $
 28DE   016C                  IF Temp$ = Form$(Frm.FldNo, 0) THEN Choice = N
 28DE    **        I00281:   mov     ax,CHOICE$+0012h
 28E1    **                  imul    0E4h[bp]
 28E4    **                  add     ax,0EAh[bp]
 28E7    **                  sal     ax,1
 28E9    **                  sal     ax,1
 28EB    **                  mov     bx,ax
 28ED    **                  mov     si,offset CHOICE$
 28F0    **                  add     bx,0Ah[si]
 28F3    **                  mov     di,bx
 28F5    **                  mov     cx,[bx]
 28F7    **                  and     cx,cx
 28F9    **                  jne     $+03h
 28FB    **                  jmp     I00282
 28FE    **                  mov     bx,ax
 2900    **                  add     bx,0Ah[si]
 2903    **                  push    bx
 2904    **                  push    ds
 2905    **                  push    offset TEMP$
 2908    **                  xor     ax,ax
 290A    **                  push    ax
 290B    **                  call    B$LSET
 2910    **                  mov     ax,08h[bp]
 2913    **                  add     ax,0002h
 2916    **                  mov     si,ax
 2918    **                  mov     bx,[si]
 291A    **                  sal     bx,1
 291C    **                  sal     bx,1
 291E    **                  mov     si,0Ch[bp]
 2921    **                  add     bx,0Ah[si]
 2924    **                  push    bx
 2925    **                  push    offset TEMP$
 2928    **                  call    B$SCMP
 292D    **                  jne     I00283
 292F    **                  mov     ax,0EAh[bp]
 2932    **                  mov     CHOICE%,ax
 2935   016C                  Work$(N) = Choice$(N, C)
 2935   016C                  VertLen = MaxInt(LEN(Work$(N)), VertLen)
 2935   016C                  Row = Row + 1                     'Bump number of
                 rows
 2935   016C               ELSE
 2935    **        I00283:   mov     ax,CHOICE$+0012h
 2938    **                  imul    0E4h[bp]
 293B    **                  add     ax,0EAh[bp]
 293E    **                  sal     ax,1
 2940    **                  sal     ax,1
 2942    **                  mov     bx,ax
 2944    **                  mov     si,offset CHOICE$
 2947    **                  add     bx,0Ah[si]
 294A    **                  push    bx
                                                                      PAGE 103
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 294B    **                  mov     bx,0EAh[bp]
 294E    **                  sal     bx,1
 2950    **                  sal     bx,1
 2952    **                  mov     si,offset WORK$
 2955    **                  mov     dx,bx
 2957    **                  add     bx,0Ah[si]
 295A    **                  push    bx
 295B    **                  mov     0DAh[bp],dx
 295E    **                  call    B$SASS
 2963    **                  mov     bx,0DAh[bp]
 2966    **                  add     bx,0Ah[si]
 2969    **                  push    bx
 296A    **                  call    B$FLEN
 296F    **                  mov     0DEh[bp],ax
 2972    **                  lea     ax,0DEh[bp]
 2975    **                  push    ax
 2976    **                  push    offset VERTLEN%
 2979    **                  call    MAXINT%
 297E    **                  mov     0DCh[bp],ax
 2981    **                  mov     ax,0DCh[bp]
 2984    **                  mov     VERTLEN%,ax
 2987    **                  inc     0E0h[bp]
 298A    **                  jmp     I00284
 298D   016C                  EXIT FOR
 298D   016C               END IF
 298D    **        I00282:   jmp     I00285
 2990   016C           NEXT
 2990    **        I00284:   mov     ax,0EAh[bp]
 2993    **                  inc     ax
 2994    **        I00280:   mov     0EAh[bp],ax
 2997    **                  cmp     ax,0E2h[bp]
 299A    **                  jg      $+03h
 299C    **                  jmp     I00281
 299F   016C           Temp$ = ""
 299F   016C           Frm.DoingMult = -1                       'Set Multiple c
                hoice flag
 299F   016C           VAction = 1                              'Set VertMenu's
                 Init. Flag
 299F   016C                                                    'Calc position 
                for menu
 299F   016C    
 299F   016C           IF Fld(Frm.FldNo).RCol + 1 > 80 - VertLen - 5 THEN
 299F   016C              C = 80 - VertLen - 7
 299F   016C              Rw = Fld(Frm.FldNo).Row + 1
 299F   016C           ELSE
 299F    **        I00285:   push    offset <const>
 29A2    **                  push    offset TEMP$
 29A5    **                  call    B$SASS
 29AA    **                  mov     ax,08h[bp]
 29AD    **                  add     ax,0014h
 29B0    **                  mov     si,ax
 29B2    **                  mov     [si],0FFFFh
 29B6    **                  mov     VACTION%,0001h
 29BC    **                  mov     ax,08h[bp]
                                                                      PAGE 104
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 29BF    **                  add     ax,0002h
 29C2    **                  mov     si,ax
 29C4    **                  mov     bx,[si]
 29C6    **                  sal     bx,1
 29C8    **                  sal     bx,1
 29CA    **                  sal     bx,1
 29CC    **                  sal     bx,1
 29CE    **                  sal     bx,1
 29D0    **                  sal     bx,1
 29D2    **                  mov     si,0Ah[bp]
 29D5    **                  mov     dx,bx
 29D7    **                  add     bx,0Ah[si]
 29DA    **                  mov     es,02h[si]
 29DD    **                  add     bx,06h
 29E0    **                  es:     
 29E1    **                  mov     ax,[bx]
 29E3    **                  inc     ax
 29E4    **                  mov     cx,0050h
 29E7    **                  sub     cx,VERTLEN%
 29EB    **                  mov     bx,cx
 29ED    **                  sub     cx,05h
 29F0    **                  cmp     ax,cx
 29F2    **                  jng     I00286
 29F4    **                  sub     bx,07h
 29F7    **                  mov     0E4h[bp],bx
 29FA    **                  mov     bx,dx
 29FC    **                  add     bx,0Ah[si]
 29FF    **                  mov     es,02h[si]
 2A02    **                  add     bx,02h
 2A05    **                  es:     
 2A06    **                  mov     ax,[bx]
 2A08    **                  inc     ax
 2A09    **                  mov     0D8h[bp],ax
 2A0C    **                  jmp     I00287
 2A0F   016C              C = Fld(Frm.FldNo).RCol + 1
 2A0F   016C              Rw = Fld(Frm.FldNo).Row
 2A0F   016C           END IF
 2A0F    **        I00286:   mov     ax,08h[bp]
 2A12    **                  add     ax,0002h
 2A15    **                  mov     si,ax
 2A17    **                  mov     bx,[si]
 2A19    **                  sal     bx,1
 2A1B    **                  sal     bx,1
 2A1D    **                  sal     bx,1
 2A1F    **                  sal     bx,1
 2A21    **                  sal     bx,1
 2A23    **                  sal     bx,1
 2A25    **                  mov     si,0Ah[bp]
 2A28    **                  mov     dx,bx
 2A2A    **                  add     bx,0Ah[si]
 2A2D    **                  mov     es,02h[si]
 2A30    **                  add     bx,06h
 2A33    **                  es:     
 2A34    **                  mov     ax,[bx]
                                                                      PAGE 105
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2A36    **                  inc     ax
 2A37    **                  mov     0E4h[bp],ax
 2A3A    **                  mov     bx,dx
 2A3C    **                  add     bx,0Ah[si]
 2A3F    **                  mov     es,02h[si]
 2A42    **                  add     bx,02h
 2A45    **                  es:     
 2A46    **                  mov     ax,[bx]
 2A48    **                  mov     0D8h[bp],ax
 2A4B   016C           IF Rw > ScrRows - 4 THEN
 2A4B   016C              Rw = MinInt(Rw, MaxInt(1, ScrRows - Row - 2))
 2A4B   016C           END IF
 2A4B    **        I00287:   mov     ax,SCRROWS%
 2A4E    **                  sub     ax,0004h
 2A51    **                  cmp     ax,0D8h[bp]
 2A54    **                  jnl     I00288
 2A56    **                  mov     0D6h[bp],0001h
 2A5B    **                  mov     ax,SCRROWS%
 2A5E    **                  sub     ax,0E0h[bp]
 2A61    **                  sub     ax,0002h
 2A64    **                  mov     0D4h[bp],ax
 2A67    **                  lea     ax,0D6h[bp]
 2A6A    **                  push    ax
 2A6B    **                  lea     ax,0D4h[bp]
 2A6E    **                  push    ax
 2A6F    **                  call    MAXINT%
 2A74    **                  mov     0D2h[bp],ax
 2A77    **                  lea     ax,0D8h[bp]
 2A7A    **                  push    ax
 2A7B    **                  lea     ax,0D2h[bp]
 2A7E    **                  push    ax
 2A7F    **                  call    MININT%
 2A84    **                  mov     0D0h[bp],ax
 2A87    **                  mov     ax,0D0h[bp]
 2A8A    **                  mov     0D8h[bp],ax
 2A8D   016C           LOCATE Rw, C, 0
 2A8D   016C    
 2A8D   016C        ELSE
 2A8D    **        I00288:   push    01h
 2A8F    **                  push    0D8h[bp]
 2A92    **                  push    01h
 2A94    **                  push    0E4h[bp]
 2A97    **                  push    01h
 2A99    **                  push    00h
 2A9B    **                  push    06h
 2A9D    **                  call    B$LOCT
 2AA2    **                  jmp     I00289
 2AA5   016C           Frm.FldNo = Frm.FldNo + 1                'Bump field num
                ber
 2AA5   016C        END IF
 2AA5    **        I00279:   mov     ax,08h[bp]
 2AA8    **                  add     ax,0002h
 2AAB    **                  mov     si,ax
 2AAD    **                  inc     [si]
                                                                      PAGE 106
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2AAF   016C    
 2AAF   016C    END SUB
 2AAF    **        I00289:
 2AAF    **        I00273:   lea     ax,0E6h[bp]
 2AB2    **                  push    ax
 2AB3    **                  call    B$STDL
 2AC0   016C    
 2AC0   016C    '----- Fixes improperly formatted date strings
 2AC0   016C    '
 2AC0   016C    SUB FixDate (Dat$) STATIC
 2AB8    **        I00272:   jmp     I00290
 2AD9   016C          
 2AD9   016C        Psn = 1                                     'Examine first 
                character
 2AD9   016C        DO                                          'Trim the numbe
                r part
 2AC3    **                  mov     PSN%,0001h
 2ADF    **                  nop     
 2AE0   016E           Temp$ = LTRIM$(RTRIM$(MID$(Dat$, Psn, 2)))
 2AE0   016E           IF LEN(Temp$) = 1 THEN                   'If it's only o
                ne character,
 2AE0   016E              MID$(Dat$, Psn) = "0" + Temp$         'Add a leading 
                0
 2AE0   016E           END IF
 2AE0    **        I00292:   push    06h[bp]
 2AE3    **                  push    PSN%
 2AE7    **                  push    02h
 2AE9    **                  call    B$FMID
 2AEE    **                  push    ax
 2AEF    **                  call    B$RTRM
 2AF4    **                  push    ax
 2AF5    **                  call    B$LTRM
 2AFA    **                  push    ax
 2AFB    **                  push    offset TEMP$
 2AFE    **                  call    B$SASS
 2B03    **                  cmp     word ptr TEMP$,01h
 2B08    **                  jne     I00293
 2B0A    **                  push    ds
 2B0B    **                  push    06h[bp]
 2B0E    **                  xor     ax,ax
 2B10    **                  push    ax
 2B11    **                  push    offset <const>
 2B14    **                  push    offset TEMP$
 2B17    **                  call    B$SCAT
 2B1C    **                  push    ax
 2B1D    **                  push    7FFFh
 2B20    **                  push    PSN%
 2B24    **                  call    B$SMID
 2B29   016E           MID$(Dat$, Psn + 2) = "-"                'Force "-" for 
                delimiter
 2B29   016E           Psn = Psn + 3                            'Set to next pa
                rt
 2B29   016E        LOOP UNTIL Psn > 4
 2B29   016E    
                                                                      PAGE 107
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2B29   016E        Temp$ = LTRIM$(RTRIM$(MID$(Dat$, 7)))       'Get the trimme
                d year part
 2B29   016E        IF LEN(Temp$) < 4 THEN                      'If its not 4 c
                haracters,
 2B29   016E           IF Temp$ <> "19" AND Temp$ <> "20" THEN  '  add century 
                to year
 2B29   016E              MID$(Dat$, 7) = "19" + Temp$
 2B29   016E           END IF
 2B29    **        I00293:   push    ds
 2B2A    **                  push    06h[bp]
 2B2D    **                  xor     ax,ax
 2B2F    **                  push    ax
 2B30    **                  push    offset <const>
 2B33    **                  push    7FFFh
 2B36    **                  mov     ax,PSN%
 2B39    **                  add     ax,0002h
 2B3C    **                  push    ax
 2B3D    **                  call    B$SMID
 2B42    **                  add     word ptr PSN%,03h
 2B47    **                  cmp     word ptr PSN%,04h
 2B4C    **                  jng     I00292
 2B4E    **                  push    06h[bp]
 2B51    **                  push    07h
 2B53    **                  push    7FFFh
 2B56    **                  call    B$FMID
 2B5B    **                  push    ax
 2B5C    **                  call    B$RTRM
 2B61    **                  push    ax
 2B62    **                  call    B$LTRM
 2B67    **                  push    ax
 2B68    **                  push    offset TEMP$
 2B6B    **                  call    B$SASS
 2B70    **                  cmp     word ptr TEMP$,04h
 2B75    **                  jl      $+03h
 2B77    **                  jmp     I00294
 2B7A    **                  push    offset TEMP$
 2B7D    **                  push    offset <const>
 2B80    **                  call    B$SCMP
 2B85    **                  je      I00295
 2B87    **                  push    offset TEMP$
 2B8A    **                  push    offset <const>
 2B8D    **                  call    B$SCMP
 2B92    **                  je      I00295
 2B94    **                  push    ds
 2B95    **                  push    06h[bp]
 2B98    **                  xor     ax,ax
 2B9A    **                  push    ax
 2B9B    **                  push    offset <const>
 2B9E    **                  push    offset TEMP$
 2BA1    **                  call    B$SCAT
 2BA6    **                  push    ax
 2BA7    **                  push    7FFFh
 2BAA    **                  push    07h
 2BAC    **                  call    B$SMID
                                                                      PAGE 108
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2BB1   016E        END IF
 2BB1    **        I00295:
 2BB1   016E        Temp$ = ""
 2BB1   016E    
 2BB1   016E    END SUB
 2BB1    **        I00294:   push    offset <const>
 2BB4    **                  push    offset TEMP$
 2BB7    **                  call    B$SASS
 2BBC    **        I00291:
 2BC4   016E    
 2BC4   016E    '----- Returns the field number for a given field name.
 2BC4   016E    '
 2BC4   016E    FUNCTION FldNum% (FldName$, Fld() AS FieldInfo) STATIC
 2BC4    **        I00290:   jmp     I00296
 2BDD   016E        
 2BDD   016E        IF LEN(Test$) = 0 THEN Test$ = SPACE$(8)
 2BC7    **                  cmp     word ptr TEST$,00h
 2BE2    **                  jne     I00298
 2BE4    **                  push    08h
 2BE6    **                  call    B$SPAC
 2BEB    **                  push    ax
 2BEC    **                  push    offset TEST$
 2BEF    **                  call    B$SASS
 2BF4   0172        LSET Test$ = UCASE$(FldName$)
 2BF4   0172    
 2BF4   0172        FOR N = 1 TO EndOfForms(Fld()) 'Fld(0).Fields
 2BF4    **        I00298:   push    08h[bp]
 2BF7    **                  call    B$UCAS
 2BFC    **                  push    ax
 2BFD    **                  push    ds
 2BFE    **                  push    offset TEST$
 2C01    **                  xor     ax,ax
 2C03    **                  push    ax
 2C04    **                  call    B$LSET
 2C09    **                  push    06h[bp]
 2C0C    **                  call    ENDOFFORMS%
 2C11    **                  mov     t0172%,ax
 2C14    **                  mov     ax,t0172%
 2C17    **                  mov     t0174%,ax
 2C1A    **                  mov     ax,0001h
 2C1D    **                  jmp     I00299
 2C20   0176           IF Fld(N).FldName = Test$ THEN EXIT FOR
 2C20    **        I00300:   sal     ax,1
 2C22    **                  sal     ax,1
 2C24    **                  sal     ax,1
 2C26    **                  sal     ax,1
 2C28    **                  sal     ax,1
 2C2A    **                  sal     ax,1
 2C2C    **                  mov     bx,ax
 2C2E    **                  mov     si,06h[bp]
 2C31    **                  add     bx,0Ah[si]
 2C34    **                  mov     es,02h[si]
 2C37    **                  add     bx,18h
 2C3A    **                  push    es
                                                                      PAGE 109
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2C3B    **                  push    bx
 2C3C    **                  mov     ax,0008h
 2C3F    **                  push    ax
 2C40    **                  call    B$LDFS
 2C45    **                  push    ax
 2C46    **                  push    offset TEST$
 2C49    **                  call    B$SCMP
 2C4E    **                  jne     $+03h
 2C50    **                  jmp     I00302
 2C53   0176        NEXT
 2C53    **                  mov     ax,N%
 2C56    **                  inc     ax
 2C57    **        I00299:   mov     N%,ax
 2C5A    **                  cmp     ax,t0174%
 2C5E    **                  jng     I00300
 2C60   0178    
 2C60   0178        IF N <= EndOfForms(Fld()) THEN 'Fld(0).Fields THEN
 2C60   0178           FldNum = N
 2C60   0178        ELSE
 2C60    **        I00302:   push    06h[bp]
 2C63    **                  call    ENDOFFORMS%
 2C68    **                  mov     t0178%,ax
 2C6B    **                  mov     ax,t0178%
 2C6E    **                  cmp     ax,N%
 2C72    **                  jl      I00303
 2C74    **                  mov     ax,N%
 2C77    **                  mov     FLDNUM%,ax
 2C7A    **                  jmp     I00304
 2C7D   017C           FldNum = 0
 2C7D   017C        END IF
 2C7D    **        I00303:   mov     FLDNUM%,0000h
 2C83   017C    
 2C83   017C    END FUNCTION
 2C83    **        I00304:
 2C83    **        I00297:   mov     ax,FLDNUM%
 2C8E   017C    
 2C8E   017C    '----- Formats a number into a "Field" string (Image$)
 2C8E   017C    '
 2C8E   017C    SUB Format (Float#, Fld AS FieldInfo, Image$) STATIC
 2C86    **        I00296:   jmp     I00305
 2CA7   017C    
 2CA7   017C        FType = Fld.FType                    'Get the field's type
 2CA7   017C        IF FType = Relational THEN FType = Fld.ScratchI
 2C91    **                  mov     ax,08h[bp]
 2CAA    **                  add     ax,000Ah
 2CAD    **                  mov     si,ax
 2CAF    **                  mov     cx,[si]
 2CB1    **                  mov     FTYPE%,cx
 2CB5    **                  cmp     cx,0Bh
 2CB8    **                  jne     I00307
 2CBA    **                  mov     ax,08h[bp]
 2CBD    **                  add     ax,0026h
 2CC0    **                  mov     si,ax
 2CC2    **                  mov     cx,[si]
                                                                      PAGE 110
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2CC4    **                  mov     FTYPE%,cx
 2CC8   017E                                                    'If places grea
                ter than -1
 2CC8   017E        IF Fld.Decimals > -1 THEN                   '  do formattin
                g
 2CC8   017E           EffLen = LEN(Image$)                     'Find effective
                 length
 2CC8   017E           LSET Image$ = STRING$(EffLen, "#")       'Fill field wit
                h "#"s
 2CC8   017E    
 2CC8   017E           IF Fld.Decimals THEN                     'If there are d
                ecimal places
 2CC8   017E              EffLen = EffLen - Fld.Decimals - 1    'Find place to 
                put ",."
 2CC8   017E                                                    'Put them in fi
                eld
 2CC8   017E              IF EffLen > 0 THEN MID$(Image$, EffLen) = ",."
 2CC8    **        I00307:   mov     ax,08h[bp]
 2CCB    **                  add     ax,0020h
 2CCE    **                  mov     si,ax
 2CD0    **                  cmp     word ptr [si],0FFh
 2CD3    **                  jg      $+03h
 2CD5    **                  jmp     I00308
 2CD8    **                  mov     di,06h[bp]
 2CDB    **                  mov     cx,[di]
 2CDD    **                  mov     EFFLEN%,cx
 2CE1    **                  push    cx
 2CE2    **                  push    offset <const>
 2CE5    **                  call    B$STRS
 2CEA    **                  push    ax
 2CEB    **                  push    ds
 2CEC    **                  push    06h[bp]
 2CEF    **                  xor     ax,ax
 2CF1    **                  push    ax
 2CF2    **                  call    B$LSET
 2CF7    **                  mov     ax,[si]
 2CF9    **                  and     ax,ax
 2CFB    **                  jne     $+03h
 2CFD    **                  jmp     I00309
 2D00    **                  sub     ax,EFFLEN%
 2D04    **                  neg     ax
 2D06    **                  dec     ax
 2D07    **                  mov     EFFLEN%,ax
 2D0A    **                  or      ax,ax
 2D0C    **                  jng     I00310
 2D0E    **                  push    ds
 2D0F    **                  push    06h[bp]
 2D12    **                  xor     ax,ax
 2D14    **                  push    ax
 2D15    **                  push    offset <const>
 2D18    **                  push    7FFFh
 2D1B    **                  push    EFFLEN%
 2D1F    **                  call    B$SMID
 2D24   0180           ELSE                                     'Otherwise
                                                                      PAGE 111
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2D24    **        I00310:   jmp     I00311
 2D27   0180                                                    '  put a "," at
                 end of string
 2D27   0180              IF EffLen > 0 THEN MID$(Image$, EffLen) = ","
 2D27    **        I00309:   cmp     word ptr EFFLEN%,00h
 2D2C    **                  jng     I00312
 2D2E    **                  push    ds
 2D2F    **                  push    06h[bp]
 2D32    **                  xor     ax,ax
 2D34    **                  push    ax
 2D35    **                  push    offset <const>
 2D38    **                  push    7FFFh
 2D3B    **                  push    EFFLEN%
 2D3F    **                  call    B$SMID
 2D44   0180           END IF
 2D44    **        I00312:
 2D44   0180    
 2D44   0180           IF FType = MoneyFld THEN MID$(Image$, 1) = "$$" 'If this
                 is a currency field,
 2D44    **        I00311:   cmp     word ptr FTYPE%,0Ah
 2D49    **                  jne     I00313
 2D4B    **                  push    ds
 2D4C    **                  push    06h[bp]
 2D4F    **                  xor     ax,ax
 2D51    **                  push    ax
 2D52    **                  push    offset <const>
 2D55    **                  push    7FFFh
 2D58    **                  push    01h
 2D5A    **                  call    B$SMID
 2D5F   0180                                                    '  put "$$" at 
                beginning
 2D5F   0180           LSET Image$ = FUsing$(STR$(Float#), Image$)'Format the n
                umber into the
 2D5F   0180                                                    '  field
 2D5F   0180           IF FType = MoneyFld THEN
 2D5F   0180              IF INSTR(Fld.ScratchS, "$") = 0 THEN
 2D5F   0180                 Temp$ = QPRTrim$(Fld.ScratchS)
 2D5F   0180                 D = INSTR(Image$, "$")
 2D5F   0180                 P = D - LEN(Temp$) + 1
 2D5F   0180                 IF LEN(Temp$) > 1 THEN
 2D5F   0180                    Temp$ = Temp$ + " "
 2D5F   0180                    P = P - 1
 2D5F   0180                 END IF
 2D5F    **        I00313:   mov     si,0Ah[bp]
 2D62    **                  mov     bx,si
 2D64    **                  push    06h[bx]
 2D67    **                  push    04h[bx]
 2D6A    **                  push    02h[bx]
 2D6D    **                  push    [bx]
 2D6F    **                  call    B$STR8
 2D74    **                  push    ax
 2D75    **                  push    offset t0180$
 2D78    **                  call    B$SASS
 2D7D    **                  push    offset t0180$
                                                                      PAGE 112
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2D80    **                  push    06h[bp]
 2D83    **                  call    FUSING$
 2D88    **                  push    ax
 2D89    **                  push    offset t0184$
 2D8C    **                  call    B$SASS
 2D91    **                  push    offset t0180$
 2D94    **                  call    B$STDL
 2D99    **                  push    offset t0184$
 2D9C    **                  push    ds
 2D9D    **                  push    06h[bp]
 2DA0    **                  xor     ax,ax
 2DA2    **                  push    ax
 2DA3    **                  call    B$LSET
 2DA8    **                  cmp     word ptr FTYPE%,0Ah
 2DAD    **                  je      $+03h
 2DAF    **                  jmp     I00314
 2DB2    **                  mov     ax,08h[bp]
 2DB5    **                  add     ax,0038h
 2DB8    **                  push    ds
 2DB9    **                  push    ax
 2DBA    **                  mov     bx,ax
 2DBC    **                  mov     ax,0008h
 2DBF    **                  push    ax
 2DC0    **                  mov     0ECh[bp],bx
 2DC3    **                  call    B$LDFS
 2DC8    **                  push    ax
 2DC9    **                  push    offset <const>
 2DCC    **                  call    B$INS2
 2DD1    **                  or      ax,ax
 2DD3    **                  je      $+03h
 2DD5    **                  jmp     I00315
 2DD8    **                  push    ds
 2DD9    **                  push    0ECh[bp]
 2DDC    **                  mov     ax,0008h
 2DDF    **                  push    ax
 2DE0    **                  call    B$LDFS
 2DE5    **                  push    ax
 2DE6    **                  push    offset t0188$
 2DE9    **                  call    B$SASS
 2DEE    **                  push    offset t0188$
 2DF1    **                  call    QPRTRIM$
 2DF6    **                  push    ax
 2DF7    **                  push    offset t018C$
 2DFA    **                  call    B$SASS
 2DFF    **                  push    ds
 2E00    **                  push    offset t0188$
 2E03    **                  xor     ax,ax
 2E05    **                  push    ax
 2E06    **                  mov     ax,08h[bp]
 2E09    **                  add     ax,0038h
 2E0C    **                  push    ds
 2E0D    **                  push    ax
 2E0E    **                  mov     ax,0008h
 2E11    **                  push    ax
                                                                      PAGE 113
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2E12    **                  call    B$ASSN
 2E17    **                  push    offset t0188$
 2E1A    **                  call    B$STDL
 2E1F    **                  push    offset t018C$
 2E22    **                  push    offset TEMP$
 2E25    **                  call    B$SASS
 2E2A    **                  push    06h[bp]
 2E2D    **                  push    offset <const>
 2E30    **                  call    B$INS2
 2E35    **                  mov     D%,ax
 2E38    **                  sub     ax,TEMP$
 2E3C    **                  inc     ax
 2E3D    **                  mov     P%,ax
 2E40    **                  cmp     word ptr TEMP$,01h
 2E45    **                  jng     I00316
 2E47    **                  push    offset TEMP$
 2E4A    **                  push    offset TEMP$
 2E4D    **                  push    offset <const>
 2E50    **                  call    B$SACT
 2E55    **                  dec     P%
 2E59   0194                 P = MaxInt(1, P)
 2E59   0194                 MID$(Image$, P, D) = Temp$
 2E59   0194              END IF
 2E59    **        I00316:   mov     t0194%,0001h
 2E5F    **                  push    offset t0194%
 2E62    **                  push    offset P%
 2E65    **                  call    MAXINT%
 2E6A    **                  mov     t0196%,ax
 2E6D    **                  mov     ax,t0196%
 2E70    **                  mov     P%,ax
 2E73    **                  push    ds
 2E74    **                  push    06h[bp]
 2E77    **                  xor     ax,ax
 2E79    **                  push    ax
 2E7A    **                  push    offset TEMP$
 2E7D    **                  push    D%
 2E81    **                  push    P%
 2E85    **                  call    B$SMID
 2E8A   0198           END IF
 2E8A    **        I00315:
 2E8A   0198    
 2E8A   0198        ELSE                                        'Otherwise let 
                basic make the
 2E8A    **        I00314:   jmp     I00317
 2E8D   0198           RSET Image$ = LTRIM$(STR$(Float#))       '  string
 2E8D   0198        END IF
 2E8D    **        I00308:   mov     si,0Ah[bp]
 2E90    **                  mov     bx,si
 2E92    **                  push    06h[bx]
 2E95    **                  push    04h[bx]
 2E98    **                  push    02h[bx]
 2E9B    **                  push    [bx]
 2E9D    **                  call    B$STR8
 2EA2    **                  push    ax
                                                                      PAGE 114
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2EA3    **                  call    B$LTRM
 2EA8    **                  push    ax
 2EA9    **                  push    ds
 2EAA    **                  push    06h[bp]
 2EAD    **                  xor     ax,ax
 2EAF    **                  push    ax
 2EB0    **                  call    B$RSET
 2EB5   0198    
 2EB5   0198    END SUB
 2EB5    **        I00317:
 2EB5    **        I00306:   push    offset t0188$
 2EB8    **                  call    B$STDL
 2EBD    **                  push    offset t018C$
 2EC0    **                  call    B$STDL
 2EC5    **                  push    offset t0180$
 2EC8    **                  call    B$STDL
 2ECD    **                  push    offset t0184$
 2ED0    **                  call    B$STDL
 2EDD   0198    
 2EDD   0198    '----- Displayes or clears a message within a box on screen
 2EDD   0198    '
 2EDD   0198    SUB Message (Msg$) STATIC
 2ED5    **        I00305:   jmp     I00318
 2EF6   0198    
 2EF6   0198        IF LEN(Msg$) THEN                           'If the message
                 isn't null
 2EF6   0198                                                    'Are we using c
                olor or mono
 2EF6   0198           IF ABS(Peek1%(0, &H463) = &HB4 OR INSTR(COMMAND$, "/B"))
                 THEN
 2EF6   0198              FrameClr = 112                        'Monochrome col
                ors
 2EF6   0198              TextClr = 112
 2EF6   0198           ELSE                                     'Color monitor
 2EE0    **                  mov     si,06h[bp]
 2EF9    **                  mov     ax,[si]
 2EFB    **                  and     ax,ax
 2EFD    **                  jne     $+03h
 2EFF    **                  jmp     I00320
 2F02    **                  mov     t0198%,0000h
 2F08    **                  mov     t019A%,0463h
 2F0E    **                  push    offset t0198%
 2F11    **                  push    offset t019A%
 2F14    **                  call    PEEK1%
 2F19    **                  mov     t019C%,ax
 2F1C    **                  cmp     t019C%,00B4h
 2F22    **                  mov     ax,0000h
 2F25    **                  jne     $+01h
 2F27    **                  dec     ax
 2F28    **                  mov     0ECh[bp],ax
 2F2B    **                  call    B$FCMD
 2F30    **                  push    ax
 2F31    **                  push    offset <const>
 2F34    **                  call    B$INS2
                                                                      PAGE 115
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2F39    **                  or      ax,0ECh[bp]
 2F3C    **                  cwd     
 2F3D    **                  xor     ax,dx
 2F3F    **                  sub     ax,dx
 2F41    **                  and     ax,ax
 2F43    **                  je      I00321
 2F45    **                  mov     FRAMECLR%,0070h
 2F4B    **                  mov     TEXTCLR%,0070h
 2F51    **                  jmp     I00322
 2F54   01A2              FrameClr = 49
 2F54   01A2              TextClr = 48
 2F54   01A2           END IF
 2F54    **        I00321:   mov     FRAMECLR%,0031h
 2F5A    **                  mov     TEXTCLR%,0030h
 2F60   01A2    
 2F60   01A2           Row = CSRLIN + 1                         'Save the Row
 2F60   01A2    
 2F60   01A2           REDIM MArray$(4)                         'Make a tempora
                ry array to
 2F60    **        I00322:   call    B$CSRL
 2F65    **                  inc     ax
 2F66    **                  mov     ROW%,ax
 2F69    **                  push    00h
 2F6B    **                  push    04h
 2F6D    **                  push    04h
 2F6F    **                  push    8001h
 2F72    **                  push    offset MARRAY$
 2F75    **                  call    B$RDIM
 2F7A   01B6                                                    '  hold the par
                sed up lines
 2F7A   01B6           MesLen = LEN(Msg$)                       'Get the total 
                length of the
 2F7A   01B6           Wdth = MinInt(64, MesLen)
 2F7A   01B6                                                    '  help message
 2F7A   01B6           Ln = 0                                   'Line number
 2F7A   01B6           Strt = 1                                 'Starting parse
                 position
 2F7A   01B6           '*** Parse the message into lines
 2F7A   01B6           DO
 2F7A    **                  mov     si,06h[bp]
 2F7D    **                  mov     ax,[si]
 2F7F    **                  mov     MESLEN%,ax
 2F82    **                  mov     t01B8%,0040h
 2F88    **                  push    offset t01B8%
 2F8B    **                  push    offset MESLEN%
 2F8E    **                  call    MININT%
 2F93    **                  mov     t01BA%,ax
 2F96    **                  mov     ax,t01BA%
 2F99    **                  mov     WDTH%,ax
 2F9C    **                  mov     LN%,0000h
 2FA2    **                  mov     STRT%,0001h
 2FA8   01C2               Nd = Strt + Wdth                     'Guess at the e
                nd of line
 2FA8   01C2    
                                                                      PAGE 116
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 2FA8   01C2               CR = INSTR(Strt, Msg$, CHR$(13))     'Look for Chr$(
                13)
 2FA8   01C2               IF CR > 0 AND CR < Nd THEN           'Chop line off
 2FA8   01C2                  Nd = CR
 2FA8   01C2               ELSE                                 'Loop backwards
                 to find
 2FA8    **        I00323:   mov     ax,WDTH%
 2FAB    **                  add     ax,STRT%
 2FAF    **                  mov     ND%,ax
 2FB2    **                  push    STRT%
 2FB6    **                  push    06h[bp]
 2FB9    **                  push    0Dh
 2FBB    **                  call    B$FCHR
 2FC0    **                  push    ax
 2FC1    **                  call    B$INS3
 2FC6    **                  mov     CR%,ax
 2FC9    **                  or      ax,ax
 2FCB    **                  jng     I00324
 2FCD    **                  cmp     ax,ND%
 2FD1    **                  jnl     I00324
 2FD3    **                  mov     ND%,ax
 2FD6    **                  jmp     I00325
 2FD9   01C6                  WHILE MID$(Msg$, Nd, 1) <> " " AND Nd < MesLen AN
                D Nd > Strt
 2FD9    **        I00324:   nop     
 2FDA   01C6                      Nd = Nd - 1                   '  blank space
 2FDA   01C6                  WEND
 2FDA    **        I00326:   push    06h[bp]
 2FDD    **                  push    ND%
 2FE1    **                  push    01h
 2FE3    **                  call    B$FMID
 2FE8    **                  push    ax
 2FE9    **                  push    offset <const>
 2FEC    **                  call    B$SCMP
 2FF1    **                  je      I00327
 2FF3    **                  mov     ax,MESLEN%
 2FF6    **                  cmp     ax,ND%
 2FFA    **                  jng     I00327
 2FFC    **                  mov     ax,STRT%
 2FFF    **                  cmp     ax,ND%
 3003    **                  jnl     I00327
 3005    **                  dec     ND%
 3009    **                  jmp     I00326
 300B    **                  nop     
 300C   01C6               END IF
 300C    **        I00327:
 300C   01C6    
 300C   01C6               Ln = Ln + 1                          'Increment the 
                Line number
 300C   01C6                                                    'Pull out the n
                ew line
 300C   01C6               MArray$(Ln) = MID$(Msg$, Strt, Nd - Strt)
 300C   01C6               Strt = Nd + 1                        'Reset starting
                 posit. for
                                                                      PAGE 117
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 300C   01C6                                                    '  next line
 300C   01C6           LOOP UNTIL Nd >= MesLen                  'Get more unles
                s @ end of mes
 300C   01C6    
 300C   01C6           Wdth = 0
 300C   01C6           FOR N = 1 TO Ln
 300C    **        I00325:   inc     LN%
 3010    **                  push    06h[bp]
 3013    **                  push    STRT%
 3017    **                  mov     ax,ND%
 301A    **                  sub     ax,STRT%
 301E    **                  push    ax
 301F    **                  call    B$FMID
 3024    **                  push    ax
 3025    **                  push    offset t01C6$
 3028    **                  call    B$SASS
 302D    **                  push    offset t01C6$
 3030    **                  mov     bx,LN%
 3034    **                  sal     bx,1
 3036    **                  sal     bx,1
 3038    **                  mov     si,offset MARRAY$
 303B    **                  add     bx,0Ah[si]
 303E    **                  push    bx
 303F    **                  call    B$SASS
 3044    **                  mov     ax,ND%
 3047    **                  inc     ax
 3048    **                  mov     STRT%,ax
 304B    **                  mov     ax,MESLEN%
 304E    **                  cmp     ax,ND%
 3052    **                  jng     $+03h
 3054    **                  jmp     I00323
 3057    **                  mov     WDTH%,0000h
 305D    **                  mov     ax,LN%
 3060    **                  mov     t01CA%,ax
 3063    **                  mov     ax,0001h
 3066    **                  jmp     I00328
 3069    **                  nop     
 306A   01CC               Wdth = MaxInt(Wdth, LEN(MArray$(N)))
 306A   01CC           NEXT
 306A    **        I00329:   sal     ax,1
 306C    **                  sal     ax,1
 306E    **                  mov     bx,ax
 3070    **                  mov     si,offset MARRAY$
 3073    **                  add     bx,0Ah[si]
 3076    **                  push    bx
 3077    **                  call    B$FLEN
 307C    **                  mov     t01CC%,ax
 307F    **                  push    offset WDTH%
 3082    **                  push    offset t01CC%
 3085    **                  call    MAXINT%
 308A    **                  mov     t01CE%,ax
 308D    **                  mov     ax,t01CE%
 3090    **                  mov     WDTH%,ax
 3093    **                  mov     ax,N%
                                                                      PAGE 118
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3096    **                  inc     ax
 3097    **        I00328:   mov     N%,ax
 309A    **                  cmp     ax,t01CA%
 309E    **                  jng     I00329
 30A0   01D2    
 30A0   01D2           GetVMode 0, 0, 0, Rows, 0
 30A0    **                  mov     t01D2%,0000h
 30A6    **                  mov     t01D4%,0000h
 30AC    **                  mov     t01D6%,0000h
 30B2    **                  mov     t01D8%,0000h
 30B8    **                  push    offset t01D2%
 30BB    **                  push    offset t01D4%
 30BE    **                  push    offset t01D6%
 30C1    **                  push    offset ROWS%
 30C4    **                  push    offset t01D8%
 30C7    **                  call    GETVMODE
 30CC   01DC           BotRow = Row + Ln + 1                    'Find the botto
                m row #
 30CC   01DC           IF BotRow >= Rows THEN
 30CC   01DC              Row = Row - Ln - 4
 30CC   01DC              BotRow = Row + Ln + 1
 30CC   01DC           END IF
 30CC    **                  mov     ax,LN%
 30CF    **                  add     ax,ROW%
 30D3    **                  inc     ax
 30D4    **                  mov     BOTROW%,ax
 30D7    **                  cmp     ax,ROWS%
 30DB    **                  jl      I00330
 30DD    **                  mov     ax,ROW%
 30E0    **                  sub     ax,LN%
 30E4    **                  sub     ax,0004h
 30E7    **                  mov     ROW%,ax
 30EA    **                  add     ax,LN%
 30EE    **                  inc     ax
 30EF    **                  mov     BOTROW%,ax
 30F2   01DE    
 30F2   01DE           BoxWdth = Wdth + 2                       'Find the outer
                 box width
 30F2   01DE           ColPos = 40 - (BoxWdth \ 2)              'Starting posit
                ion for
 30F2   01DE                                                    '   centered bo
                x
 30F2   01DE           ArraySize = (BoxWdth + 2) * (BotRow - Row + 2)'Find the 
                array size to use
 30F2   01DE           REDIM ScrBuf(ArraySize)                  '  for the back
                ground screen
 30F2    **        I00330:   mov     ax,WDTH%
 30F5    **                  add     ax,0002h
 30F8    **                  mov     BOXWDTH%,ax
 30FB    **                  mov     cx,0002h
 30FE    **                  cwd     
 30FF    **                  idiv    cx
 3101    **                  sub     ax,0028h
 3104    **                  neg     ax
                                                                      PAGE 119
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3106    **                  mov     COLPOS%,ax
 3109    **                  add     cx,BOXWDTH%
 310D    **                  mov     ax,cx
 310F    **                  mov     dx,BOTROW%
 3113    **                  sub     dx,ROW%
 3117    **                  add     dx,02h
 311A    **                  imul    dx
 311C    **                  mov     ARRAYSIZE%,ax
 311F    **                  push    00h
 3121    **                  push    ax
 3122    **                  push    02h
 3124    **                  push    0101h
 3127    **                  push    offset SCRBUF%
 312A    **                  call    B$RDIM
 312F   01F6           MScrnSave Row, ColPos, BotRow + 1, ColPos + BoxWdth + 1,
                 ScrBuf(0)
 312F    **                  mov     ax,BOTROW%
 3132    **                  inc     ax
 3133    **                  mov     t01F6%,ax
 3136    **                  mov     ax,BOXWDTH%
 3139    **                  add     ax,COLPOS%
 313D    **                  inc     ax
 313E    **                  mov     t01F8%,ax
 3141    **                  push    offset ROW%
 3144    **                  push    offset COLPOS%
 3147    **                  push    offset t01F6%
 314A    **                  push    offset t01F8%
 314D    **                  mov     si,offset SCRBUF%
 3150    **                  xor     bx,bx
 3152    **                  add     bx,0Ah[si]
 3155    **                  mov     es,02h[si]
 3158    **                  push    es
 3159    **                  push    bx
 315A    **                  call    MSCRNSAVE
 315F   01FA           HideCursor
 315F    **                  call    HIDECURSOR
 3164   01FA           Box0 Row, ColPos, BotRow, ColPos + BoxWdth - 1, 1, Frame
                Clr
 3164    **                  mov     ax,BOXWDTH%
 3167    **                  add     ax,COLPOS%
 316B    **                  dec     ax
 316C    **                  mov     t01FA%,ax
 316F    **                  mov     t01FC%,0001h
 3175    **                  push    offset ROW%
 3178    **                  push    offset COLPOS%
 317B    **                  push    offset BOTROW%
 317E    **                  push    offset t01FA%
 3181    **                  push    offset t01FC%
 3184    **                  push    offset FRAMECLR%
 3187    **                  call    BOX0
 318C   01FE    
 318C   01FE           LOCATE Row + 1, ColPos + 1
 318C   01FE           APrint0 VARPTR(MArray$(1)), Ln, 1, Wdth, TextClr
 318C    **                  push    01h
                                                                      PAGE 120
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 318E    **                  mov     ax,ROW%
 3191    **                  inc     ax
 3192    **                  push    ax
 3193    **                  push    01h
 3195    **                  mov     ax,COLPOS%
 3198    **                  inc     ax
 3199    **                  push    ax
 319A    **                  push    04h
 319C    **                  call    B$LOCT
 31A1    **                  mov     t01FE%,0001h
 31A7    **                  mov     si,offset MARRAY$
 31AA    **                  mov     bx,0004h
 31AD    **                  add     bx,0Ah[si]
 31B0    **                  mov     ax,bx
 31B2    **                  push    ax
 31B3    **                  push    offset LN%
 31B6    **                  push    offset t01FE%
 31B9    **                  push    offset WDTH%
 31BC    **                  push    offset TEXTCLR%
 31BF    **                  call    APRINT0
 31C4   0200           ShowCursor
 31C4    **                  call    SHOWCURSOR
 31C9   0200    
 31C9   0200           MPaintBox Row + 1, ColPos + BoxWdth, N + Row, ColPos + B
                oxWdth + 1, 8
 31C9    **                  mov     ax,ROW%
 31CC    **                  inc     ax
 31CD    **                  mov     t0200%,ax
 31D0    **                  mov     ax,BOXWDTH%
 31D3    **                  add     ax,COLPOS%
 31D7    **                  mov     t0202%,ax
 31DA    **                  mov     cx,ROW%
 31DE    **                  add     cx,N%
 31E2    **                  mov     t0204%,cx
 31E6    **                  inc     ax
 31E7    **                  mov     t0206%,ax
 31EA    **                  mov     t0208%,0008h
 31F0    **                  push    offset t0200%
 31F3    **                  push    offset t0202%
 31F6    **                  push    offset t0204%
 31F9    **                  push    offset t0206%
 31FC    **                  push    offset t0208%
 31FF    **                  call    MPAINTBOX
 3204   020A           MPaintBox N + Row + 1, ColPos + 2, N + Row + 1, ColPos +
                 BoxWdth + 1, 8
 3204    **                  mov     ax,ROW%
 3207    **                  add     ax,N%
 320B    **                  inc     ax
 320C    **                  mov     t020A%,ax
 320F    **                  mov     cx,COLPOS%
 3213    **                  add     cx,02h
 3216    **                  mov     t020C%,cx
 321A    **                  mov     t020E%,ax
 321D    **                  mov     ax,BOXWDTH%
                                                                      PAGE 121
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3220    **                  add     ax,COLPOS%
 3224    **                  inc     ax
 3225    **                  mov     t0210%,ax
 3228    **                  mov     t0212%,0008h
 322E    **                  push    offset t020A%
 3231    **                  push    offset t020C%
 3234    **                  push    offset t020E%
 3237    **                  push    offset t0210%
 323A    **                  push    offset t0212%
 323D    **                  call    MPAINTBOX
 3242   0214    
 3242   0214           Pass = 1                                 'Set flag say w
                e've been here
 3242   0214           ERASE MArray$                            'Don't need thi
                s anymore
 3242    **                  mov     PASS%,0001h
 3248    **                  push    offset MARRAY$
 324B    **                  call    B$ERAS
 3250   0216    
 3250   0216        ELSEIF Pass = 1 THEN                        'If we've been 
                here before,
 3250    **                  jmp     I00331
 3253   0216                                                    '  restore the 
                screen
 3253   0216           MScrnRest Row, ColPos, BotRow + 1, ColPos + BoxWdth + 1,
                 ScrBuf(0)
 3253    **        I00320:   cmp     word ptr PASS%,01h
 3258    **                  je      $+03h
 325A    **                  jmp     I00332
 325D    **                  mov     ax,BOTROW%
 3260    **                  inc     ax
 3261    **                  mov     t0216%,ax
 3264    **                  mov     ax,BOXWDTH%
 3267    **                  add     ax,COLPOS%
 326B    **                  inc     ax
 326C    **                  mov     t0218%,ax
 326F    **                  push    offset ROW%
 3272    **                  push    offset COLPOS%
 3275    **                  push    offset t0216%
 3278    **                  push    offset t0218%
 327B    **                  mov     si,offset SCRBUF%
 327E    **                  xor     bx,bx
 3280    **                  add     bx,0Ah[si]
 3283    **                  mov     es,02h[si]
 3286    **                  push    es
 3287    **                  push    bx
 3288    **                  call    MSCRNREST
 328D   021A           ERASE ScrBuf                             'Clean up memor
                y
 328D    **                  push    offset SCRBUF%
 3290    **                  call    B$ERAS
 3295   021A           Pass = 0                                 'Reset flag for
                 next call
 3295   021A        END IF
                                                                      PAGE 122
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3295    **                  mov     PASS%,0000h
 329B    **        I00331:
 329B   021A    
 329B   021A    END SUB
 329B    **        I00332:
 329B    **        I00319:   push    offset t01C6$
 329E    **                  call    B$STDL
 32AB   021A    
 32AB   021A    '**************************************************************
                **************
 32AB   021A    'Prints the contents of fields on the screen form.  This routin
                e is used
 32AB   021A    'internally by [EditForm] but can be called from your program t
                o force a
 32AB   021A    'redisplay after altering any data.
 32AB   021A    '
 32AB   021A    'FirstFld is the first field number to print.
 32AB   021A    '
 32AB   021A    'LastFld is the last field to print.  These two parameters are 
                used to
 32AB   021A    '  specify a range of fields to print.
 32AB   021A    '
 32AB   021A    'Form$() is the form data array containing the text of all fiel
                ds.
 32AB   021A    '
 32AB   021A    'Fld() is the field definition TYPE array.
 32AB   021A    '**************************************************************
                **************
 32AB   021A    '
 32AB   021A    SUB PrintArray (FirstFld, LastFld, Form$(), Fld() AS FieldInfo)
                 STATIC
 32A3    **        I00318:   jmp     I00333
 32C4   021A    
 32C4   021A    '    SHARED Ed AS EditInfo, Instate
 32C4   021A        SHARED Instate
 32C4   021A    
 32C4   021A        LOCATE , , 0                                'Turn the curso
                r off
 32C4   021A    
 32C4   021A        FirstFld = MaxInt(1, FirstFld)              'Make sure firs
                t and last are
 32C4   021A        IF LastFld = 0 THEN LastFld = EndOfForms%(Fld()) '  set
 32AE    **                  push    00h
 32C6    **                  push    00h
 32C8    **                  push    01h
 32CA    **                  push    00h
 32CC    **                  push    04h
 32CE    **                  call    B$LOCT
 32D3    **                  mov     t021A%,0001h
 32D9    **                  push    offset t021A%
 32DC    **                  push    0Ch[bp]
 32DF    **                  call    MAXINT%
 32E4    **                  mov     t021C%,ax
 32E7    **                  mov     ax,t021C%
                                                                      PAGE 123
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 32EA    **                  mov     si,0Ch[bp]
 32ED    **                  mov     [si],ax
 32EF    **                  mov     si,0Ah[bp]
 32F2    **                  cmp     word ptr [si],00h
 32F5    **                  jne     I00335
 32F7    **                  push    06h[bp]
 32FA    **                  call    ENDOFFORMS%
 32FF    **                  mov     t021E%,ax
 3302    **                  mov     ax,t021E%
 3305    **                  mov     si,0Ah[bp]
 3308    **                  mov     [si],ax
 330A   0220    
 330A   0220        FOR N = FirstFld TO LastFld                 'Do each field 
                within range
 330A    **        I00335:   mov     si,0Ah[bp]
 330D    **                  mov     ax,[si]
 330F    **                  mov     t0220%,ax
 3312    **                  mov     si,0Ch[bp]
 3315    **                  mov     ax,[si]
 3317    **                  jmp     I00336
 331A   0222    
 331A   0222            IF Fld(N).FType = 0 THEN N = N + 1
 331A    **        I00337:   sal     ax,1
 331C    **                  sal     ax,1
 331E    **                  sal     ax,1
 3320    **                  sal     ax,1
 3322    **                  sal     ax,1
 3324    **                  sal     ax,1
 3326    **                  mov     bx,ax
 3328    **                  mov     si,06h[bp]
 332B    **                  add     bx,0Ah[si]
 332E    **                  mov     es,02h[si]
 3331    **                  add     bx,0Ah
 3334    **                  es:     
 3335    **                  cmp     word ptr [bx],00h
 3338    **                  jne     I00338
 333A    **                  inc     N%
 333E   0224    
 333E   0224            LOCATE Fld(N).Row, Fld(N).LCol          'Position the c
                ursor
 333E   0224    
 333E   0224            SELECT CASE Fld(N).FType
 333E   0224    '        CASE NotesFld                           'Is this a "No
                tes" field
 333E   0224    '
 333E   0224    '           IF Instate THEN                      'Set QEdit's i
                nsert state
 333E   0224    '              Ed.InsStat = Instate
 333E   0224    '           ELSE
 333E   0224    '              Ed.InsStat = 1
 333E   0224    '           END IF
 333E   0224    '
 333E   0224    '           Ed.Rows = Fld(N).ScratchI - Fld(N).Row + 1
 333E   0224    '           Ed.Wide = Fld(N).RCol - Fld(N).LCol + 1
                                                                      PAGE 124
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 333E   0224    '           Ed.Wrap = Ed.Wide - 1
 333E   0224    '           HideCursor
 333E   0224    '           Ed.AColor = SCREEN(Fld(N).Row, Fld(N).LCol, 1)
 333E   0224    '
 333E   0224    '           Ed.Frame = 0
 333E   0224    '
 333E   0224    '           X& = FRE("") - 1000                  'Create array 
                to hold text
 333E   0224    '           REDIM Work$((X& \ 2 + LEN(Form$(N, 0))) \ Ed.Wrap)
 333E   0224    '           Work$(1) = Form$(N, 0)               'Put text in a
                rray
 333E   0224    '
 333E   0224    '           QEdit Work$(), "", 1, Ed             'Let QEdit dis
                play the text
 333E   0224    '
 333E   0224    '           ShowCursor
 333E   0224    '           ERASE Work$                          'Erase the tem
                porary array
 333E   0224    
 333E   0224            CASE IS <> Button                       'Regular fields
 333E   0224               MQPrint Form$(N, 0), -1              'Print the Form
                $ element
 333E    **        I00338:   push    01h
 3340    **                  mov     bx,N%
 3344    **                  sal     bx,1
 3346    **                  sal     bx,1
 3348    **                  sal     bx,1
 334A    **                  sal     bx,1
 334C    **                  sal     bx,1
 334E    **                  sal     bx,1
 3350    **                  mov     si,06h[bp]
 3353    **                  mov     dx,bx
 3355    **                  add     bx,0Ah[si]
 3358    **                  mov     es,02h[si]
 335B    **                  add     bx,02h
 335E    **                  es:     
 335F    **                  push    [bx]
 3361    **                  push    01h
 3363    **                  mov     bx,dx
 3365    **                  add     bx,0Ah[si]
 3368    **                  mov     es,02h[si]
 336B    **                  add     bx,04h
 336E    **                  es:     
 336F    **                  push    [bx]
 3371    **                  push    04h
 3373    **                  mov     0ECh[bp],dx
 3376    **                  call    B$LOCT
 337B    **                  mov     bx,0ECh[bp]
 337E    **                  add     bx,0Ah[si]
 3381    **                  mov     es,02h[si]
 3384    **                  add     bx,0Ah
 3387    **                  es:     
 3388    **                  mov     ax,[bx]
 338A    **                  mov     t0224%,ax
                                                                      PAGE 125
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 338D    **                  cmp     word ptr t0224%,18h
 3392    **                  jne     $+03h
 3394    **                  jmp     I00339
 3397    **                  mov     bx,N%
 339B    **                  sal     bx,1
 339D    **                  sal     bx,1
 339F    **                  mov     si,08h[bp]
 33A2    **                  mov     dx,bx
 33A4    **                  add     bx,0Ah[si]
 33A7    **                  push    bx
 33A8    **                  push    offset t0226$
 33AB    **                  mov     0EAh[bp],dx
 33AE    **                  call    B$SASS
 33B3    **                  mov     t022A%,0FFFFh
 33B9    **                  push    offset t0226$
 33BC    **                  push    offset t022A%
 33BF    **                  call    MQPRINT
 33C4    **                  push    offset t0226$
 33C7    **                  mov     si,08h[bp]
 33CA    **                  mov     bx,0EAh[bp]
 33CD    **                  add     bx,0Ah[si]
 33D0    **                  push    bx
 33D1    **                  call    B$SASF
 33D6    **                  push    offset t0226$
 33D9    **                  call    B$STDL
 33DE   022C    
 33DE   022C            CASE ELSE
 33DE    **                  jmp     I00340
 33E1   022C            END SELECT
 33E1    **        I00339:
 33E1   022C        NEXT
 33E1    **        I00340:   mov     ax,N%
 33E4    **                  inc     ax
 33E5    **        I00336:   mov     N%,ax
 33E8    **                  cmp     ax,t0220%
 33EC    **                  jg      $+03h
 33EE    **                  jmp     I00337
 33F1   022C    
 33F1   022C    END SUB
 33F1    **        I00334:   push    offset t0226$
 33F4    **                  call    B$STDL
 3401   022C    
 3401   022C    '**************************************************************
                **************
 3401   022C    'Checks and converts a fields data and places it in the record 
                buffer
 3401   022C    '[Form$(0, 0)].  Numbers are converted to IEEE format for the b
                uffer and also
 3401   022C    'formatted for display and replaced in their element of the arr
                ay.  Dates are
 3401   022C    'converted to integers and check for validity.  Fields that con
                tain sub-fields
 3401   022C    'such as Phone Numbers and Zips Code are packed to remove delim
                iters before
                                                                      PAGE 126
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3401   022C    'being placed in the buffer.
 3401   022C    '
 3401   022C    'Note: This routine is used internaly by [EditForm], but can be
                 called by
 3401   022C    'your program to check and format data before calling [PrintArr
                ay] to display.
 3401   022C    '
 3401   022C    'FldNo is the Field number to save.
 3401   022C    '
 3401   022C    'Form$() is the form data array.  Form$(FldNo, 0) must contain 
                the data to be
 3401   022C    '  checked, formatted and saved.
 3401   022C    '
 3401   022C    'Fld() is the field definition TYPE array.
 3401   022C    '
 3401   022C    'BadFld is a flag which will be returned with a -1 to indicate 
                that the data
 3401   022C    '  was invalid or out of range.
 3401   022C    '**************************************************************
                **************
 3401   022C    '
 3401   022C    SUB SaveField (FldNo, Form$(), Fld() AS FieldInfo, BadFld) STAT
                IC
 33F9    **        I00333:   jmp     I00341
 341A   022C    
 341A   022C        BadFld = 0                                  'No problems ye
                t
 341A   022C    
 341A   022C        FType = Fld(FldNo).FType                    'Get the field'
                s type
 341A   022C        IF FType = Relational THEN FType = Fld(FldNo).ScratchI
 3404    **                  mov     si,06h[bp]
 341D    **                  mov     [si],0000h
 3421    **                  mov     si,0Ch[bp]
 3424    **                  mov     bx,[si]
 3426    **                  sal     bx,1
 3428    **                  sal     bx,1
 342A    **                  sal     bx,1
 342C    **                  sal     bx,1
 342E    **                  sal     bx,1
 3430    **                  sal     bx,1
 3432    **                  mov     si,08h[bp]
 3435    **                  mov     dx,bx
 3437    **                  add     bx,0Ah[si]
 343A    **                  mov     es,02h[si]
 343D    **                  add     bx,0Ah
 3440    **                  es:     
 3441    **                  mov     ax,[bx]
 3443    **                  mov     FTYPE%,ax
 3446    **                  cmp     ax,000Bh
 3449    **                  jne     I00343
 344B    **                  mov     bx,dx
 344D    **                  add     bx,0Ah[si]
 3450    **                  mov     es,02h[si]
                                                                      PAGE 127
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3453    **                  add     bx,26h
 3456    **                  es:     
 3457    **                  mov     ax,[bx]
 3459    **                  mov     FTYPE%,ax
 345C   022E    
 345C   022E        SELECT CASE FType                           'Branch accordi
                ng to type
 345C   022E                                                    'Numeric fields
 345C   022E           CASE IntFld, LongIntFld, SngFld, DblFld, MoneyFld
 345C    **        I00343:   mov     ax,FTYPE%
 345F    **                  mov     t022E%,ax
 3462    **                  cmp     word ptr t022E%,03h
 3467    **                  je      I00344
 3469    **                  cmp     word ptr t022E%,12h
 346E    **                  je      I00344
 3470    **                  cmp     word ptr t022E%,04h
 3475    **                  je      I00344
 3477    **                  cmp     word ptr t022E%,05h
 347C    **                  je      I00344
 347E    **                  cmp     word ptr t022E%,0Ah
 3483    **                  je      $+03h
 3485    **                  jmp     I00345
 3488   0230    
 3488   0230              IF Null(Form$(FldNo, 0)) THEN         'If the field i
                s blank, set
 3488   0230                 SELECT CASE FType                  '  value to fla
                g it as blank
 3488   0230                    CASE IntFld
 3488   0230                       Temp$ = MKI$(BlankInt)
 3488   0230                    CASE LongIntFld
 3488    **        I00344:   mov     si,0Ch[bp]
 348B    **                  mov     bx,[si]
 348D    **                  sal     bx,1
 348F    **                  sal     bx,1
 3491    **                  mov     si,0Ah[bp]
 3494    **                  add     bx,0Ah[si]
 3497    **                  push    bx
 3498    **                  push    offset t0230$
 349B    **                  call    B$SASS
 34A0    **                  push    offset t0230$
 34A3    **                  call    NULL%
 34A8    **                  mov     t0234%,ax
 34AB    **                  push    offset t0230$
 34AE    **                  mov     si,0Ch[bp]
 34B1    **                  mov     bx,[si]
 34B3    **                  sal     bx,1
 34B5    **                  sal     bx,1
 34B7    **                  mov     si,0Ah[bp]
 34BA    **                  add     bx,0Ah[si]
 34BD    **                  push    bx
 34BE    **                  call    B$SASF
 34C3    **                  push    offset t0230$
 34C6    **                  call    B$STDL
 34CB    **                  mov     ax,t0234%
                                                                      PAGE 128
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 34CE    **                  and     ax,ax
 34D0    **                  jne     $+03h
 34D2    **                  jmp     I00346
 34D5    **                  mov     ax,FTYPE%
 34D8    **                  mov     t0236%,ax
 34DB    **                  cmp     word ptr t0236%,03h
 34E0    **                  jne     I00347
 34E2    **                  push    8001h
 34E5    **                  call    B$FMKI
 34EA    **                  push    ax
 34EB    **                  push    offset TEMP$
 34EE    **                  call    B$SASS
 34F3    **                  jmp     I00348
 34F6   0238                       Temp$ = MKL$(BlankLng&)
 34F6   0238                    CASE SngFld
 34F6    **        I00347:   cmp     word ptr t0236%,12h
 34FB    **                  jne     I00349
 34FD    **                  push    8000h
 3500    **                  push    01h
 3502    **                  call    B$FMKL
 3507    **                  push    ax
 3508    **                  push    offset TEMP$
 350B    **                  call    B$SASS
 3510    **                  jmp     I00348
 3513   0238                       Temp$ = MKS$(BlankSng!)
 3513   0238                    CASE DblFld, MoneyFld
 3513    **        I00349:   cmp     word ptr t0236%,04h
 3518    **                  jne     I00350
 351A    **                  push    0FF7Fh
 351D    **                  push    0FDh
 351F    **                  call    B$FMKS
 3524    **                  push    ax
 3525    **                  push    offset TEMP$
 3528    **                  call    B$SASS
 352D    **                  jmp     I00348
 3530    **        I00350:   cmp     word ptr t0236%,05h
 3535    **                  je      I00351
 3537    **                  cmp     word ptr t0236%,0Ah
 353C    **                  je      $+03h
 353E    **                  jmp     I00352
 3541   0238                       Temp$ = MKD$(BlankDbl#)
 3541   0238                 END SELECT
 3541    **        I00351:   push    0EFh
 3543    **                  push    0FFh
 3545    **                  push    0FFh
 3547    **                  push    0E2h
 3549    **                  call    B$FMKD
 354E    **                  push    ax
 354F    **                  push    offset TEMP$
 3552    **                  call    B$SASS
 3557    **                  jmp     I00348
 355A    **        I00352:
 355A   0238    
 355A   0238              ELSE
                                                                      PAGE 129
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 355A    **        I00348:   jmp     I00353
 355D   0238                                                    'Get the value 
                of the string
 355D   0238                 Float# = Value#(Form$(FldNo, 0), ErrCode)
 355D   0238                                                    'Check for out 
                of range
 355D   0238                 IF ErrCode OR Float# > Fld(FldNo).HiRange OR Float
                # < Fld(FldNo).LowRange THEN
 355D   0238                    BadFld = -1
 355D   0238                    EXIT SUB
 355D   0238                 ELSE
 355D    **        I00346:   mov     si,0Ch[bp]
 3560    **                  mov     bx,[si]
 3562    **                  mov     dx,bx
 3564    **                  sal     bx,1
 3566    **                  sal     bx,1
 3568    **                  mov     si,0Ah[bp]
 356B    **                  mov     cx,bx
 356D    **                  add     bx,0Ah[si]
 3570    **                  push    bx
 3571    **                  push    offset t0238$
 3574    **                  mov     0ECh[bp],cx
 3577    **                  mov     0EAh[bp],dx
 357A    **                  call    B$SASS
 357F    **                  push    offset t0238$
 3582    **                  push    offset ERRCODE%
 3585    **                  push    offset t023E#
 3588    **                  call    VALUE#
 358D    **                  push    offset t0238$
 3590    **                  mov     si,0Ah[bp]
 3593    **                  mov     bx,0ECh[bp]
 3596    **                  add     bx,0Ah[si]
 3599    **                  push    bx
 359A    **                  call    B$SASF
 359F    **                  push    offset t0238$
 35A2    **                  call    B$STDL
 35A7    **                  mov     di,offset FLOAT#
 35AA    **                  mov     si,offset t023E#
 35AD    **                  push    ds
 35AE    **                  pop     es
 35AF    **                  movsw   
 35B0    **                  movsw   
 35B1    **                  movsw   
 35B2    **                  movsw   
 35B3    **                  int     39h
 35B5    **                  db      06h
 35B6    **                  dw      FLOAT#
 35B8    **                  mov     bx,0EAh[bp]
 35BB    **                  sal     bx,1
 35BD    **                  sal     bx,1
 35BF    **                  sal     bx,1
 35C1    **                  sal     bx,1
 35C3    **                  sal     bx,1
 35C5    **                  sal     bx,1
                                                                      PAGE 130
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 35C7    **                  mov     si,08h[bp]
 35CA    **                  mov     dx,bx
 35CC    **                  add     bx,0Ah[si]
 35CF    **                  mov     es,02h[si]
 35D2    **                  add     bx,30h
 35D5    **                  int     3Ch
 35D7    **                  db      0DDh
 35D8    **                  db      07h
 35D9    **                  int     3Dh
 35DB    **                  call    B$FCMP
 35E0    **                  mov     ax,0000h
 35E3    **                  jnb     $+01h
 35E5    **                  dec     ax
 35E6    **                  int     39h
 35E8    **                  db      06h
 35E9    **                  dw      FLOAT#
 35EB    **                  mov     bx,dx
 35ED    **                  add     bx,0Ah[si]
 35F0    **                  mov     es,02h[si]
 35F3    **                  add     bx,28h
 35F6    **                  int     3Ch
 35F8    **                  db      0DDh
 35F9    **                  db      07h
 35FA    **                  mov     bx,ax
 35FC    **                  int     3Dh
 35FE    **                  call    B$FCMP
 3603    **                  mov     ax,0000h
 3606    **                  jna     $+01h
 3608    **                  dec     ax
 3609    **                  or      bx,ax
 360B    **                  or      bx,ERRCODE%
 360F    **                  and     bx,bx
 3611    **                  je      I00354
 3613    **                  mov     si,06h[bp]
 3616    **                  mov     [si],0FFFFh
 361A    **                  jmp     I00342
 361D    **                  jmp     I00355
 3620   024E                                                    'Format number 
                back into array
 3620   024E                    Format Float#, Fld(FldNo), Form$(FldNo, 0)
 3620    **        I00354:   mov     si,0Ch[bp]
 3623    **                  mov     bx,[si]
 3625    **                  mov     dx,bx
 3627    **                  sal     bx,1
 3629    **                  sal     bx,1
 362B    **                  sal     bx,1
 362D    **                  sal     bx,1
 362F    **                  sal     bx,1
 3631    **                  sal     bx,1
 3633    **                  mov     si,08h[bp]
 3636    **                  mov     cx,bx
 3638    **                  add     bx,0Ah[si]
 363B    **                  mov     es,02h[si]
 363E    **                  push    es
                                                                      PAGE 131
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 363F    **                  push    bx
 3640    **                  mov     ax,0040h
 3643    **                  push    ax
 3644    **                  push    ds
 3645    **                  push    offset t024E
 3648    **                  mov     ax,0040h
 364B    **                  push    ax
 364C    **                  mov     0E8h[bp],cx
 364F    **                  mov     0E6h[bp],dx
 3652    **                  call    B$ASSN
 3657    **                  mov     bx,0E6h[bp]
 365A    **                  sal     bx,1
 365C    **                  sal     bx,1
 365E    **                  mov     si,0Ah[bp]
 3661    **                  mov     dx,bx
 3663    **                  add     bx,0Ah[si]
 3666    **                  push    bx
 3667    **                  push    offset t028E$
 366A    **                  mov     0E4h[bp],dx
 366D    **                  call    B$SASS
 3672    **                  push    offset FLOAT#
 3675    **                  push    offset t024E
 3678    **                  push    offset t028E$
 367B    **                  call    FORMAT
 3680    **                  push    offset t028E$
 3683    **                  mov     si,0Ah[bp]
 3686    **                  mov     bx,0E4h[bp]
 3689    **                  add     bx,0Ah[si]
 368C    **                  push    bx
 368D    **                  call    B$SASF
 3692    **                  push    ds
 3693    **                  push    offset t024E
 3696    **                  mov     ax,0040h
 3699    **                  push    ax
 369A    **                  mov     si,08h[bp]
 369D    **                  mov     bx,0E8h[bp]
 36A0    **                  add     bx,0Ah[si]
 36A3    **                  mov     es,02h[si]
 36A6    **                  push    es
 36A7    **                  push    bx
 36A8    **                  mov     ax,0040h
 36AB    **                  push    ax
 36AC    **                  call    B$ASSN
 36B1    **                  push    offset t028E$
 36B4    **                  call    B$STDL
 36B9   0292                                                   
 36B9   0292                    SELECT CASE FType               'Set the buffer
                 to IEEE format
 36B9   0292                       CASE IntFld
 36B9   0292                          Temp$ = MKI$(INT(Float#))
 36B9   0292                       CASE LongIntFld
 36B9    **                  mov     ax,FTYPE%
 36BC    **                  mov     t0292%,ax
 36BF    **                  cmp     word ptr t0292%,03h
                                                                      PAGE 132
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 36C4    **                  jne     I00356
 36C6    **                  int     39h
 36C8    **                  db      06h
 36C9    **                  dw      FLOAT#
 36CB    **                  int     3Dh
 36CD    **                  call    B$INT8
 36D2    **                  call    B$FIS2
 36D7    **                  push    ax
 36D8    **                  call    B$FMKI
 36DD    **                  push    ax
 36DE    **                  push    offset TEMP$
 36E1    **                  call    B$SASS
 36E6    **                  jmp     I00357
 36E9   0294                          Temp$ = MKL$(CLNG(Float#))
 36E9   0294                       CASE SngFld
 36E9    **        I00356:   cmp     word ptr t0292%,12h
 36EE    **                  jne     I00358
 36F0    **                  int     39h
 36F2    **                  db      06h
 36F3    **                  dw      FLOAT#
 36F5    **                  call    B$FIST
 36FA    **                  push    dx
 36FB    **                  push    ax
 36FC    **                  call    B$FMKL
 3701    **                  push    ax
 3702    **                  push    offset TEMP$
 3705    **                  call    B$SASS
 370A    **                  jmp     I00357
 370D   0294                          Temp$ = MKS$(CSNG(Float#))
 370D   0294                       CASE DblFld, MoneyFld
 370D    **        I00358:   cmp     word ptr t0292%,04h
 3712    **                  jne     I00359
 3714    **                  int     39h
 3716    **                  db      06h
 3717    **                  dw      FLOAT#
 3719    **                  sub     sp,04h
 371C    **                  mov     bx,sp
 371E    **                  int     35h
 3720    **                  db      1Fh
 3721    **                  int     3Dh
 3723    **                  call    B$FMKS
 3728    **                  push    ax
 3729    **                  push    offset TEMP$
 372C    **                  call    B$SASS
 3731    **                  jmp     I00357
 3734    **        I00359:   cmp     word ptr t0292%,05h
 3739    **                  je      I00360
 373B    **                  cmp     word ptr t0292%,0Ah
 3740    **                  je      $+03h
 3742    **                  jmp     I00361
 3745   0294                          Temp$ = MKD$(Float#)
 3745   0294                    END SELECT
 3745    **        I00360:   mov     bx,offset FLOAT#
 3748    **                  push    06h[bx]
                                                                      PAGE 133
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 374B    **                  push    04h[bx]
 374E    **                  push    02h[bx]
 3751    **                  push    [bx]
 3753    **                  call    B$FMKD
 3758    **                  push    ax
 3759    **                  push    offset TEMP$
 375C    **                  call    B$SASS
 3761    **                  jmp     I00357
 3764    **        I00361:
 3764   0294                 END IF
 3764    **        I00357:
 3764   0294              END IF
 3764    **        I00355:
 3764   0294    
 3764   0294              MID$(Form$(0, 0), Fld(FldNo).Fields) = Temp$
 3764   0294    
 3764   0294           CASE DateFld, EuroDateFld
 3764    **        I00353:   mov     si,0Ah[bp]
 3767    **                  xor     bx,bx
 3769    **                  add     bx,0Ah[si]
 376C    **                  push    ds
 376D    **                  push    bx
 376E    **                  xor     ax,ax
 3770    **                  push    ax
 3771    **                  push    offset TEMP$
 3774    **                  push    7FFFh
 3777    **                  mov     si,0Ch[bp]
 377A    **                  mov     bx,[si]
 377C    **                  sal     bx,1
 377E    **                  sal     bx,1
 3780    **                  sal     bx,1
 3782    **                  sal     bx,1
 3784    **                  sal     bx,1
 3786    **                  sal     bx,1
 3788    **                  mov     si,08h[bp]
 378B    **                  add     bx,0Ah[si]
 378E    **                  mov     es,02h[si]
 3791    **                  es:     
 3792    **                  push    [bx]
 3794    **                  call    B$SMID
 3799    **                  jmp     I00362
 379C    **        I00345:   cmp     word ptr t022E%,06h
 37A1    **                  je      I00363
 37A3    **                  cmp     word ptr t022E%,13h
 37A8    **                  je      $+03h
 37AA    **                  jmp     I00364
 37AD   0294    
 37AD   0294              FixDate Form$(FldNo, 0)               'Make date $ th
                e proper format
 37AD    **        I00363:   mov     si,0Ch[bp]
 37B0    **                  mov     bx,[si]
 37B2    **                  sal     bx,1
 37B4    **                  sal     bx,1
 37B6    **                  mov     si,0Ah[bp]
                                                                      PAGE 134
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 37B9    **                  mov     dx,bx
 37BB    **                  add     bx,0Ah[si]
 37BE    **                  push    bx
 37BF    **                  push    offset t0294$
 37C2    **                  mov     0E2h[bp],dx
 37C5    **                  call    B$SASS
 37CA    **                  push    offset t0294$
 37CD    **                  call    FIXDATE
 37D2    **                  push    offset t0294$
 37D5    **                  mov     si,0Ah[bp]
 37D8    **                  mov     bx,0E2h[bp]
 37DB    **                  add     bx,0Ah[si]
 37DE    **                  push    bx
 37DF    **                  call    B$SASF
 37E4    **                  push    offset t0294$
 37E7    **                  call    B$STDL
 37EC   0298                                                    '  NN-NN-NNNN
 37EC   0298                                                    'Convert to an 
                integer and
 37EC   0298                                                    '  check validi
                ty
 37EC   0298              IF Form$(FldNo, 0) = BlankDate$ THEN
 37EC   0298                 Days = BlankInt
 37EC   0298              ELSE
 37EC    **                  mov     si,0Ch[bp]
 37EF    **                  mov     bx,[si]
 37F1    **                  sal     bx,1
 37F3    **                  sal     bx,1
 37F5    **                  mov     si,0Ah[bp]
 37F8    **                  add     bx,0Ah[si]
 37FB    **                  push    bx
 37FC    **                  push    offset <const>
 37FF    **                  call    B$SCMP
 3804    **                  jne     I00365
 3806    **                  mov     DAYS%,8001h
 380C    **                  jmp     I00366
 380F   029A                 IF FType = DateFld THEN            'US dates
 380F   029A                    Days = Date2Num(Form$(FldNo, 0))
 380F   029A                    BadFld = Num2Date$(Days) <> Form$(FldNo, 0)
 380F   029A                 ELSE                               'European dates
 380F    **        I00365:   cmp     word ptr FTYPE%,06h
 3814    **                  je      $+03h
 3816    **                  jmp     I00367
 3819    **                  mov     si,0Ch[bp]
 381C    **                  mov     bx,[si]
 381E    **                  sal     bx,1
 3820    **                  sal     bx,1
 3822    **                  mov     si,0Ah[bp]
 3825    **                  add     bx,0Ah[si]
 3828    **                  push    bx
 3829    **                  push    offset t029A$
 382C    **                  call    B$SASS
 3831    **                  push    offset t029A$
 3834    **                  call    DATE2NUM%
                                                                      PAGE 135
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3839    **                  mov     t029E%,ax
 383C    **                  push    offset t029A$
 383F    **                  mov     si,0Ch[bp]
 3842    **                  mov     bx,[si]
 3844    **                  sal     bx,1
 3846    **                  sal     bx,1
 3848    **                  mov     si,0Ah[bp]
 384B    **                  add     bx,0Ah[si]
 384E    **                  push    bx
 384F    **                  call    B$SASF
 3854    **                  push    offset t029A$
 3857    **                  call    B$STDL
 385C    **                  mov     ax,t029E%
 385F    **                  mov     DAYS%,ax
 3862    **                  push    offset DAYS%
 3865    **                  call    NUM2DATE$
 386A    **                  push    ax
 386B    **                  push    offset t02A0$
 386E    **                  call    B$SASS
 3873    **                  mov     si,0Ch[bp]
 3876    **                  mov     bx,[si]
 3878    **                  sal     bx,1
 387A    **                  sal     bx,1
 387C    **                  mov     si,0Ah[bp]
 387F    **                  add     bx,0Ah[si]
 3882    **                  push    bx
 3883    **                  push    offset t02A0$
 3886    **                  call    B$SCMP
 388B    **                  mov     ax,0000h
 388E    **                  je      $+01h
 3890    **                  dec     ax
 3891    **                  mov     si,06h[bp]
 3894    **                  mov     [si],ax
 3896    **                  jmp     I00368
 3899   02A4                    Days = EDate2Num(Form$(FldNo, 0))
 3899   02A4                    BadFld = ENum2Date$(Days) <> Form$(FldNo, 0)
 3899   02A4                 END IF
 3899    **        I00367:   mov     si,0Ch[bp]
 389C    **                  mov     bx,[si]
 389E    **                  sal     bx,1
 38A0    **                  sal     bx,1
 38A2    **                  mov     si,0Ah[bp]
 38A5    **                  add     bx,0Ah[si]
 38A8    **                  push    bx
 38A9    **                  push    offset t02A4$
 38AC    **                  call    B$SASS
 38B1    **                  push    offset t02A4$
 38B4    **                  call    EDATE2NUM%
 38B9    **                  mov     t02A8%,ax
 38BC    **                  push    offset t02A4$
 38BF    **                  mov     si,0Ch[bp]
 38C2    **                  mov     bx,[si]
 38C4    **                  sal     bx,1
 38C6    **                  sal     bx,1
                                                                      PAGE 136
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 38C8    **                  mov     si,0Ah[bp]
 38CB    **                  add     bx,0Ah[si]
 38CE    **                  push    bx
 38CF    **                  call    B$SASF
 38D4    **                  push    offset t02A4$
 38D7    **                  call    B$STDL
 38DC    **                  mov     ax,t02A8%
 38DF    **                  mov     DAYS%,ax
 38E2    **                  push    offset DAYS%
 38E5    **                  call    ENUM2DATE$
 38EA    **                  push    ax
 38EB    **                  push    offset t02AA$
 38EE    **                  call    B$SASS
 38F3    **                  mov     si,0Ch[bp]
 38F6    **                  mov     bx,[si]
 38F8    **                  sal     bx,1
 38FA    **                  sal     bx,1
 38FC    **                  mov     si,0Ah[bp]
 38FF    **                  add     bx,0Ah[si]
 3902    **                  push    bx
 3903    **                  push    offset t02AA$
 3906    **                  call    B$SCMP
 390B    **                  mov     ax,0000h
 390E    **                  je      $+01h
 3910    **                  dec     ax
 3911    **                  mov     si,06h[bp]
 3914    **                  mov     [si],ax
 3916   02AE                 BadFld = BadFld * 2
 3916   02AE              END IF
 3916    **        I00368:   mov     si,06h[bp]
 3919    **                  mov     ax,[si]
 391B    **                  sal     ax,1
 391D    **                  mov     [si],ax
 391F   02AE    
 391F   02AE              IF Days > BlankInt THEN               'Check range
 391F   02AE                 BadFld = BadFld OR Days > Fld(FldNo).HiRange OR Da
                ys < Fld(FldNo).LowRange
 391F   02AE              END IF
 391F    **        I00366:   cmp     DAYS%,8001h
 3925    **                  jng     I00369
 3927    **                  mov     si,0Ch[bp]
 392A    **                  mov     bx,[si]
 392C    **                  sal     bx,1
 392E    **                  sal     bx,1
 3930    **                  sal     bx,1
 3932    **                  sal     bx,1
 3934    **                  sal     bx,1
 3936    **                  sal     bx,1
 3938    **                  mov     si,08h[bp]
 393B    **                  mov     dx,bx
 393D    **                  add     bx,0Ah[si]
 3940    **                  mov     es,02h[si]
 3943    **                  add     bx,30h
 3946    **                  int     3Ch
                                                                      PAGE 137
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3948    **                  db      0DDh
 3949    **                  db      07h
 394A    **                  int     3Bh
 394C    **                  db      06h
 394D    **                  dw      DAYS%
 394F    **                  int     3Dh
 3951    **                  call    B$FCMP
 3956    **                  mov     ax,0000h
 3959    **                  jna     $+01h
 395B    **                  dec     ax
 395C    **                  mov     bx,dx
 395E    **                  add     bx,0Ah[si]
 3961    **                  mov     es,02h[si]
 3964    **                  add     bx,28h
 3967    **                  int     3Ch
 3969    **                  db      0DDh
 396A    **                  db      07h
 396B    **                  int     3Bh
 396D    **                  db      06h
 396E    **                  dw      DAYS%
 3970    **                  mov     bx,ax
 3972    **                  int     3Dh
 3974    **                  call    B$FCMP
 3979    **                  mov     ax,0000h
 397C    **                  jnb     $+01h
 397E    **                  dec     ax
 397F    **                  or      bx,ax
 3981    **                  mov     si,06h[bp]
 3984    **                  or      bx,[si]
 3986    **                  mov     [si],bx
 3988   02AE    
 3988   02AE              IF NOT BadFld THEN                    'Save number to
                 buffer as IEEE
 3988   02AE                 MID$(Form$(0, 0), Fld(FldNo).Fields) = MKI$(Days)
 3988   02AE              END IF
 3988    **        I00369:   mov     si,06h[bp]
 398B    **                  mov     ax,[si]
 398D    **                  not     ax
 398F    **                  and     ax,ax
 3991    **                  je      I00370
 3993    **                  mov     si,0Ah[bp]
 3996    **                  xor     bx,bx
 3998    **                  add     bx,0Ah[si]
 399B    **                  push    ds
 399C    **                  push    bx
 399D    **                  xor     ax,ax
 399F    **                  push    ax
 39A0    **                  push    DAYS%
 39A4    **                  call    B$FMKI
 39A9    **                  push    ax
 39AA    **                  push    7FFFh
 39AD    **                  mov     si,0Ch[bp]
 39B0    **                  mov     bx,[si]
 39B2    **                  sal     bx,1
                                                                      PAGE 138
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 39B4    **                  sal     bx,1
 39B6    **                  sal     bx,1
 39B8    **                  sal     bx,1
 39BA    **                  sal     bx,1
 39BC    **                  sal     bx,1
 39BE    **                  mov     si,08h[bp]
 39C1    **                  add     bx,0Ah[si]
 39C4    **                  mov     es,02h[si]
 39C7    **                  es:     
 39C8    **                  push    [bx]
 39CA    **                  call    B$SMID
 39CF   02AE    
 39CF   02AE           CASE PhoneFld                            'Pack Phone num
                ber $
 39CF    **        I00370:   jmp     I00362
 39D2   02AE              MID$(Form$(0, 0), Fld(FldNo).Fields) = MID$(Form$(Fld
                No, 0), 2, 3) + MID$(Form$(FldNo, 0), 7, 3) + MID$(Form$(FldNo,
                 0), 11, 4)
 39D2   02AE    
 39D2   02AE           CASE SoSecFld                            'Pack Social Se
                curity number $
 39D2    **        I00364:   cmp     word ptr t022E%,07h
 39D7    **                  je      $+03h
 39D9    **                  jmp     I00371
 39DC    **                  mov     si,0Ch[bp]
 39DF    **                  mov     bx,[si]
 39E1    **                  mov     dx,bx
 39E3    **                  sal     bx,1
 39E5    **                  sal     bx,1
 39E7    **                  mov     si,0Ah[bp]
 39EA    **                  mov     cx,bx
 39EC    **                  add     bx,0Ah[si]
 39EF    **                  push    bx
 39F0    **                  push    02h
 39F2    **                  push    03h
 39F4    **                  mov     0E0h[bp],cx
 39F7    **                  mov     0DEh[bp],dx
 39FA    **                  call    B$FMID
 39FF    **                  push    ax
 3A00    **                  push    offset t02AE$
 3A03    **                  call    B$SASS
 3A08    **                  mov     si,0Ah[bp]
 3A0B    **                  mov     bx,0E0h[bp]
 3A0E    **                  mov     dx,bx
 3A10    **                  add     bx,0Ah[si]
 3A13    **                  push    bx
 3A14    **                  push    07h
 3A16    **                  push    03h
 3A18    **                  call    B$FMID
 3A1D    **                  push    ax
 3A1E    **                  push    offset t02B2$
 3A21    **                  call    B$SASS
 3A26    **                  mov     si,0Ah[bp]
 3A29    **                  mov     bx,0E0h[bp]
                                                                      PAGE 139
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3A2C    **                  add     bx,0Ah[si]
 3A2F    **                  push    bx
 3A30    **                  push    0Bh
 3A32    **                  push    04h
 3A34    **                  call    B$FMID
 3A39    **                  push    ax
 3A3A    **                  push    offset t02B6$
 3A3D    **                  call    B$SASS
 3A42    **                  mov     si,0Ah[bp]
 3A45    **                  xor     bx,bx
 3A47    **                  add     bx,0Ah[si]
 3A4A    **                  push    ds
 3A4B    **                  push    bx
 3A4C    **                  xor     ax,ax
 3A4E    **                  push    ax
 3A4F    **                  push    offset t02AE$
 3A52    **                  push    offset t02B2$
 3A55    **                  call    B$SCAT
 3A5A    **                  push    ax
 3A5B    **                  push    offset t02B6$
 3A5E    **                  call    B$SCAT
 3A63    **                  push    ax
 3A64    **                  push    7FFFh
 3A67    **                  mov     bx,0DEh[bp]
 3A6A    **                  sal     bx,1
 3A6C    **                  sal     bx,1
 3A6E    **                  sal     bx,1
 3A70    **                  sal     bx,1
 3A72    **                  sal     bx,1
 3A74    **                  sal     bx,1
 3A76    **                  mov     si,08h[bp]
 3A79    **                  add     bx,0Ah[si]
 3A7C    **                  mov     es,02h[si]
 3A7F    **                  es:     
 3A80    **                  push    [bx]
 3A82    **                  call    B$SMID
 3A87    **                  jmp     I00362
 3A8A   02BA              MID$(Form$(0, 0), Fld(FldNo).Fields) = MID$(Form$(Fld
                No, 0), 1, 3) + MID$(Form$(FldNo, 0), 5, 2) + MID$(Form$(FldNo,
                 0), 8, 4)
 3A8A   02BA    
 3A8A   02BA           CASE ZipFld                              'Pack Zip Code 
                $
 3A8A    **        I00371:   cmp     word ptr t022E%,08h
 3A8F    **                  je      $+03h
 3A91    **                  jmp     I00372
 3A94    **                  mov     si,0Ch[bp]
 3A97    **                  mov     bx,[si]
 3A99    **                  mov     dx,bx
 3A9B    **                  sal     bx,1
 3A9D    **                  sal     bx,1
 3A9F    **                  mov     si,0Ah[bp]
 3AA2    **                  mov     cx,bx
 3AA4    **                  add     bx,0Ah[si]
                                                                      PAGE 140
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3AA7    **                  push    bx
 3AA8    **                  push    01h
 3AAA    **                  push    03h
 3AAC    **                  mov     0DCh[bp],cx
 3AAF    **                  mov     0DAh[bp],dx
 3AB2    **                  call    B$FMID
 3AB7    **                  push    ax
 3AB8    **                  push    offset t02BA$
 3ABB    **                  call    B$SASS
 3AC0    **                  mov     si,0Ah[bp]
 3AC3    **                  mov     bx,0DCh[bp]
 3AC6    **                  mov     dx,bx
 3AC8    **                  add     bx,0Ah[si]
 3ACB    **                  push    bx
 3ACC    **                  push    05h
 3ACE    **                  push    02h
 3AD0    **                  call    B$FMID
 3AD5    **                  push    ax
 3AD6    **                  push    offset t02BE$
 3AD9    **                  call    B$SASS
 3ADE    **                  mov     si,0Ah[bp]
 3AE1    **                  mov     bx,0DCh[bp]
 3AE4    **                  add     bx,0Ah[si]
 3AE7    **                  push    bx
 3AE8    **                  push    08h
 3AEA    **                  push    04h
 3AEC    **                  call    B$FMID
 3AF1    **                  push    ax
 3AF2    **                  push    offset t02C2$
 3AF5    **                  call    B$SASS
 3AFA    **                  mov     si,0Ah[bp]
 3AFD    **                  xor     bx,bx
 3AFF    **                  add     bx,0Ah[si]
 3B02    **                  push    ds
 3B03    **                  push    bx
 3B04    **                  xor     ax,ax
 3B06    **                  push    ax
 3B07    **                  push    offset t02BA$
 3B0A    **                  push    offset t02BE$
 3B0D    **                  call    B$SCAT
 3B12    **                  push    ax
 3B13    **                  push    offset t02C2$
 3B16    **                  call    B$SCAT
 3B1B    **                  push    ax
 3B1C    **                  push    7FFFh
 3B1F    **                  mov     bx,0DAh[bp]
 3B22    **                  sal     bx,1
 3B24    **                  sal     bx,1
 3B26    **                  sal     bx,1
 3B28    **                  sal     bx,1
 3B2A    **                  sal     bx,1
 3B2C    **                  sal     bx,1
 3B2E    **                  mov     si,08h[bp]
 3B31    **                  add     bx,0Ah[si]
                                                                      PAGE 141
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3B34    **                  mov     es,02h[si]
 3B37    **                  es:     
 3B38    **                  push    [bx]
 3B3A    **                  call    B$SMID
 3B3F    **                  jmp     I00362
 3B42   02C6              MID$(Form$(0, 0), Fld(FldNo).Fields) = MID$(Form$(Fld
                No, 0), 1, 5) + MID$(Form$(FldNo, 0), 7, 4)
 3B42   02C6    
 3B42   02C6           CASE NotesFld                            'Do nothing for
                 Notes field
 3B42    **        I00372:   cmp     word ptr t022E%,09h
 3B47    **                  je      $+03h
 3B49    **                  jmp     I00373
 3B4C    **                  mov     si,0Ch[bp]
 3B4F    **                  mov     bx,[si]
 3B51    **                  mov     dx,bx
 3B53    **                  sal     bx,1
 3B55    **                  sal     bx,1
 3B57    **                  mov     si,0Ah[bp]
 3B5A    **                  mov     cx,bx
 3B5C    **                  add     bx,0Ah[si]
 3B5F    **                  push    bx
 3B60    **                  push    01h
 3B62    **                  push    05h
 3B64    **                  mov     0D8h[bp],cx
 3B67    **                  mov     0D6h[bp],dx
 3B6A    **                  call    B$FMID
 3B6F    **                  push    ax
 3B70    **                  push    offset t02C6$
 3B73    **                  call    B$SASS
 3B78    **                  mov     si,0Ah[bp]
 3B7B    **                  mov     bx,0D8h[bp]
 3B7E    **                  add     bx,0Ah[si]
 3B81    **                  push    bx
 3B82    **                  push    07h
 3B84    **                  push    04h
 3B86    **                  call    B$FMID
 3B8B    **                  push    ax
 3B8C    **                  push    offset t02CA$
 3B8F    **                  call    B$SASS
 3B94    **                  mov     si,0Ah[bp]
 3B97    **                  xor     bx,bx
 3B99    **                  add     bx,0Ah[si]
 3B9C    **                  push    ds
 3B9D    **                  push    bx
 3B9E    **                  xor     ax,ax
 3BA0    **                  push    ax
 3BA1    **                  push    offset t02C6$
 3BA4    **                  push    offset t02CA$
 3BA7    **                  call    B$SCAT
 3BAC    **                  push    ax
 3BAD    **                  push    7FFFh
 3BB0    **                  mov     bx,0D6h[bp]
 3BB3    **                  sal     bx,1
                                                                      PAGE 142
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3BB5    **                  sal     bx,1
 3BB7    **                  sal     bx,1
 3BB9    **                  sal     bx,1
 3BBB    **                  sal     bx,1
 3BBD    **                  sal     bx,1
 3BBF    **                  mov     si,08h[bp]
 3BC2    **                  add     bx,0Ah[si]
 3BC5    **                  mov     es,02h[si]
 3BC8    **                  es:     
 3BC9    **                  push    [bx]
 3BCB    **                  call    B$SMID
 3BD0    **                  jmp     I00362
 3BD3   02CE    
 3BD3   02CE           CASE PropStrFld                          'Capitalize fir
                st letters of
 3BD3    **        I00373:   cmp     word ptr t022E%,11h
 3BD8    **                  jne     I00374
 3BDA    **                  jmp     I00362
 3BDD   02CE              ProperName Form$(FldNo, 0)            '  words for Pr
                oper Name $
 3BDD    **        I00374:   cmp     word ptr t022E%,17h
 3BE2    **                  je      $+03h
 3BE4    **                  jmp     I00375
 3BE7    **                  mov     si,0Ch[bp]
 3BEA    **                  mov     bx,[si]
 3BEC    **                  sal     bx,1
 3BEE    **                  sal     bx,1
 3BF0    **                  mov     si,0Ah[bp]
 3BF3    **                  mov     dx,bx
 3BF5    **                  add     bx,0Ah[si]
 3BF8    **                  push    bx
 3BF9    **                  push    offset t02CE$
 3BFC    **                  mov     0D4h[bp],dx
 3BFF    **                  call    B$SASS
 3C04    **                  push    offset t02CE$
 3C07    **                  call    PROPERNAME
 3C0C    **                  push    offset t02CE$
 3C0F    **                  mov     si,0Ah[bp]
 3C12    **                  mov     bx,0D4h[bp]
 3C15    **                  add     bx,0Ah[si]
 3C18    **                  push    bx
 3C19    **                  call    B$SASF
 3C1E    **                  push    offset t02CE$
 3C21    **                  call    B$STDL
 3C26   02D2              MID$(Form$(0, 0), Fld(FldNo).Fields) = Form$(FldNo, 0
                )
 3C26   02D2             
 3C26   02D2           CASE UCaseStrFld                         'Capitalize Upp
                er Case fields
 3C26    **                  mov     si,0Ah[bp]
 3C29    **                  xor     bx,bx
 3C2B    **                  add     bx,0Ah[si]
 3C2E    **                  push    ds
 3C2F    **                  push    bx
                                                                      PAGE 143
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3C30    **                  xor     ax,ax
 3C32    **                  push    ax
 3C33    **                  mov     si,0Ch[bp]
 3C36    **                  mov     bx,[si]
 3C38    **                  mov     dx,bx
 3C3A    **                  sal     bx,1
 3C3C    **                  sal     bx,1
 3C3E    **                  mov     si,0Ah[bp]
 3C41    **                  add     bx,0Ah[si]
 3C44    **                  push    bx
 3C45    **                  push    7FFFh
 3C48    **                  sal     dx,1
 3C4A    **                  sal     dx,1
 3C4C    **                  sal     dx,1
 3C4E    **                  sal     dx,1
 3C50    **                  sal     dx,1
 3C52    **                  sal     dx,1
 3C54    **                  mov     bx,dx
 3C56    **                  mov     si,08h[bp]
 3C59    **                  add     bx,0Ah[si]
 3C5C    **                  mov     es,02h[si]
 3C5F    **                  es:     
 3C60    **                  push    [bx]
 3C62    **                  call    B$SMID
 3C67    **                  jmp     I00362
 3C6A   02D2              LSET Form$(FldNo, 0) = UCASE$(Form$(FldNo, 0))
 3C6A   02D2              MID$(Form$(0, 0), Fld(FldNo).Fields) = Form$(FldNo, 0
                )
 3C6A   02D2    
 3C6A   02D2           CASE Button
 3C6A    **        I00375:   cmp     word ptr t022E%,02h
 3C6F    **                  jne     I00376
 3C71    **                  mov     si,0Ch[bp]
 3C74    **                  mov     bx,[si]
 3C76    **                  mov     dx,bx
 3C78    **                  sal     bx,1
 3C7A    **                  sal     bx,1
 3C7C    **                  mov     si,0Ah[bp]
 3C7F    **                  mov     cx,bx
 3C81    **                  add     bx,0Ah[si]
 3C84    **                  push    bx
 3C85    **                  mov     0D2h[bp],cx
 3C88    **                  mov     0D0h[bp],dx
 3C8B    **                  call    B$UCAS
 3C90    **                  push    ax
 3C91    **                  push    offset t02D2$
 3C94    **                  call    B$SASS
 3C99    **                  push    offset t02D2$
 3C9C    **                  mov     si,0Ah[bp]
 3C9F    **                  mov     bx,0D2h[bp]
 3CA2    **                  mov     dx,bx
 3CA4    **                  add     bx,0Ah[si]
 3CA7    **                  push    ds
 3CA8    **                  push    bx
                                                                      PAGE 144
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3CA9    **                  xor     ax,ax
 3CAB    **                  push    ax
 3CAC    **                  call    B$LSET
 3CB1    **                  mov     si,0Ah[bp]
 3CB4    **                  xor     bx,bx
 3CB6    **                  add     bx,0Ah[si]
 3CB9    **                  push    ds
 3CBA    **                  push    bx
 3CBB    **                  xor     ax,ax
 3CBD    **                  push    ax
 3CBE    **                  mov     si,0Ah[bp]
 3CC1    **                  mov     bx,0D2h[bp]
 3CC4    **                  add     bx,0Ah[si]
 3CC7    **                  push    bx
 3CC8    **                  push    7FFFh
 3CCB    **                  mov     bx,0D0h[bp]
 3CCE    **                  sal     bx,1
 3CD0    **                  sal     bx,1
 3CD2    **                  sal     bx,1
 3CD4    **                  sal     bx,1
 3CD6    **                  sal     bx,1
 3CD8    **                  sal     bx,1
 3CDA    **                  mov     si,08h[bp]
 3CDD    **                  add     bx,0Ah[si]
 3CE0    **                  mov     es,02h[si]
 3CE3    **                  es:     
 3CE4    **                  push    [bx]
 3CE6    **                  call    B$SMID
 3CEB    **                  jmp     I00362
 3CEE   02D6    
 3CEE   02D6           CASE ELSE                                'All others, ju
                st save text
 3CEE    **        I00376:   cmp     word ptr t022E%,18h
 3CF3    **                  jne     I00377
 3CF5    **                  jmp     I00362
 3CF8   02D6              MID$(Form$(0, 0), Fld(FldNo).Fields) = Form$(FldNo, 0
                )
 3CF8   02D6    
 3CF8   02D6        END SELECT
 3CF8    **        I00377:   mov     si,0Ah[bp]
 3CFB    **                  xor     bx,bx
 3CFD    **                  add     bx,0Ah[si]
 3D00    **                  push    ds
 3D01    **                  push    bx
 3D02    **                  xor     ax,ax
 3D04    **                  push    ax
 3D05    **                  mov     si,0Ch[bp]
 3D08    **                  mov     bx,[si]
 3D0A    **                  mov     dx,bx
 3D0C    **                  sal     bx,1
 3D0E    **                  sal     bx,1
 3D10    **                  mov     si,0Ah[bp]
 3D13    **                  add     bx,0Ah[si]
 3D16    **                  push    bx
                                                                      PAGE 145
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3D17    **                  push    7FFFh
 3D1A    **                  sal     dx,1
 3D1C    **                  sal     dx,1
 3D1E    **                  sal     dx,1
 3D20    **                  sal     dx,1
 3D22    **                  sal     dx,1
 3D24    **                  sal     dx,1
 3D26    **                  mov     bx,dx
 3D28    **                  mov     si,08h[bp]
 3D2B    **                  add     bx,0Ah[si]
 3D2E    **                  mov     es,02h[si]
 3D31    **                  es:     
 3D32    **                  push    [bx]
 3D34    **                  call    B$SMID
 3D39   02D6    
 3D39   02D6    END SUB
 3D39    **        I00362:
 3D39    **        I00342:   push    offset t02D2$
 3D3C    **                  call    B$STDL
 3D41    **                  push    offset t02CE$
 3D44    **                  call    B$STDL
 3D49    **                  push    offset t02CA$
 3D4C    **                  call    B$STDL
 3D51    **                  push    offset t02C6$
 3D54    **                  call    B$STDL
 3D59    **                  push    offset t02C2$
 3D5C    **                  call    B$STDL
 3D61    **                  push    offset t02BE$
 3D64    **                  call    B$STDL
 3D69    **                  push    offset t02BA$
 3D6C    **                  call    B$STDL
 3D71    **                  push    offset t02B6$
 3D74    **                  call    B$STDL
 3D79    **                  push    offset t02B2$
 3D7C    **                  call    B$STDL
 3D81    **                  push    offset t02AE$
 3D84    **                  call    B$STDL
 3D89    **                  push    offset t02AA$
 3D8C    **                  call    B$STDL
 3D91    **                  push    offset t02A4$
 3D94    **                  call    B$STDL
 3D99    **                  push    offset t02A0$
 3D9C    **                  call    B$STDL
 3DA1    **                  push    offset t029A$
 3DA4    **                  call    B$STDL
 3DA9    **                  push    offset t0294$
 3DAC    **                  call    B$STDL
 3DB1    **                  push    offset t028E$
 3DB4    **                  call    B$STDL
 3DB9    **                  push    offset t0238$
 3DBC    **                  call    B$STDL
 3DC1    **                  push    offset t0230$
 3DC4    **                  call    B$STDL
 3DD1   02D6    
                                                                      PAGE 146
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3DD1   02D6    '**************************************************************
                **************
 3DD1   02D6    'Copies and converts all data from the record buffer [Form$(0, 
                0)] and places
 3DD1   02D6    'it in the individual elements of the [Form$()] array.  This ro
                utine can be
 3DD1   02D6    'called from your program after reading a record from a random 
                access data
 3DD1   02D6    'file (BASIC, Btrieve or ISAM) which uses Form$(0, 0) as the re
                cord buffer.
 3DD1   02D6    'Note:  If your programs do not use random access files, this r
                outine can be
 3DD1   02D6    'deleted from this module.
 3DD1   02D6    '
 3DD1   02D6    'FirstFld is the field number to start unpacking.
 3DD1   02D6    '
 3DD1   02D6    'LastFld is the last field number to unpack.
 3DD1   02D6    '
 3DD1   02D6    'Form$() is the form data array to operate on.  Form$(0, 0) mus
                t contain all
 3DD1   02D6    '  data within the range for unpacking.  Numeric data must be i
                n packed IEEE
 3DD1   02D6    '  form.  Dates must be IEEE integers.  Fields that contain sub
                -fields such
 3DD1   02D6    '  as Phone numbers and Zip Codes must not contain any delimite
                rs.
 3DD1   02D6    '
 3DD1   02D6    'Fld() is the field definition TYPE array.
 3DD1   02D6    '**************************************************************
                **************
 3DD1   02D6    '
 3DD1   02D6    SUB UnPackBuffer (FirstFld, LastFld, Form$(), Fld() AS FieldInf
                o) STATIC
 3DC9    **        I00341:   jmp     I00378
 3DEA   02D6    
 3DEA   02D6        FirstFld = MaxInt(1, FirstFld)              'Check first an
                d last params.
 3DEA   02D6    
 3DEA   02D6        IF LastFld = 0 THEN LastFld = EndOfForms(Fld())
 3DD4    **                  mov     t02D6%,0001h
 3DF0    **                  push    offset t02D6%
 3DF3    **                  push    0Ch[bp]
 3DF6    **                  call    MAXINT%
 3DFB    **                  mov     t02D8%,ax
 3DFE    **                  mov     ax,t02D8%
 3E01    **                  mov     si,0Ch[bp]
 3E04    **                  mov     [si],ax
 3E06    **                  mov     si,0Ah[bp]
 3E09    **                  cmp     word ptr [si],00h
 3E0C    **                  jne     I00380
 3E0E    **                  push    06h[bp]
 3E11    **                  call    ENDOFFORMS%
 3E16    **                  mov     t02DA%,ax
 3E19    **                  mov     ax,t02DA%
                                                                      PAGE 147
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3E1C    **                  mov     si,0Ah[bp]
 3E1F    **                  mov     [si],ax
 3E21   02DC    
 3E21   02DC        FOR N = FirstFld TO LastFld                 'Do each field 
                within range
 3E21    **        I00380:   mov     si,0Ah[bp]
 3E24    **                  mov     ax,[si]
 3E26    **                  mov     t02DC%,ax
 3E29    **                  mov     si,0Ch[bp]
 3E2C    **                  mov     ax,[si]
 3E2E    **                  jmp     I00381
 3E31    **                  nop     
 3E32   02DE    
 3E32   02DE            IF Fld(N).FType = 0 THEN
 3E32   02DE               N = N + 1
 3E32   02DE            END IF
 3E32    **        I00382:   sal     ax,1
 3E34    **                  sal     ax,1
 3E36    **                  sal     ax,1
 3E38    **                  sal     ax,1
 3E3A    **                  sal     ax,1
 3E3C    **                  sal     ax,1
 3E3E    **                  mov     bx,ax
 3E40    **                  mov     si,06h[bp]
 3E43    **                  add     bx,0Ah[si]
 3E46    **                  mov     es,02h[si]
 3E49    **                  add     bx,0Ah
 3E4C    **                  es:     
 3E4D    **                  cmp     word ptr [bx],00h
 3E50    **                  jne     I00383
 3E52    **                  inc     N%
 3E56   02E0    
 3E56   02E0            FType = Fld(N).FType                    'Get the fields
                 type
 3E56   02E0            IF FType = 11 THEN FType = Fld(N).ScratchI
 3E56    **        I00383:   mov     bx,N%
 3E5A    **                  sal     bx,1
 3E5C    **                  sal     bx,1
 3E5E    **                  sal     bx,1
 3E60    **                  sal     bx,1
 3E62    **                  sal     bx,1
 3E64    **                  sal     bx,1
 3E66    **                  mov     si,06h[bp]
 3E69    **                  mov     dx,bx
 3E6B    **                  add     bx,0Ah[si]
 3E6E    **                  mov     es,02h[si]
 3E71    **                  add     bx,0Ah
 3E74    **                  es:     
 3E75    **                  mov     ax,[bx]
 3E77    **                  mov     FTYPE%,ax
 3E7A    **                  cmp     ax,000Bh
 3E7D    **                  jne     I00384
 3E7F    **                  mov     bx,dx
 3E81    **                  add     bx,0Ah[si]
                                                                      PAGE 148
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3E84    **                  mov     es,02h[si]
 3E87    **                  add     bx,26h
 3E8A    **                  es:     
 3E8B    **                  mov     ax,[bx]
 3E8D    **                  mov     FTYPE%,ax
 3E90   02E2    
 3E90   02E2            Length = Fld(N).RCol - Fld(N).LCol + 1
 3E90   02E2            IF LEN(Form$(N, 0)) <> Length AND FType <> NotesFld THE
                N
 3E90   02E2               Form$(N, 0) = SPACE$(Length)
 3E90   02E2            END IF
 3E90    **        I00384:   mov     bx,N%
 3E94    **                  sal     bx,1
 3E96    **                  sal     bx,1
 3E98    **                  sal     bx,1
 3E9A    **                  sal     bx,1
 3E9C    **                  sal     bx,1
 3E9E    **                  sal     bx,1
 3EA0    **                  mov     si,06h[bp]
 3EA3    **                  mov     dx,bx
 3EA5    **                  add     bx,0Ah[si]
 3EA8    **                  mov     es,02h[si]
 3EAB    **                  add     bx,06h
 3EAE    **                  es:     
 3EAF    **                  mov     ax,[bx]
 3EB1    **                  mov     bx,dx
 3EB3    **                  add     bx,0Ah[si]
 3EB6    **                  mov     es,02h[si]
 3EB9    **                  add     bx,04h
 3EBC    **                  es:     
 3EBD    **                  sub     ax,[bx]
 3EBF    **                  inc     ax
 3EC0    **                  mov     LENGTH%,ax
 3EC3    **                  mov     bx,N%
 3EC7    **                  sal     bx,1
 3EC9    **                  sal     bx,1
 3ECB    **                  mov     si,08h[bp]
 3ECE    **                  mov     dx,bx
 3ED0    **                  add     bx,0Ah[si]
 3ED3    **                  mov     si,bx
 3ED5    **                  cmp     ax,[bx]
 3ED7    **                  je      I00385
 3ED9    **                  cmp     word ptr FTYPE%,11h
 3EDE    **                  je      I00385
 3EE0    **                  push    ax
 3EE1    **                  mov     0ECh[bp],dx
 3EE4    **                  call    B$SPAC
 3EE9    **                  push    ax
 3EEA    **                  push    offset t02E4$
 3EED    **                  call    B$SASS
 3EF2    **                  push    offset t02E4$
 3EF5    **                  mov     si,08h[bp]
 3EF8    **                  mov     bx,0ECh[bp]
 3EFB    **                  add     bx,0Ah[si]
                                                                      PAGE 149
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3EFE    **                  push    bx
 3EFF    **                  call    B$SASS
 3F04   02E8    
 3F04   02E8            SELECT CASE FType                       'Process acordi
                ng to type
 3F04   02E8                                                    'Number fields
 3F04   02E8               CASE IntFld, LongIntFld, SngFld, DblFld, MoneyFld
 3F04    **        I00385:   mov     ax,FTYPE%
 3F07    **                  mov     t02E8%,ax
 3F0A    **                  cmp     word ptr t02E8%,03h
 3F0F    **                  je      I00386
 3F11    **                  cmp     word ptr t02E8%,12h
 3F16    **                  je      I00386
 3F18    **                  cmp     word ptr t02E8%,04h
 3F1D    **                  je      I00386
 3F1F    **                  cmp     word ptr t02E8%,05h
 3F24    **                  je      I00386
 3F26    **                  cmp     word ptr t02E8%,0Ah
 3F2B    **                  je      $+03h
 3F2D    **                  jmp     I00387
 3F30   02EA                  SELECT CASE FType
 3F30   02EA                     CASE IntFld                    'Make a number
 3F30   02EA                        Float# = CVI(MID$(Form$(0, 0), Fld(N).Field
                s, 2))
 3F30   02EA                        Blank = Float# = BlankInt   'Check for a bl
                ank
 3F30   02EA                     CASE LongIntFld
 3F30    **        I00386:   mov     ax,FTYPE%
 3F33    **                  mov     t02EA%,ax
 3F36    **                  cmp     word ptr t02EA%,03h
 3F3B    **                  jne     I00388
 3F3D    **                  mov     si,08h[bp]
 3F40    **                  xor     bx,bx
 3F42    **                  add     bx,0Ah[si]
 3F45    **                  push    bx
 3F46    **                  mov     bx,N%
 3F4A    **                  sal     bx,1
 3F4C    **                  sal     bx,1
 3F4E    **                  sal     bx,1
 3F50    **                  sal     bx,1
 3F52    **                  sal     bx,1
 3F54    **                  sal     bx,1
 3F56    **                  mov     si,06h[bp]
 3F59    **                  add     bx,0Ah[si]
 3F5C    **                  mov     es,02h[si]
 3F5F    **                  es:     
 3F60    **                  push    [bx]
 3F62    **                  push    02h
 3F64    **                  call    B$FMID
 3F69    **                  push    ax
 3F6A    **                  push    offset t02EC$
 3F6D    **                  call    B$SASS
 3F72    **                  push    offset t02EC$
 3F75    **                  call    B$FCVI
                                                                      PAGE 150
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3F7A    **                  call    B$FIL2
 3F7F    **                  int     39h
 3F81    **                  db      1Eh
 3F82    **                  dw      FLOAT#
 3F84    **                  int     3Dh
 3F86    **                  int     39h
 3F88    **                  db      06h
 3F89    **                  dw      <00000000C0FFDFC0>
 3F8B    **                  int     39h
 3F8D    **                  db      06h
 3F8E    **                  dw      FLOAT#
 3F90    **                  int     3Dh
 3F92    **                  call    B$FCMP
 3F97    **                  mov     ax,0000h
 3F9A    **                  jne     $+01h
 3F9C    **                  dec     ax
 3F9D    **                  mov     BLANK%,ax
 3FA0    **                  jmp     I00389
 3FA3   02FA                        Float# = CVL(MID$(Form$(0, 0), Fld(N).Field
                s, 4))
 3FA3   02FA                        Blank = Float# = BlankLng&
 3FA3   02FA                     CASE SngFld
 3FA3    **        I00388:   cmp     word ptr t02EA%,12h
 3FA8    **                  jne     I00390
 3FAA    **                  mov     si,08h[bp]
 3FAD    **                  xor     bx,bx
 3FAF    **                  add     bx,0Ah[si]
 3FB2    **                  push    bx
 3FB3    **                  mov     bx,N%
 3FB7    **                  sal     bx,1
 3FB9    **                  sal     bx,1
 3FBB    **                  sal     bx,1
 3FBD    **                  sal     bx,1
 3FBF    **                  sal     bx,1
 3FC1    **                  sal     bx,1
 3FC3    **                  mov     si,06h[bp]
 3FC6    **                  add     bx,0Ah[si]
 3FC9    **                  mov     es,02h[si]
 3FCC    **                  es:     
 3FCD    **                  push    [bx]
 3FCF    **                  push    04h
 3FD1    **                  call    B$FMID
 3FD6    **                  push    ax
 3FD7    **                  push    offset t02FA$
 3FDA    **                  call    B$SASS
 3FDF    **                  push    offset t02FA$
 3FE2    **                  call    B$FCVL
 3FE7    **                  call    B$FILD
 3FEC    **                  int     39h
 3FEE    **                  db      1Eh
 3FEF    **                  dw      FLOAT#
 3FF1    **                  int     3Dh
 3FF3    **                  int     39h
 3FF5    **                  db      06h
                                                                      PAGE 151
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 3FF6    **                  dw      <0000C0FFFFFFDFC1>
 3FF8    **                  int     39h
 3FFA    **                  db      06h
 3FFB    **                  dw      FLOAT#
 3FFD    **                  int     3Dh
 3FFF    **                  call    B$FCMP
 4004    **                  mov     ax,0000h
 4007    **                  jne     $+01h
 4009    **                  dec     ax
 400A    **                  mov     BLANK%,ax
 400D    **                  jmp     I00389
 4010   02FE                        Float# = CVS(MID$(Form$(0, 0), Fld(N).Field
                s, 4))
 4010   02FE                        Blank = Float# = BlankSng!
 4010   02FE                     CASE DblFld, MoneyFld
 4010    **        I00390:   cmp     word ptr t02EA%,04h
 4015    **                  jne     I00391
 4017    **                  mov     si,08h[bp]
 401A    **                  xor     bx,bx
 401C    **                  add     bx,0Ah[si]
 401F    **                  push    bx
 4020    **                  mov     bx,N%
 4024    **                  sal     bx,1
 4026    **                  sal     bx,1
 4028    **                  sal     bx,1
 402A    **                  sal     bx,1
 402C    **                  sal     bx,1
 402E    **                  sal     bx,1
 4030    **                  mov     si,06h[bp]
 4033    **                  add     bx,0Ah[si]
 4036    **                  mov     es,02h[si]
 4039    **                  es:     
 403A    **                  push    [bx]
 403C    **                  push    04h
 403E    **                  call    B$FMID
 4043    **                  push    ax
 4044    **                  push    offset t02FE$
 4047    **                  call    B$SASS
 404C    **                  push    offset t02FE$
 404F    **                  call    B$FCVS
 4054    **                  mov     si,ax
 4056    **                  int     35h
 4058    **                  db      04h
 4059    **                  int     39h
 405B    **                  db      1Eh
 405C    **                  dw      FLOAT#
 405E    **                  int     3Dh
 4060    **                  int     39h
 4062    **                  db      06h
 4063    **                  dw      <000000A0FFFFEFC7>
 4065    **                  int     39h
 4067    **                  db      06h
 4068    **                  dw      FLOAT#
 406A    **                  int     3Dh
                                                                      PAGE 152
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 406C    **                  call    B$FCMP
 4071    **                  mov     ax,0000h
 4074    **                  jne     $+01h
 4076    **                  dec     ax
 4077    **                  mov     BLANK%,ax
 407A    **                  jmp     I00389
 407D    **        I00391:   cmp     word ptr t02EA%,05h
 4082    **                  je      I00392
 4084    **                  cmp     word ptr t02EA%,0Ah
 4089    **                  je      $+03h
 408B    **                  jmp     I00393
 408E   0302                        Float# = CVD(MID$(Form$(0, 0), Fld(N).Field
                s, 8))
 408E   0302                        Blank = Float# <= BlankDbl#
 408E   0302                  END SELECT
 408E    **        I00392:   mov     si,08h[bp]
 4091    **                  xor     bx,bx
 4093    **                  add     bx,0Ah[si]
 4096    **                  push    bx
 4097    **                  mov     bx,N%
 409B    **                  sal     bx,1
 409D    **                  sal     bx,1
 409F    **                  sal     bx,1
 40A1    **                  sal     bx,1
 40A3    **                  sal     bx,1
 40A5    **                  sal     bx,1
 40A7    **                  mov     si,06h[bp]
 40AA    **                  add     bx,0Ah[si]
 40AD    **                  mov     es,02h[si]
 40B0    **                  es:     
 40B1    **                  push    [bx]
 40B3    **                  push    08h
 40B5    **                  call    B$FMID
 40BA    **                  push    ax
 40BB    **                  push    offset t0302$
 40BE    **                  call    B$SASS
 40C3    **                  push    offset t0302$
 40C6    **                  call    B$FCVD
 40CB    **                  mov     si,ax
 40CD    **                  mov     di,offset FLOAT#
 40D0    **                  push    ds
 40D1    **                  pop     es
 40D2    **                  movsw   
 40D3    **                  movsw   
 40D4    **                  movsw   
 40D5    **                  movsw   
 40D6    **                  int     39h
 40D8    **                  db      06h
 40D9    **                  dw      <E2FFFFFFFFFFEFFF>
 40DB    **                  int     39h
 40DD    **                  db      06h
 40DE    **                  dw      FLOAT#
 40E0    **                  int     3Dh
 40E2    **                  call    B$FCMP
                                                                      PAGE 153
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 40E7    **                  mov     ax,0000h
 40EA    **                  ja      $+01h
 40EC    **                  dec     ax
 40ED    **                  mov     BLANK%,ax
 40F0    **                  jmp     I00389
 40F3    **        I00393:
 40F3   0306    
 40F3   0306                  IF Blank THEN                     'If it isn't bl
                ank, format it
 40F3   0306                     LSET Form$(N, 0) = ""
 40F3   0306                  ELSE
 40F3    **        I00389:   mov     ax,BLANK%
 40F6    **                  and     ax,ax
 40F8    **                  je      I00394
 40FA    **                  push    offset <const>
 40FD    **                  mov     bx,N%
 4101    **                  sal     bx,1
 4103    **                  sal     bx,1
 4105    **                  mov     si,08h[bp]
 4108    **                  add     bx,0Ah[si]
 410B    **                  push    ds
 410C    **                  push    bx
 410D    **                  xor     ax,ax
 410F    **                  push    ax
 4110    **                  call    B$LSET
 4115    **                  jmp     I00395
 4118   0306                     Format Float#, Fld(N), Form$(N, 0)
 4118    **        I00394:   mov     bx,N%
 411C    **                  sal     bx,1
 411E    **                  sal     bx,1
 4120    **                  sal     bx,1
 4122    **                  sal     bx,1
 4124    **                  sal     bx,1
 4126    **                  sal     bx,1
 4128    **                  mov     si,06h[bp]
 412B    **                  mov     dx,bx
 412D    **                  add     bx,0Ah[si]
 4130    **                  mov     es,02h[si]
 4133    **                  push    es
 4134    **                  push    bx
 4135    **                  mov     ax,0040h
 4138    **                  push    ax
 4139    **                  push    ds
 413A    **                  push    offset t0306
 413D    **                  mov     ax,0040h
 4140    **                  push    ax
 4141    **                  mov     0EAh[bp],dx
 4144    **                  call    B$ASSN
 4149    **                  mov     bx,N%
 414D    **                  sal     bx,1
 414F    **                  sal     bx,1
 4151    **                  mov     si,08h[bp]
 4154    **                  mov     dx,bx
 4156    **                  add     bx,0Ah[si]
                                                                      PAGE 154
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 4159    **                  push    bx
 415A    **                  push    offset t0346$
 415D    **                  mov     0E8h[bp],dx
 4160    **                  call    B$SASS
 4165    **                  push    offset FLOAT#
 4168    **                  push    offset t0306
 416B    **                  push    offset t0346$
 416E    **                  call    FORMAT
 4173    **                  push    offset t0346$
 4176    **                  mov     si,08h[bp]
 4179    **                  mov     bx,0E8h[bp]
 417C    **                  add     bx,0Ah[si]
 417F    **                  push    bx
 4180    **                  call    B$SASF
 4185    **                  push    ds
 4186    **                  push    offset t0306
 4189    **                  mov     ax,0040h
 418C    **                  push    ax
 418D    **                  mov     si,06h[bp]
 4190    **                  mov     bx,0EAh[bp]
 4193    **                  add     bx,0Ah[si]
 4196    **                  mov     es,02h[si]
 4199    **                  push    es
 419A    **                  push    bx
 419B    **                  mov     ax,0040h
 419E    **                  push    ax
 419F    **                  call    B$ASSN
 41A4    **                  push    offset t0346$
 41A7    **                  call    B$STDL
 41AC   034A                  END IF
 41AC   034A    
 41AC   034A               CASE DateFld                         'Get date numbe
                r
 41AC    **        I00395:   jmp     I00396
 41AF   034A                  X = CVI(MID$(Form$(0, 0), Fld(N).Fields, 2))
 41AF   034A                  IF X > BlankInt THEN              'If it isn't bl
                ank, convert
 41AF   034A                     LSET Form$(N, 0) = Num2Date$(X) '  number into
                 date $
 41AF   034A                  ELSE                              'Otherwise,
 41AF    **        I00387:   cmp     word ptr t02E8%,06h
 41B4    **                  je      $+03h
 41B6    **                  jmp     I00397
 41B9    **                  mov     si,08h[bp]
 41BC    **                  xor     bx,bx
 41BE    **                  add     bx,0Ah[si]
 41C1    **                  push    bx
 41C2    **                  mov     bx,N%
 41C6    **                  sal     bx,1
 41C8    **                  sal     bx,1
 41CA    **                  sal     bx,1
 41CC    **                  sal     bx,1
 41CE    **                  sal     bx,1
 41D0    **                  sal     bx,1
                                                                      PAGE 155
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 41D2    **                  mov     si,06h[bp]
 41D5    **                  add     bx,0Ah[si]
 41D8    **                  mov     es,02h[si]
 41DB    **                  es:     
 41DC    **                  push    [bx]
 41DE    **                  push    02h
 41E0    **                  call    B$FMID
 41E5    **                  push    ax
 41E6    **                  push    offset t034A$
 41E9    **                  call    B$SASS
 41EE    **                  push    offset t034A$
 41F1    **                  call    B$FCVI
 41F6    **                  mov     X%,ax
 41F9    **                  cmp     ax,8001h
 41FC    **                  jng     I00398
 41FE    **                  push    offset X%
 4201    **                  call    NUM2DATE$
 4206    **                  push    ax
 4207    **                  push    offset t0350$
 420A    **                  call    B$SASS
 420F    **                  push    offset t0350$
 4212    **                  mov     bx,N%
 4216    **                  sal     bx,1
 4218    **                  sal     bx,1
 421A    **                  mov     si,08h[bp]
 421D    **                  add     bx,0Ah[si]
 4220    **                  push    ds
 4221    **                  push    bx
 4222    **                  xor     ax,ax
 4224    **                  push    ax
 4225    **                  call    B$LSET
 422A    **                  jmp     I00399
 422D   0354                     LSET Form$(N, 0) = BlankDate$  '  make a blank
                 date $
 422D   0354                  END IF
 422D    **        I00398:   push    offset <const>
 4230    **                  mov     bx,N%
 4234    **                  sal     bx,1
 4236    **                  sal     bx,1
 4238    **                  mov     si,08h[bp]
 423B    **                  add     bx,0Ah[si]
 423E    **                  push    ds
 423F    **                  push    bx
 4240    **                  xor     ax,ax
 4242    **                  push    ax
 4243    **                  call    B$LSET
 4248   0354    
 4248   0354               CASE EuroDateFld                     'Get date numbe
                r
 4248    **        I00399:   jmp     I00396
 424B   0354                  X = CVI(MID$(Form$(0, 0), Fld(N).Fields, 2))
 424B   0354                  IF X > BlankInt THEN              'If it isn't bl
                ank, convert
 424B   0354                     LSET Form$(N, 0) = ENum2Date$(X) '  number int
                                                                      PAGE 156
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

                o date $
 424B   0354                  ELSE                              'Otherwise,
 424B    **        I00397:   cmp     word ptr t02E8%,13h
 4250    **                  je      $+03h
 4252    **                  jmp     I00400
 4255    **                  mov     si,08h[bp]
 4258    **                  xor     bx,bx
 425A    **                  add     bx,0Ah[si]
 425D    **                  push    bx
 425E    **                  mov     bx,N%
 4262    **                  sal     bx,1
 4264    **                  sal     bx,1
 4266    **                  sal     bx,1
 4268    **                  sal     bx,1
 426A    **                  sal     bx,1
 426C    **                  sal     bx,1
 426E    **                  mov     si,06h[bp]
 4271    **                  add     bx,0Ah[si]
 4274    **                  mov     es,02h[si]
 4277    **                  es:     
 4278    **                  push    [bx]
 427A    **                  push    02h
 427C    **                  call    B$FMID
 4281    **                  push    ax
 4282    **                  push    offset t0354$
 4285    **                  call    B$SASS
 428A    **                  push    offset t0354$
 428D    **                  call    B$FCVI
 4292    **                  mov     X%,ax
 4295    **                  cmp     ax,8001h
 4298    **                  jng     I00401
 429A    **                  push    offset X%
 429D    **                  call    ENUM2DATE$
 42A2    **                  push    ax
 42A3    **                  push    offset t0358$
 42A6    **                  call    B$SASS
 42AB    **                  push    offset t0358$
 42AE    **                  mov     bx,N%
 42B2    **                  sal     bx,1
 42B4    **                  sal     bx,1
 42B6    **                  mov     si,08h[bp]
 42B9    **                  add     bx,0Ah[si]
 42BC    **                  push    ds
 42BD    **                  push    bx
 42BE    **                  xor     ax,ax
 42C0    **                  push    ax
 42C1    **                  call    B$LSET
 42C6    **                  jmp     I00402
 42C9   035C                     LSET Form$(N, 0) = BlankDate$  '  make a blank
                 date $
 42C9   035C                  END IF
 42C9    **        I00401:   push    offset <const>
 42CC    **                  mov     bx,N%
 42D0    **                  sal     bx,1
                                                                      PAGE 157
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 42D2    **                  sal     bx,1
 42D4    **                  mov     si,08h[bp]
 42D7    **                  add     bx,0Ah[si]
 42DA    **                  push    ds
 42DB    **                  push    bx
 42DC    **                  xor     ax,ax
 42DE    **                  push    ax
 42DF    **                  call    B$LSET
 42E4   035C    
 42E4   035C               CASE PhoneFld
 42E4    **        I00402:   jmp     I00396
 42E7   035C                  LSET Form$(N, 0) = "(   )    -    " 'Make a phone
                 # template then
 42E7   035C                                                    '  fill in the 
                blanks
 42E7   035C                  MID$(Form$(N, 0), 2) = MID$(Form$(0, 0), Fld(N).F
                ields, 3)
 42E7   035C                  MID$(Form$(N, 0), 7) = MID$(Form$(0, 0), Fld(N).F
                ields + 3, 3)
 42E7   035C                  MID$(Form$(N, 0), 11) = MID$(Form$(0, 0), Fld(N).
                Fields + 6, 4)
 42E7   035C    
 42E7   035C               CASE SoSecFld
 42E7    **        I00400:   cmp     word ptr t02E8%,07h
 42EC    **                  je      $+03h
 42EE    **                  jmp     I00403
 42F1    **                  push    offset <const>
 42F4    **                  mov     bx,N%
 42F8    **                  sal     bx,1
 42FA    **                  sal     bx,1
 42FC    **                  mov     si,08h[bp]
 42FF    **                  mov     dx,bx
 4301    **                  add     bx,0Ah[si]
 4304    **                  push    ds
 4305    **                  push    bx
 4306    **                  xor     ax,ax
 4308    **                  push    ax
 4309    **                  mov     0E6h[bp],dx
 430C    **                  call    B$LSET
 4311    **                  mov     si,08h[bp]
 4314    **                  xor     bx,bx
 4316    **                  add     bx,0Ah[si]
 4319    **                  push    bx
 431A    **                  mov     bx,N%
 431E    **                  sal     bx,1
 4320    **                  sal     bx,1
 4322    **                  sal     bx,1
 4324    **                  sal     bx,1
 4326    **                  sal     bx,1
 4328    **                  sal     bx,1
 432A    **                  mov     si,06h[bp]
 432D    **                  mov     dx,bx
 432F    **                  add     bx,0Ah[si]
 4332    **                  mov     es,02h[si]
                                                                      PAGE 158
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 4335    **                  es:     
 4336    **                  push    [bx]
 4338    **                  push    03h
 433A    **                  mov     0E4h[bp],dx
 433D    **                  call    B$FMID
 4342    **                  push    ax
 4343    **                  push    offset t035C$
 4346    **                  call    B$SASS
 434B    **                  mov     si,08h[bp]
 434E    **                  mov     bx,0E6h[bp]
 4351    **                  mov     dx,bx
 4353    **                  add     bx,0Ah[si]
 4356    **                  push    ds
 4357    **                  push    bx
 4358    **                  xor     ax,ax
 435A    **                  push    ax
 435B    **                  push    offset t035C$
 435E    **                  push    7FFFh
 4361    **                  push    02h
 4363    **                  call    B$SMID
 4368    **                  mov     si,08h[bp]
 436B    **                  xor     bx,bx
 436D    **                  add     bx,0Ah[si]
 4370    **                  push    bx
 4371    **                  mov     si,06h[bp]
 4374    **                  mov     bx,0E4h[bp]
 4377    **                  mov     dx,bx
 4379    **                  add     bx,0Ah[si]
 437C    **                  mov     es,02h[si]
 437F    **                  es:     
 4380    **                  mov     ax,[bx]
 4382    **                  add     ax,0003h
 4385    **                  push    ax
 4386    **                  push    03h
 4388    **                  call    B$FMID
 438D    **                  push    ax
 438E    **                  push    offset t0360$
 4391    **                  call    B$SASS
 4396    **                  mov     si,08h[bp]
 4399    **                  mov     bx,0E6h[bp]
 439C    **                  mov     dx,bx
 439E    **                  add     bx,0Ah[si]
 43A1    **                  push    ds
 43A2    **                  push    bx
 43A3    **                  xor     ax,ax
 43A5    **                  push    ax
 43A6    **                  push    offset t0360$
 43A9    **                  push    7FFFh
 43AC    **                  push    07h
 43AE    **                  call    B$SMID
 43B3    **                  mov     si,08h[bp]
 43B6    **                  xor     bx,bx
 43B8    **                  add     bx,0Ah[si]
 43BB    **                  push    bx
                                                                      PAGE 159
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 43BC    **                  mov     si,06h[bp]
 43BF    **                  mov     bx,0E4h[bp]
 43C2    **                  add     bx,0Ah[si]
 43C5    **                  mov     es,02h[si]
 43C8    **                  es:     
 43C9    **                  mov     ax,[bx]
 43CB    **                  add     ax,0006h
 43CE    **                  push    ax
 43CF    **                  push    04h
 43D1    **                  call    B$FMID
 43D6    **                  push    ax
 43D7    **                  push    offset t0364$
 43DA    **                  call    B$SASS
 43DF    **                  mov     si,08h[bp]
 43E2    **                  mov     bx,0E6h[bp]
 43E5    **                  add     bx,0Ah[si]
 43E8    **                  push    ds
 43E9    **                  push    bx
 43EA    **                  xor     ax,ax
 43EC    **                  push    ax
 43ED    **                  push    offset t0364$
 43F0    **                  push    7FFFh
 43F3    **                  push    0Bh
 43F5    **                  call    B$SMID
 43FA    **                  jmp     I00396
 43FD   0368                  LSET Form$(N, 0) = "   -  -    "  'Make a templat
                e then fill in
 43FD   0368                                                    '  the blanks
 43FD   0368                  MID$(Form$(N, 0), 1) = MID$(Form$(0, 0), Fld(N).F
                ields, 3)
 43FD   0368                  MID$(Form$(N, 0), 5) = MID$(Form$(0, 0), Fld(N).F
                ields + 3, 2)
 43FD   0368                  MID$(Form$(N, 0), 8) = MID$(Form$(0, 0), Fld(N).F
                ields + 5, 4)
 43FD   0368    
 43FD   0368               CASE ZipFld
 43FD    **        I00403:   cmp     word ptr t02E8%,08h
 4402    **                  je      $+03h
 4404    **                  jmp     I00404
 4407    **                  push    offset <const>
 440A    **                  mov     bx,N%
 440E    **                  sal     bx,1
 4410    **                  sal     bx,1
 4412    **                  mov     si,08h[bp]
 4415    **                  mov     dx,bx
 4417    **                  add     bx,0Ah[si]
 441A    **                  push    ds
 441B    **                  push    bx
 441C    **                  xor     ax,ax
 441E    **                  push    ax
 441F    **                  mov     0E2h[bp],dx
 4422    **                  call    B$LSET
 4427    **                  mov     si,08h[bp]
 442A    **                  xor     bx,bx
                                                                      PAGE 160
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 442C    **                  add     bx,0Ah[si]
 442F    **                  push    bx
 4430    **                  mov     bx,N%
 4434    **                  sal     bx,1
 4436    **                  sal     bx,1
 4438    **                  sal     bx,1
 443A    **                  sal     bx,1
 443C    **                  sal     bx,1
 443E    **                  sal     bx,1
 4440    **                  mov     si,06h[bp]
 4443    **                  mov     dx,bx
 4445    **                  add     bx,0Ah[si]
 4448    **                  mov     es,02h[si]
 444B    **                  es:     
 444C    **                  push    [bx]
 444E    **                  push    03h
 4450    **                  mov     0E0h[bp],dx
 4453    **                  call    B$FMID
 4458    **                  push    ax
 4459    **                  push    offset t0368$
 445C    **                  call    B$SASS
 4461    **                  mov     si,08h[bp]
 4464    **                  mov     bx,0E2h[bp]
 4467    **                  mov     dx,bx
 4469    **                  add     bx,0Ah[si]
 446C    **                  push    ds
 446D    **                  push    bx
 446E    **                  xor     ax,ax
 4470    **                  push    ax
 4471    **                  push    offset t0368$
 4474    **                  push    7FFFh
 4477    **                  push    01h
 4479    **                  call    B$SMID
 447E    **                  mov     si,08h[bp]
 4481    **                  xor     bx,bx
 4483    **                  add     bx,0Ah[si]
 4486    **                  push    bx
 4487    **                  mov     si,06h[bp]
 448A    **                  mov     bx,0E0h[bp]
 448D    **                  mov     dx,bx
 448F    **                  add     bx,0Ah[si]
 4492    **                  mov     es,02h[si]
 4495    **                  es:     
 4496    **                  mov     ax,[bx]
 4498    **                  add     ax,0003h
 449B    **                  push    ax
 449C    **                  push    02h
 449E    **                  call    B$FMID
 44A3    **                  push    ax
 44A4    **                  push    offset t036C$
 44A7    **                  call    B$SASS
 44AC    **                  mov     si,08h[bp]
 44AF    **                  mov     bx,0E2h[bp]
 44B2    **                  mov     dx,bx
                                                                      PAGE 161
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 44B4    **                  add     bx,0Ah[si]
 44B7    **                  push    ds
 44B8    **                  push    bx
 44B9    **                  xor     ax,ax
 44BB    **                  push    ax
 44BC    **                  push    offset t036C$
 44BF    **                  push    7FFFh
 44C2    **                  push    05h
 44C4    **                  call    B$SMID
 44C9    **                  mov     si,08h[bp]
 44CC    **                  xor     bx,bx
 44CE    **                  add     bx,0Ah[si]
 44D1    **                  push    bx
 44D2    **                  mov     si,06h[bp]
 44D5    **                  mov     bx,0E0h[bp]
 44D8    **                  add     bx,0Ah[si]
 44DB    **                  mov     es,02h[si]
 44DE    **                  es:     
 44DF    **                  mov     ax,[bx]
 44E1    **                  add     ax,0005h
 44E4    **                  push    ax
 44E5    **                  push    04h
 44E7    **                  call    B$FMID
 44EC    **                  push    ax
 44ED    **                  push    offset t0370$
 44F0    **                  call    B$SASS
 44F5    **                  mov     si,08h[bp]
 44F8    **                  mov     bx,0E2h[bp]
 44FB    **                  add     bx,0Ah[si]
 44FE    **                  push    ds
 44FF    **                  push    bx
 4500    **                  xor     ax,ax
 4502    **                  push    ax
 4503    **                  push    offset t0370$
 4506    **                  push    7FFFh
 4509    **                  push    08h
 450B    **                  call    B$SMID
 4510    **                  jmp     I00396
 4513   0374                  LSET Form$(N, 0) = "     -    "   'Make a templat
                e then fill in
 4513   0374                                                    '  the blanks
 4513   0374                  MID$(Form$(N, 0), 1) = MID$(Form$(0, 0), Fld(N).F
                ields, 5)
 4513   0374                  MID$(Form$(N, 0), 7) = MID$(Form$(0, 0), Fld(N).F
                ields + 5, 4)
 4513   0374    
 4513   0374               CASE NotesFld, Button
 4513    **        I00404:   cmp     word ptr t02E8%,09h
 4518    **                  je      $+03h
 451A    **                  jmp     I00405
 451D    **                  push    offset <const>
 4520    **                  mov     bx,N%
 4524    **                  sal     bx,1
 4526    **                  sal     bx,1
                                                                      PAGE 162
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 4528    **                  mov     si,08h[bp]
 452B    **                  mov     dx,bx
 452D    **                  add     bx,0Ah[si]
 4530    **                  push    ds
 4531    **                  push    bx
 4532    **                  xor     ax,ax
 4534    **                  push    ax
 4535    **                  mov     0DEh[bp],dx
 4538    **                  call    B$LSET
 453D    **                  mov     si,08h[bp]
 4540    **                  xor     bx,bx
 4542    **                  add     bx,0Ah[si]
 4545    **                  push    bx
 4546    **                  mov     bx,N%
 454A    **                  sal     bx,1
 454C    **                  sal     bx,1
 454E    **                  sal     bx,1
 4550    **                  sal     bx,1
 4552    **                  sal     bx,1
 4554    **                  sal     bx,1
 4556    **                  mov     si,06h[bp]
 4559    **                  mov     dx,bx
 455B    **                  add     bx,0Ah[si]
 455E    **                  mov     es,02h[si]
 4561    **                  es:     
 4562    **                  push    [bx]
 4564    **                  push    05h
 4566    **                  mov     0DCh[bp],dx
 4569    **                  call    B$FMID
 456E    **                  push    ax
 456F    **                  push    offset t0374$
 4572    **                  call    B$SASS
 4577    **                  mov     si,08h[bp]
 457A    **                  mov     bx,0DEh[bp]
 457D    **                  mov     dx,bx
 457F    **                  add     bx,0Ah[si]
 4582    **                  push    ds
 4583    **                  push    bx
 4584    **                  xor     ax,ax
 4586    **                  push    ax
 4587    **                  push    offset t0374$
 458A    **                  push    7FFFh
 458D    **                  push    01h
 458F    **                  call    B$SMID
 4594    **                  mov     si,08h[bp]
 4597    **                  xor     bx,bx
 4599    **                  add     bx,0Ah[si]
 459C    **                  push    bx
 459D    **                  mov     si,06h[bp]
 45A0    **                  mov     bx,0DCh[bp]
 45A3    **                  add     bx,0Ah[si]
 45A6    **                  mov     es,02h[si]
 45A9    **                  es:     
 45AA    **                  mov     ax,[bx]
                                                                      PAGE 163
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 45AC    **                  add     ax,0005h
 45AF    **                  push    ax
 45B0    **                  push    04h
 45B2    **                  call    B$FMID
 45B7    **                  push    ax
 45B8    **                  push    offset t0378$
 45BB    **                  call    B$SASS
 45C0    **                  mov     si,08h[bp]
 45C3    **                  mov     bx,0DEh[bp]
 45C6    **                  add     bx,0Ah[si]
 45C9    **                  push    ds
 45CA    **                  push    bx
 45CB    **                  xor     ax,ax
 45CD    **                  push    ax
 45CE    **                  push    offset t0378$
 45D1    **                  push    7FFFh
 45D4    **                  push    07h
 45D6    **                  call    B$SMID
 45DB    **                  jmp     I00396
 45DE    **        I00405:   cmp     word ptr t02E8%,11h
 45E3    **                  je      I00406
 45E5    **                  cmp     word ptr t02E8%,18h
 45EA    **                  je      $+03h
 45EC    **                  jmp     I00407
 45EF   037C    
 45EF   037C               CASE ELSE                            'Just copy othe
                r field types
 45EF    **        I00406:   jmp     I00396
 45F2   037C                  LSET Form$(N, 0) = MID$(Form$(0, 0), Fld(N).Field
                s, Fld(N).StorLen)
 45F2   037C    
 45F2   037C            END SELECT
 45F2    **        I00407:   mov     si,08h[bp]
 45F5    **                  xor     bx,bx
 45F7    **                  add     bx,0Ah[si]
 45FA    **                  push    bx
 45FB    **                  mov     bx,N%
 45FF    **                  sal     bx,1
 4601    **                  sal     bx,1
 4603    **                  sal     bx,1
 4605    **                  sal     bx,1
 4607    **                  sal     bx,1
 4609    **                  sal     bx,1
 460B    **                  mov     si,06h[bp]
 460E    **                  mov     dx,bx
 4610    **                  add     bx,0Ah[si]
 4613    **                  mov     es,02h[si]
 4616    **                  es:     
 4617    **                  push    [bx]
 4619    **                  mov     bx,dx
 461B    **                  add     bx,0Ah[si]
 461E    **                  mov     es,02h[si]
 4621    **                  add     bx,08h
 4624    **                  es:     
                                                                      PAGE 164
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 4625    **                  push    [bx]
 4627    **                  call    B$FMID
 462C    **                  push    ax
 462D    **                  push    offset t037C$
 4630    **                  call    B$SASS
 4635    **                  push    offset t037C$
 4638    **                  mov     bx,N%
 463C    **                  sal     bx,1
 463E    **                  sal     bx,1
 4640    **                  mov     si,08h[bp]
 4643    **                  add     bx,0Ah[si]
 4646    **                  push    ds
 4647    **                  push    bx
 4648    **                  xor     ax,ax
 464A    **                  push    ax
 464B    **                  call    B$LSET
 4650   0380    
 4650   0380        NEXT
 4650    **        I00396:   mov     ax,N%
 4653    **                  inc     ax
 4654    **        I00381:   mov     N%,ax
 4657    **                  cmp     ax,t02DC%
 465B    **                  jg      $+03h
 465D    **                  jmp     I00382
 4660   0380    
 4660   0380    END SUB
 4660    **        I00379:   push    offset t037C$
 4663    **                  call    B$STDL
 4668    **                  push    offset t0378$
 466B    **                  call    B$STDL
 4670    **                  push    offset t0374$
 4673    **                  call    B$STDL
 4678    **                  push    offset t0370$
 467B    **                  call    B$STDL
 4680    **                  push    offset t036C$
 4683    **                  call    B$STDL
 4688    **                  push    offset t0368$
 468B    **                  call    B$STDL
 4690    **                  push    offset t0364$
 4693    **                  call    B$STDL
 4698    **                  push    offset t0360$
 469B    **                  call    B$STDL
 46A0    **                  push    offset t035C$
 46A3    **                  call    B$STDL
 46A8    **                  push    offset t0358$
 46AB    **                  call    B$STDL
 46B0    **                  push    offset t0354$
 46B3    **                  call    B$STDL
 46B8    **                  push    offset t0350$
 46BB    **                  call    B$STDL
 46C0    **                  push    offset t034A$
 46C3    **                  call    B$STDL
 46C8    **                  push    offset t0346$
 46CB    **                  call    B$STDL
                                                                      PAGE 165
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 46D0    **                  push    offset t0302$
 46D3    **                  call    B$STDL
 46D8    **                  push    offset t02FE$
 46DB    **                  call    B$STDL
 46E0    **                  push    offset t02FA$
 46E3    **                  call    B$STDL
 46E8    **                  push    offset t02EC$
 46EB    **                  call    B$STDL
 46F0    **                  push    offset t02E4$
 46F3    **                  call    B$STDL
 4700   0380    
 4700   0380    '----- Returns the value of a numeric string which may contain 
                non numeric
 4700   0380    '      characters such as "$," also returns an error if value w
                ould cause
 4700   0380    '      an overflow
 4700   0380    '
 4700   0380    FUNCTION Value# (E$, ErrCode) STATIC
 46F8    **        I00378:   jmp     I00408
 4719   0380    
 4719   0380        ErrCode = -1                                'Guilty until p
                roven otherwise
 4719   0380        Value# = 0                                  'No value yet
 4719   0380       
 4719   0380        Temp$ = RTRIM$(E$)                          'Make a copy of
                 string
 4719   0380        Ln = LEN(Temp$)                             'Save the lengt
                h of string
 4719   0380        Sign = 0                                    'number of sign
                s
 4719   0380        S1 = 0                                      'Mantissa's sig
                n position
 4719   0380        Decm = 0                                    'Decimal positi
                on
 4719   0380        Xpon = 0                                    'Exponent posit
                ion
 4719   0380        N = 0                                       'Number of digi
                ts
 4719   0380        X = 1                                       'Start at the f
                irst character
 4719   0380    
 4719   0380        DO UNTIL X > Ln                             'Check each cha
                racter
 4703    **                  mov     si,08h[bp]
 471C    **                  mov     [si],0FFFFh
 4720    **                  mov     di,06h[bp]
 4723    **                  mov     si,offset <0000000000000000>
 4726    **                  push    ds
 4727    **                  pop     es
 4728    **                  movsw   
 4729    **                  movsw   
 472A    **                  movsw   
 472B    **                  movsw   
 472C    **                  push    0Ah[bp]
                                                                      PAGE 166
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 472F    **                  call    B$RTRM
 4734    **                  push    ax
 4735    **                  push    offset TEMP$
 4738    **                  call    B$SASS
 473D    **                  mov     ax,TEMP$
 4740    **                  mov     LN%,ax
 4743    **                  mov     SIGN%,0000h
 4749    **                  mov     S1%,0000h
 474F    **                  mov     DECM%,0000h
 4755    **                  mov     XPON%,0000h
 475B    **                  mov     N%,0000h
 4761    **                  mov     X%,0001h
 4767    **                  nop     
 4768   038E                                                    'See if charact
                er is in table
 4768   038E           Ok = INSTR(FloatChars$, MID$(Temp$, X, 1))
 4768   038E    
 4768   038E           IF N = 0 THEN
 4768   038E              IF Ok >= 15 AND Ok <= 18 THEN Ok = 0
 4768    **        I00410:   mov     ax,LN%
 476B    **                  cmp     ax,X%
 476F    **                  jnl     $+03h
 4771    **                  jmp     I00411
 4774    **                  push    offset <const>
 4777    **                  push    offset TEMP$
 477A    **                  push    X%
 477E    **                  push    01h
 4780    **                  call    B$FMID
 4785    **                  push    ax
 4786    **                  call    B$INS2
 478B    **                  mov     OK%,ax
 478E    **                  cmp     word ptr N%,00h
 4793    **                  je      $+03h
 4795    **                  jmp     I00412
 4798    **                  cmp     ax,000Fh
 479B    **                  jl      I00413
 479D    **                  cmp     ax,0012h
 47A0    **                  jg      I00413
 47A2    **                  mov     OK%,0000h
 47A8   0390           END IF
 47A8    **        I00413:
 47A8   0390    
 47A8   0390           SELECT CASE Ok                           'Branch accordi
                ng to position
 47A8   0390    
 47A8   0390              CASE 0, 1                             'Illegal charac
                ter
 47A8    **        I00412:   mov     ax,OK%
 47AB    **                  mov     t0390%,ax
 47AE    **                  cmp     word ptr t0390%,00h
 47B3    **                  je      I00414
 47B5    **                  cmp     word ptr t0390%,01h
 47BA    **                  je      $+03h
 47BC    **                  jmp     I00415
                                                                      PAGE 167
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 47BF   0392                 MID$(Temp$, X) = MID$(Temp$, X + 1)'Erase it
 47BF   0392                 MID$(Temp$, Ln) = " "
 47BF   0392                 X = X - 1                          'Back up one po
                sition
 47BF   0392                 Ln = Ln - 1                        'Decrement leng
                th
 47BF   0392    
 47BF   0392              CASE 2, 3                             'Sign character
 47BF    **        I00414:   push    ds
 47C0    **                  push    offset TEMP$
 47C3    **                  xor     ax,ax
 47C5    **                  push    ax
 47C6    **                  push    offset TEMP$
 47C9    **                  mov     ax,X%
 47CC    **                  inc     ax
 47CD    **                  push    ax
 47CE    **                  push    7FFFh
 47D1    **                  call    B$FMID
 47D6    **                  push    ax
 47D7    **                  push    7FFFh
 47DA    **                  push    X%
 47DE    **                  call    B$SMID
 47E3    **                  push    ds
 47E4    **                  push    offset TEMP$
 47E7    **                  xor     ax,ax
 47E9    **                  push    ax
 47EA    **                  push    offset <const>
 47ED    **                  push    7FFFh
 47F0    **                  push    LN%
 47F4    **                  call    B$SMID
 47F9    **                  dec     X%
 47FD    **                  dec     LN%
 4801    **                  jmp     I00416
 4804    **        I00415:   cmp     word ptr t0390%,02h
 4809    **                  je      I00417
 480B    **                  cmp     word ptr t0390%,03h
 4810    **                  je      $+03h
 4812    **                  jmp     I00418
 4815   0392                 Sign = Sign + 1                    'Bump number of
                 signs
 4815   0392                 IF Sign > 2 THEN EXIT DO           'If too many si
                gns, bail out
 4815    **        I00417:   inc     SIGN%
 4819    **                  cmp     word ptr SIGN%,02h
 481E    **                  jng     $+03h
 4820    **                  jmp     I00411
 4823   0392                 IF Xpon = 0 THEN                   'Is this the ma
                ntissa's sign?
 4823   0392                    S1 = X                          'Save position
 4823   0392                 END IF
 4823    **                  cmp     word ptr XPON%,00h
 4828    **                  jne     I00420
 482A    **                  mov     ax,X%
 482D    **                  mov     S1%,ax
                                                                      PAGE 168
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 4830   0392    
 4830   0392              CASE 4                                'Decimal place
 4830    **        I00420:   jmp     I00416
 4833   0392                 IF Decm = 0 THEN                   'If its the fir
                st decimal,
 4833   0392                    Decm = X                        '  save it's po
                sition
 4833   0392                 ELSE                               'Otherwise bail
                 out
 4833    **        I00418:   cmp     word ptr t0390%,04h
 4838    **                  je      $+03h
 483A    **                  jmp     I00421
 483D    **                  cmp     word ptr DECM%,00h
 4842    **                  jne     I00422
 4844    **                  mov     ax,X%
 4847    **                  mov     DECM%,ax
 484A    **                  jmp     I00423
 484D   0392                    EXIT DO
 484D   0392                 END IF
 484D    **        I00422:   jmp     I00411
 4850   0392    
 4850   0392              CASE 15 TO 18                         'Exponent chara
                cter
 4850    **        I00423:   jmp     I00416
 4853   0392                 IF Xpon = 0 THEN                   'If its the fir
                st one,
 4853   0392                    Xpon = X                        '  save it's po
                sition
 4853   0392                 ELSE                               'Otherwise bail
                 out
 4853    **        I00421:   cmp     word ptr t0390%,0Fh
 4858    **                  jnl     $+03h
 485A    **                  jmp     I00424
 485D    **                  cmp     word ptr t0390%,12h
 4862    **                  jng     $+03h
 4864    **                  jmp     I00424
 4867    **                  cmp     word ptr XPON%,00h
 486C    **                  jne     I00425
 486E    **                  mov     ax,X%
 4871    **                  mov     XPON%,ax
 4874    **                  jmp     I00426
 4877   0392                    EXIT DO
 4877   0392                 END IF
 4877    **        I00425:   jmp     I00411
 487A   0392    
 487A   0392              CASE ELSE
 487A    **        I00426:   jmp     I00416
 487D   0392                 N = N + 1
 487D   0392           END SELECT
 487D    **        I00424:   inc     N%
 4881   0392    
 4881   0392           X = X + 1                                'Bump character
                 pointer
 4881   0392        LOOP
                                                                      PAGE 169
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 4881    **        I00416:   inc     X%
 4885    **                  jmp     I00410
 4888   0392    
 4888   0392    
 4888   0392        Whole = Decm - S1 - 1                       'Find number of
                 digits before
 4888   0392                                                    '  decimal plac
                e
 4888   0392        IF Whole > 308 THEN EXIT FUNCTION           'Bail out if to
                o many
 4888    **        I00411:   mov     ax,DECM%
 488B    **                  sub     ax,S1%
 488F    **                  dec     ax
 4890    **                  mov     WHOLE%,ax
 4893    **                  cmp     ax,0134h
 4896    **                  jng     $+03h
 4898    **                  jmp     I00409
 489B   0394    
 489B   0394        IF Xpon THEN                                'If there is an
                 exponent,
 489B   0394           Num# = VAL(LEFT$(Temp$, Xpon))           'Get mantissa's
                 value
 489B   0394           Xpon = VAL(MID$(Temp$, Xpon + 1))        'Get exponents 
                value
 489B   0394    
 489B   0394           Num# = Num# / (10 ^ (Whole - 1))         'Shift decimal 
                to right of
 489B   0394                                                    '  first digit
 489B   0394           Xpon = ABS(Xpon + Whole - 1)             'Adjust exponen
                t
 489B   0394    
 489B   0394           IF Xpon > 308 THEN                       'See if number 
                will overflow
 489B   0394              EXIT FUNCTION
 489B   0394           ELSEIF Xpon = 308 AND ABS(Num#) > 1.79769313486232# THEN
 489B    **                  mov     ax,XPON%
 489E    **                  and     ax,ax
 48A0    **                  jne     $+03h
 48A2    **                  jmp     I00428
 48A5    **                  push    offset TEMP$
 48A8    **                  push    ax
 48A9    **                  call    B$LEFT
 48AE    **                  push    ax
 48AF    **                  call    B$FVAL
 48B4    **                  mov     si,ax
 48B6    **                  mov     di,offset NUM#
 48B9    **                  push    ds
 48BA    **                  pop     es
 48BB    **                  movsw   
 48BC    **                  movsw   
 48BD    **                  movsw   
 48BE    **                  movsw   
 48BF    **                  push    offset TEMP$
 48C2    **                  mov     ax,XPON%
                                                                      PAGE 170
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 48C5    **                  inc     ax
 48C6    **                  push    ax
 48C7    **                  push    7FFFh
 48CA    **                  call    B$FMID
 48CF    **                  push    ax
 48D0    **                  call    B$FVAL
 48D5    **                  mov     si,ax
 48D7    **                  int     39h
 48D9    **                  db      04h
 48DA    **                  int     3Bh
 48DC    **                  db      1Eh
 48DD    **                  dw      XPON%
 48DF    **                  int     3Dh
 48E1    **                  int     39h
 48E3    **                  db      06h
 48E4    **                  dw      NUM#
 48E6    **                  mov     ax,WHOLE%
 48E9    **                  dec     ax
 48EA    **                  call    B$FIL2
 48EF    **                  int     35h
 48F1    **                  db      06h
 48F2    **                  dw      <00002041>
 48F4    **                  int     3Dh
 48F6    **                  call    B$POW4
 48FB    **                  int     3Ah
 48FD    **                  db      0F9h
 48FE    **                  int     39h
 4900    **                  db      1Eh
 4901    **                  dw      NUM#
 4903    **                  int     3Dh
 4905    **                  mov     ax,WHOLE%
 4908    **                  add     ax,XPON%
 490C    **                  dec     ax
 490D    **                  cwd     
 490E    **                  xor     ax,dx
 4910    **                  sub     ax,dx
 4912    **                  mov     XPON%,ax
 4915    **                  cmp     ax,0134h
 4918    **                  jng     I00429
 491A    **                  jmp     I00409
 491D    **                  jmp     I00430
 4920   039C              EXIT FUNCTION
 4920   039C           END IF
 4920    **        I00429:   cmp     XPON%,0134h
 4926    **                  je      $+03h
 4928    **                  jmp     I00431
 492B    **                  int     39h
 492D    **                  db      06h
 492E    **                  dw      <5BA367E059C3FC3F>
 4930    **                  int     39h
 4932    **                  db      06h
 4933    **                  dw      NUM#
 4935    **                  int     35h
 4937    **                  db      0E1h
                                                                      PAGE 171
                                                                      11 Feb 98
                                                                      14:05:22
Offset  Data    Source Line           Microsoft (R) BASIC Compiler Version 7.10

 4938    **                  int     3Dh
 493A    **                  call    B$FCMP
 493F    **                  ja      $+03h
 4941    **                  jmp     I00431
 4944    **                  jmp     I00409
 4947    **        I00430:
 4947   039C    
 4947   039C        END IF
 4947    **        I00431:
 4947   039C    
 4947   039C        Value# = VAL(Temp$)                         'Assign the fun
                ction
 4947   039C        ErrCode = 0                                 'Clear error fl
                ag
 4947   039C    
 4947   039C    END FUNCTION
 4947    **        I00428:   push    offset TEMP$
 494A    **                  call    B$FVAL
 494F    **                  mov     si,ax
 4951    **                  mov     di,06h[bp]
 4954    **                  push    ds
 4955    **                  pop     es
 4956    **                  movsw   
 4957    **                  movsw   
 4958    **                  movsw   
 4959    **                  movsw   
 495A    **                  mov     si,08h[bp]
 495D    **                  mov     [si],0000h
 4961    **        I00409:   mov     ax,06h[bp]
 496C   039C    
 496C   039C    
 4964    **        I00408:   call    B$CENP
 4971   039C    

45108 Bytes Available
30937 Bytes Free

    0 Warning Error(s)
    0 Severe  Error(s)
